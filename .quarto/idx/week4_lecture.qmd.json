{"title":"第四周：眼见为实：`ggplot2` 可视化探索与推断初步","markdown":{"yaml":{"title":"第四周：眼见为实：`ggplot2` 可视化探索与推断初步"},"headingText":"1. 为何需要数据可视化？","containsRefs":false,"markdown":"\n\n\n我们已经学会了如何整理数据和计算描述性统计量，但数字往往难以直观地揭示数据背后的模式、趋势和异常。数据可视化通过图形将数据呈现出来，帮助我们：\n\n-   **探索性数据分析 (Exploratory Data Analysis, EDA):** 快速理解数据分布、变量间关系、发现异常点。\n-   **沟通发现:** 清晰有效地向他人展示数据洞见。\n-   **模型诊断:** (后续课程) 检查统计模型的假设是否成立。\n\n::: {.callout-note title=\"本周目标\"}\n-   理解数据可视化的基本原则。\n-   掌握 `ggplot2` 的核心语法和图层叠加思想。\n-   能够绘制常用的单变量和双变量图形。\n-   对图形进行基本的定制（标签、主题）。\n-   初步理解推断统计的核心思想：从样本推断总体。\n-   理解点估计和区间估计的概念。\n-   掌握置信区间的概念和正确解释。\n:::\n\n## 2. 数据可视化原则\n\n有效的可视化不仅仅是绘制图形，更要遵循一定的原则，确保图形清晰、准确、不误导。\n\n-   **清晰性:** 图形元素（点、线、条）易于区分，标签、坐标轴清晰明了。\n-   **准确性:** 图形真实反映数据特征，避免扭曲（如不恰当的坐标轴范围）。\n-   **简洁性:** 避免不必要的图形元素（“图表垃圾”），突出核心信息。\n-   **目的性:** 图形应服务于特定的分析或沟通目的。选择合适的图形类型。\n\n## 3. `ggplot2`：图形的语法\n\n`ggplot2` 是 `tidyverse` 中的旗舰级可视化包，它基于“图形语法”(Grammar of Graphics) 的理念，提供了一种强大而灵活的方式来创建各种复杂的图形。\n\n-   **核心理念：图层叠加 (Layers)** 一个 `ggplot2` 图形由若干图层叠加而成，每个图层包含：\n\n    1.  **数据 (Data):** 要可视化的数据框或 Tibble。\n    2.  **映射 (Aesthetic Mappings, `aes()`):** 将数据中的**变量**映射到图形的**视觉属性**（如 x 轴位置、y 轴位置、颜色、形状、大小等）。\n    3.  **几何对象 (Geometric Objects, `geom_...`):** 定义了使用哪种图形来表示数据（如点、线、条形、箱线等）。\n    4.  **统计变换 (Statistical Transformations, `stat_...`):** 对数据进行统计汇总（如计算频数、密度、均值等），`geom` 通常有默认的 `stat`。\n    5.  **位置调整 (Position Adjustments, `position_...`):** 处理图形元素重叠问题（如堆叠、并列）。\n    6.  **坐标系 (Coordinate System, `coord_...`):** 控制坐标轴（如笛卡尔坐标、极坐标）。\n    7.  **分面 (Faceting, `facet_...`):** 将数据按某个分类变量分割成多个子图。\n\n-   **基本语法模板:** \n    ```r\n    ggplot(data = <DATA_FRAME>) +\n      geom_xxx(mapping = aes(<MAPPINGS>)) +       # 其他图层、设定...\n    ```\n\n-   **示例数据准备:** 我们将使用 `ggplot2` 内置的 `mpg` 数据集（关于不同汽车型号燃油效率等信息）。 \n\n    ```{r}\n    library(tidyverse)     \n    glimpse(mpg) # 快速查看数据结构\n    # ?mpg # 查看数据集帮助文档\n    ```\n\n## 4. 常用单变量图形\n\n用于探索单个变量的分布特征。\n\n-   **直方图 (Histogram): `geom_histogram()`**\n\n    -   展示连续变量的分布情况。将变量范围分成若干区间 (bins)，计算落在每个区间的观测数量。\n    -   `aes()`: 通常只需要映射 `x` 轴。\n\n    ```{r}\n    # 探索发动机排量 (displ) 的分布\n    ggplot(data = mpg) +\n      geom_histogram(mapping = aes(x = displ), binwidth = 0.5, fill = \"skyblue\", color = \"black\")\n      # binwidth 控制区间的宽度，可以调整以观察不同粒度的分布\n      # fill 设置填充色, color 设置边框色\n    ```\n\n-   **密度图 (Density Plot): `geom_density()`**\n\n    -   直方图的平滑版本，更清晰地展示分布形状。\n    -   `aes()`: 通常只需要映射 `x` 轴。\n\n    ```{r}\n    # 探索发动机排量 (displ) 的分布\n    ggplot(data = mpg) +\n      geom_density(mapping = aes(x = displ), fill = \"lightgreen\", alpha = 0.7)\n      # alpha 控制填充透明度\n    ```\n\n-   **箱线图 (Boxplot): `geom_boxplot()`**\n\n    -   展示连续变量的分布概要（中位数、四分位数、异常值）。\n    -   `aes()`: 通常映射 `y` 轴（或 `x` 轴，如果想画水平箱线图）。可以映射 `x` 轴为分类变量来分组比较。\n\n    ```{r}\n    # 探索每加仑高速公路行驶英里数 (hwy) 的分布\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(y = hwy), fill = \"orange\")\n\n    # 查看不同驱动方式 (drv: f=前驱, r=后驱, 4=四驱) 的 hwy 分布\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(x = drv, y = hwy, fill = drv)) # 按 drv 分组并用颜色区分\n    ```\n\n    ::: {.callout-info title=\"箱线图解读\"}\n    -   箱体：覆盖 IQR (Q1 到 Q3)。\n    -   箱内粗线：中位数 (Q2)。\n    -   触须 (Whiskers)：通常延伸到距离箱体 1.5 倍 IQR 范围内的最远点。\n    -   点：超出触须范围的潜在异常值。\n    :::\n\n## 5. 常用双变量图形\n\n用于探索两个变量之间的关系。\n\n-   **散点图 (Scatter Plot): `geom_point()`**\n\n    -   展示两个**连续变量**之间的关系。\n    -   `aes()`: 映射 `x` 和 `y` 轴。可以映射其他属性（如 `color`, `shape`, `size`）到第三个变量。\n\n    ```{r}\n    # 探索发动机排量 (displ) 与高速公路里程 (hwy) 的关系\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy))\n\n    # 将颜色映射到车辆类别 (class)\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, color = class))\n\n    # 将点的大小映射到气缸数 (cyl)\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, size = cyl, color = class), alpha = 0.6)\n    ```\n\n-   **分组箱线图/小提琴图 (Grouped Boxplot/Violin Plot)**\n\n    -   比较一个**连续变量**在不同**分类变量**组别下的分布。\n    -   `geom_boxplot()` 或 `geom_violin()` (小提琴图结合了箱线图和密度图)。\n    -   `aes()`: 映射 `x` 到分类变量，`y` 到连续变量。\n\n    ```{r}\n    # 比较不同车辆类别 (class) 的高速公路里程 (hwy) 分布 (箱线图)\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(x = class, y = hwy, fill = class)) +\n      coord_flip() # 翻转坐标轴，让类别标签更易读\n\n    # 比较不同车辆类别 (class) 的高速公路里程 (hwy) 分布 (小提琴图)\n    ggplot(data = mpg) +\n      geom_violin(mapping = aes(x = class, y = hwy, fill = class)) +\n      geom_boxplot(mapping = aes(x = class, y = hwy), width = 0.1, fill = \"white\", alpha = 0.5) + # 叠加箱线图\n      coord_flip()\n    ```\n\n-   **条形图 (Bar Plot): `geom_bar()` / `geom_col()`**\n\n    -   `geom_bar()`: 统计**分类变量**的频数。`aes()` 只需要映射 `x`。\n    -   `geom_col()`: 直接绘制**已计算好**的高度值。`aes()` 需要映射 `x` 和 `y`。\n\n    ```{r}\n    # 统计不同车辆类别 (class) 的数量\n    ggplot(data = mpg) +\n      geom_bar(mapping = aes(x = class, fill = class)) +\n      coord_flip()\n\n    # 统计不同类型车辆的平均油耗 (hwy)\n    vehicle_summary <- mpg %>%\n      group_by(class) %>%\n      summarise(Avg_hwy = mean(hwy))\n\n    # 绘制每个车辆类别的平均油耗 (hwy)\n    ggplot(data = vehicle_summary) +\n      geom_col(mapping = aes(x = class, y = Avg_hwy, fill = class))\n    ```\n\n## 6. 图形定制初步\n\n`ggplot2` 提供了丰富的定制选项。\n\n-   **标签 (Labels): `labs()`**\n\n    -   修改标题、副标题、坐标轴标签、图例标题等。\n\n    ```{r}\n    p <- ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, color = class))\n\n    p + labs(\n      title = \"发动机排量与高速公路里程关系\",\n      subtitle = \"数据来源：mpg 数据集\",\n      x = \"发动机排量 (升)\",\n      y = \"高速公路里程 (英里/加仑)\",\n      color = \"车辆类别\",\n      caption = \"图形由 ggplot2 生成\"\n    )\n    ```\n\n-   **主题 (Themes): `theme_...()`**\n\n    -   快速改变图形的整体外观（背景、网格线、字体等）。\n    -   内置主题：`theme_bw()`, `theme_minimal()`, `theme_classic()`, `theme_light()`, `theme_dark()` 等。\n    -   `theme()` 函数可以进行更细致的调整。\n\n    ```{r}\n    p + labs(\n      title = \"发动机排量与高速公路里程关系\",\n      x = \"发动机排量 (升)\",\n      y = \"高速公路里程 (英里/加仑)\",\n      color = \"车辆类别\"\n    ) +\n    theme_minimal() # 应用 minimal 主题\n    ```\n\n## 7. 推断统计思想初步\n\n到目前为止，我们主要关注**描述统计**（描述已有数据的特征）和**探索性分析**（发现数据中的模式）。**推断统计**则更进一步，试图从**样本 (Sample)** 数据推断**总体 (Population)** 的特征。\n\n-   **总体 vs 样本:**\n    -   **总体:** 我们感兴趣的所有个体或对象的集合（例如，所有中国大学生的身高）。总体通常太大而无法完全测量。\n    -   **样本:** 从总体中抽取的一部分个体或对象的集合（例如，随机抽取 1000 名中国大学生的身高）。我们通过分析样本来了解总体。\n-   **抽样分布 (Sampling Distribution):**\n    -   想象一下，我们**反复**从同一个总体中抽取**多个**大小相同的样本，并计算每个样本的某个统计量（如样本均值 $\\bar{x}$）。\n    -   这些样本统计量的分布就称为该统计量的**抽样分布**。\n    -   抽样分布描述了样本统计量本身的不确定性或变异性。\n-   **中心极限定理 (Central Limit Theorem, CLT) 直观理解:**\n    -   CLT 是统计学中最重要的定理之一。\n    -   **核心思想:** 无论总体本身的分布形状如何（只要不是太极端），当样本量 $n$ 足够大时，**样本均值** $\\bar{x}$ 的抽样分布近似服从正态分布。\n    -   这个正态分布的均值等于总体均值 $\\mu$，标准差（称为**标准误 Standard Error, SE**）等于总体标准差 $\\sigma$ 除以 $\\sqrt{n}$ ($SE = \\frac{\\sigma}{\\sqrt{n}}$)。\n    -   **意义:** 使得我们可以利用正态分布的性质来对总体均值进行推断，即使我们不知道总体的具体分布。\n\n::: {.callout-info title=\"CLT 的重要性\"}\nCLT 是许多统计推断方法（如 t 检验、置信区间）的理论基础。它告诉我们，即使原始数据不是正态的，样本均值在多次抽样下也会趋向于正态分布，这极大地简化了推断过程。\n:::\n\n## 8. 参数估计：点估计 vs 区间估计\n\n我们通常希望估计总体的某个参数（如总体均值 $\\mu$、总体比例 $p$）。\n\n-   **点估计 (Point Estimate):** 用样本统计量直接作为总体参数的估计值。\n    -   例如，用样本均值 $\\bar{x}$ 估计总体均值 $\\mu$。\n    -   用样本比例 $\\hat{p}$ 估计总体比例 $p$。\n    -   **优点:** 简单直观。\n    -   **缺点:** 几乎不可能精确等于总体参数，且没有提供估计的**不确定性**信息。由于抽样误差，每次抽样的点估计值都会有所不同。\n-   **区间估计 (Interval Estimate):** 给出一个包含总体参数真实值的**可能范围**，并附带一定的**置信水平 (Confidence Level)**。\n    -   最常见的区间估计是**置信区间 (Confidence Interval, CI)**。\n    -   **优点:** 提供了估计的不确定性度量。\n    -   **缺点:** 理解和解释比点估计复杂。\n\n## 9. 置信区间 (Confidence Interval)\n\n-   **概念:** 基于样本数据构造的一个区间，我们有**一定程度的信心**（由置信水平决定）认为该区间包含了未知的总体参数。\n-   **置信水平 (Confidence Level):** 通常表示为 $(1-\\alpha) \\times 100\\%$，常用 95%。\n    -   **95% 置信区间的含义 (重要！):** 如果我们反复从总体中抽取**无数个**相同大小的样本，并为每个样本构造一个 95% 置信区间，那么**大约有 95% 的这些区间会包含真实的总体参数**。\n    -   **错误理解:** 不能说“总体参数有 95% 的概率落在这个具体的区间内”。总体参数是一个固定的值，它要么在区间内，要么不在。置信水平描述的是构造区间这个**方法**的长期可靠性。\n-   **置信区间的构成 (以总体均值** $\\mu$ 为例，假设 $\\sigma$ 已知或 $n$ 很大):\n    -   置信区间 = 点估计 $\\pm$ 边际误差 (Margin of Error, MOE)\n    -   $CI = \\bar{x} \\pm Z_{\\alpha/2} \\times SE = \\bar{x} \\pm Z_{\\alpha/2} \\times \\frac{\\sigma}{\\sqrt{n}}$\n    -   $Z_{\\alpha/2}$ 是标准正态分布上侧 $\\alpha/2$ 分位数（例如，95% 置信水平对应 $\\alpha=0.05$, $Z_{0.025} \\approx 1.96$）。\n    -   边际误差取决于：\n        -   **置信水平:** 水平越高，区间越宽。\n        -   **数据变异性 (**$\\sigma$): 变异性越大，区间越宽。\n        -   **样本量 (**$n$): 样本量越大，区间越窄（估计越精确）。\n-   **解释示例:** 假设我们计算出某产品用户满意度的 95% 置信区间为 \\[8.2, 8.8\\]。\n    -   **正确解释:** 我们有 95% 的信心认为，该产品用户的真实平均满意度介于 8.2 和 8.8 之间。或者说，如果我们重复抽样并构造区间，预计 95% 的区间会包含真实的平均满意度。\n    -   **错误解释:**\n        -   “用户的满意度有 95% 的概率在 8.2 到 8.8 之间。” (概率是针对区间的构造方法，不是针对具体区间或参数)\n        -   “95% 的用户满意度在 8.2 到 8.8 之间。” (置信区间是关于总体**均值**，不是关于个体数据)\n\n## 10. 项目相关与本周总结\n\n-   **项目任务:**\n    -   使用 `ggplot2` 对你的项目数据进行深入的探索性数据分析 (EDA)。尝试绘制各种单变量和双变量图形，探索变量分布和关系。\n    -   思考你的项目中可能需要进行**参数估计**的问题。例如，你想估计某个群体的平均值、比例或两个变量间的关系强度吗？这些估计是点估计还是区间估计更有意义？\n-   **本周回顾:** 我们学习了数据可视化的重要性和 `ggplot2` 的强大功能，能够绘制和定制常见的统计图形。同时，我们初步踏入了推断统计的大门，理解了从样本推断总体的基本思想、抽样分布、CLT 的直观意义，以及点估计和置信区间的概念与解释。\n\n**下周预告:** 我们将正式学习**假设检验**，这是推断统计的另一个核心工具，用于基于样本证据对关于总体的某个断言（假设）做出决策。我们将学习单样本和双样本 t 检验，以及方差分析 (ANOVA)。","srcMarkdownNoYaml":"\n\n## 1. 为何需要数据可视化？\n\n我们已经学会了如何整理数据和计算描述性统计量，但数字往往难以直观地揭示数据背后的模式、趋势和异常。数据可视化通过图形将数据呈现出来，帮助我们：\n\n-   **探索性数据分析 (Exploratory Data Analysis, EDA):** 快速理解数据分布、变量间关系、发现异常点。\n-   **沟通发现:** 清晰有效地向他人展示数据洞见。\n-   **模型诊断:** (后续课程) 检查统计模型的假设是否成立。\n\n::: {.callout-note title=\"本周目标\"}\n-   理解数据可视化的基本原则。\n-   掌握 `ggplot2` 的核心语法和图层叠加思想。\n-   能够绘制常用的单变量和双变量图形。\n-   对图形进行基本的定制（标签、主题）。\n-   初步理解推断统计的核心思想：从样本推断总体。\n-   理解点估计和区间估计的概念。\n-   掌握置信区间的概念和正确解释。\n:::\n\n## 2. 数据可视化原则\n\n有效的可视化不仅仅是绘制图形，更要遵循一定的原则，确保图形清晰、准确、不误导。\n\n-   **清晰性:** 图形元素（点、线、条）易于区分，标签、坐标轴清晰明了。\n-   **准确性:** 图形真实反映数据特征，避免扭曲（如不恰当的坐标轴范围）。\n-   **简洁性:** 避免不必要的图形元素（“图表垃圾”），突出核心信息。\n-   **目的性:** 图形应服务于特定的分析或沟通目的。选择合适的图形类型。\n\n## 3. `ggplot2`：图形的语法\n\n`ggplot2` 是 `tidyverse` 中的旗舰级可视化包，它基于“图形语法”(Grammar of Graphics) 的理念，提供了一种强大而灵活的方式来创建各种复杂的图形。\n\n-   **核心理念：图层叠加 (Layers)** 一个 `ggplot2` 图形由若干图层叠加而成，每个图层包含：\n\n    1.  **数据 (Data):** 要可视化的数据框或 Tibble。\n    2.  **映射 (Aesthetic Mappings, `aes()`):** 将数据中的**变量**映射到图形的**视觉属性**（如 x 轴位置、y 轴位置、颜色、形状、大小等）。\n    3.  **几何对象 (Geometric Objects, `geom_...`):** 定义了使用哪种图形来表示数据（如点、线、条形、箱线等）。\n    4.  **统计变换 (Statistical Transformations, `stat_...`):** 对数据进行统计汇总（如计算频数、密度、均值等），`geom` 通常有默认的 `stat`。\n    5.  **位置调整 (Position Adjustments, `position_...`):** 处理图形元素重叠问题（如堆叠、并列）。\n    6.  **坐标系 (Coordinate System, `coord_...`):** 控制坐标轴（如笛卡尔坐标、极坐标）。\n    7.  **分面 (Faceting, `facet_...`):** 将数据按某个分类变量分割成多个子图。\n\n-   **基本语法模板:** \n    ```r\n    ggplot(data = <DATA_FRAME>) +\n      geom_xxx(mapping = aes(<MAPPINGS>)) +       # 其他图层、设定...\n    ```\n\n-   **示例数据准备:** 我们将使用 `ggplot2` 内置的 `mpg` 数据集（关于不同汽车型号燃油效率等信息）。 \n\n    ```{r}\n    library(tidyverse)     \n    glimpse(mpg) # 快速查看数据结构\n    # ?mpg # 查看数据集帮助文档\n    ```\n\n## 4. 常用单变量图形\n\n用于探索单个变量的分布特征。\n\n-   **直方图 (Histogram): `geom_histogram()`**\n\n    -   展示连续变量的分布情况。将变量范围分成若干区间 (bins)，计算落在每个区间的观测数量。\n    -   `aes()`: 通常只需要映射 `x` 轴。\n\n    ```{r}\n    # 探索发动机排量 (displ) 的分布\n    ggplot(data = mpg) +\n      geom_histogram(mapping = aes(x = displ), binwidth = 0.5, fill = \"skyblue\", color = \"black\")\n      # binwidth 控制区间的宽度，可以调整以观察不同粒度的分布\n      # fill 设置填充色, color 设置边框色\n    ```\n\n-   **密度图 (Density Plot): `geom_density()`**\n\n    -   直方图的平滑版本，更清晰地展示分布形状。\n    -   `aes()`: 通常只需要映射 `x` 轴。\n\n    ```{r}\n    # 探索发动机排量 (displ) 的分布\n    ggplot(data = mpg) +\n      geom_density(mapping = aes(x = displ), fill = \"lightgreen\", alpha = 0.7)\n      # alpha 控制填充透明度\n    ```\n\n-   **箱线图 (Boxplot): `geom_boxplot()`**\n\n    -   展示连续变量的分布概要（中位数、四分位数、异常值）。\n    -   `aes()`: 通常映射 `y` 轴（或 `x` 轴，如果想画水平箱线图）。可以映射 `x` 轴为分类变量来分组比较。\n\n    ```{r}\n    # 探索每加仑高速公路行驶英里数 (hwy) 的分布\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(y = hwy), fill = \"orange\")\n\n    # 查看不同驱动方式 (drv: f=前驱, r=后驱, 4=四驱) 的 hwy 分布\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(x = drv, y = hwy, fill = drv)) # 按 drv 分组并用颜色区分\n    ```\n\n    ::: {.callout-info title=\"箱线图解读\"}\n    -   箱体：覆盖 IQR (Q1 到 Q3)。\n    -   箱内粗线：中位数 (Q2)。\n    -   触须 (Whiskers)：通常延伸到距离箱体 1.5 倍 IQR 范围内的最远点。\n    -   点：超出触须范围的潜在异常值。\n    :::\n\n## 5. 常用双变量图形\n\n用于探索两个变量之间的关系。\n\n-   **散点图 (Scatter Plot): `geom_point()`**\n\n    -   展示两个**连续变量**之间的关系。\n    -   `aes()`: 映射 `x` 和 `y` 轴。可以映射其他属性（如 `color`, `shape`, `size`）到第三个变量。\n\n    ```{r}\n    # 探索发动机排量 (displ) 与高速公路里程 (hwy) 的关系\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy))\n\n    # 将颜色映射到车辆类别 (class)\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, color = class))\n\n    # 将点的大小映射到气缸数 (cyl)\n    ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, size = cyl, color = class), alpha = 0.6)\n    ```\n\n-   **分组箱线图/小提琴图 (Grouped Boxplot/Violin Plot)**\n\n    -   比较一个**连续变量**在不同**分类变量**组别下的分布。\n    -   `geom_boxplot()` 或 `geom_violin()` (小提琴图结合了箱线图和密度图)。\n    -   `aes()`: 映射 `x` 到分类变量，`y` 到连续变量。\n\n    ```{r}\n    # 比较不同车辆类别 (class) 的高速公路里程 (hwy) 分布 (箱线图)\n    ggplot(data = mpg) +\n      geom_boxplot(mapping = aes(x = class, y = hwy, fill = class)) +\n      coord_flip() # 翻转坐标轴，让类别标签更易读\n\n    # 比较不同车辆类别 (class) 的高速公路里程 (hwy) 分布 (小提琴图)\n    ggplot(data = mpg) +\n      geom_violin(mapping = aes(x = class, y = hwy, fill = class)) +\n      geom_boxplot(mapping = aes(x = class, y = hwy), width = 0.1, fill = \"white\", alpha = 0.5) + # 叠加箱线图\n      coord_flip()\n    ```\n\n-   **条形图 (Bar Plot): `geom_bar()` / `geom_col()`**\n\n    -   `geom_bar()`: 统计**分类变量**的频数。`aes()` 只需要映射 `x`。\n    -   `geom_col()`: 直接绘制**已计算好**的高度值。`aes()` 需要映射 `x` 和 `y`。\n\n    ```{r}\n    # 统计不同车辆类别 (class) 的数量\n    ggplot(data = mpg) +\n      geom_bar(mapping = aes(x = class, fill = class)) +\n      coord_flip()\n\n    # 统计不同类型车辆的平均油耗 (hwy)\n    vehicle_summary <- mpg %>%\n      group_by(class) %>%\n      summarise(Avg_hwy = mean(hwy))\n\n    # 绘制每个车辆类别的平均油耗 (hwy)\n    ggplot(data = vehicle_summary) +\n      geom_col(mapping = aes(x = class, y = Avg_hwy, fill = class))\n    ```\n\n## 6. 图形定制初步\n\n`ggplot2` 提供了丰富的定制选项。\n\n-   **标签 (Labels): `labs()`**\n\n    -   修改标题、副标题、坐标轴标签、图例标题等。\n\n    ```{r}\n    p <- ggplot(data = mpg) +\n      geom_point(mapping = aes(x = displ, y = hwy, color = class))\n\n    p + labs(\n      title = \"发动机排量与高速公路里程关系\",\n      subtitle = \"数据来源：mpg 数据集\",\n      x = \"发动机排量 (升)\",\n      y = \"高速公路里程 (英里/加仑)\",\n      color = \"车辆类别\",\n      caption = \"图形由 ggplot2 生成\"\n    )\n    ```\n\n-   **主题 (Themes): `theme_...()`**\n\n    -   快速改变图形的整体外观（背景、网格线、字体等）。\n    -   内置主题：`theme_bw()`, `theme_minimal()`, `theme_classic()`, `theme_light()`, `theme_dark()` 等。\n    -   `theme()` 函数可以进行更细致的调整。\n\n    ```{r}\n    p + labs(\n      title = \"发动机排量与高速公路里程关系\",\n      x = \"发动机排量 (升)\",\n      y = \"高速公路里程 (英里/加仑)\",\n      color = \"车辆类别\"\n    ) +\n    theme_minimal() # 应用 minimal 主题\n    ```\n\n## 7. 推断统计思想初步\n\n到目前为止，我们主要关注**描述统计**（描述已有数据的特征）和**探索性分析**（发现数据中的模式）。**推断统计**则更进一步，试图从**样本 (Sample)** 数据推断**总体 (Population)** 的特征。\n\n-   **总体 vs 样本:**\n    -   **总体:** 我们感兴趣的所有个体或对象的集合（例如，所有中国大学生的身高）。总体通常太大而无法完全测量。\n    -   **样本:** 从总体中抽取的一部分个体或对象的集合（例如，随机抽取 1000 名中国大学生的身高）。我们通过分析样本来了解总体。\n-   **抽样分布 (Sampling Distribution):**\n    -   想象一下，我们**反复**从同一个总体中抽取**多个**大小相同的样本，并计算每个样本的某个统计量（如样本均值 $\\bar{x}$）。\n    -   这些样本统计量的分布就称为该统计量的**抽样分布**。\n    -   抽样分布描述了样本统计量本身的不确定性或变异性。\n-   **中心极限定理 (Central Limit Theorem, CLT) 直观理解:**\n    -   CLT 是统计学中最重要的定理之一。\n    -   **核心思想:** 无论总体本身的分布形状如何（只要不是太极端），当样本量 $n$ 足够大时，**样本均值** $\\bar{x}$ 的抽样分布近似服从正态分布。\n    -   这个正态分布的均值等于总体均值 $\\mu$，标准差（称为**标准误 Standard Error, SE**）等于总体标准差 $\\sigma$ 除以 $\\sqrt{n}$ ($SE = \\frac{\\sigma}{\\sqrt{n}}$)。\n    -   **意义:** 使得我们可以利用正态分布的性质来对总体均值进行推断，即使我们不知道总体的具体分布。\n\n::: {.callout-info title=\"CLT 的重要性\"}\nCLT 是许多统计推断方法（如 t 检验、置信区间）的理论基础。它告诉我们，即使原始数据不是正态的，样本均值在多次抽样下也会趋向于正态分布，这极大地简化了推断过程。\n:::\n\n## 8. 参数估计：点估计 vs 区间估计\n\n我们通常希望估计总体的某个参数（如总体均值 $\\mu$、总体比例 $p$）。\n\n-   **点估计 (Point Estimate):** 用样本统计量直接作为总体参数的估计值。\n    -   例如，用样本均值 $\\bar{x}$ 估计总体均值 $\\mu$。\n    -   用样本比例 $\\hat{p}$ 估计总体比例 $p$。\n    -   **优点:** 简单直观。\n    -   **缺点:** 几乎不可能精确等于总体参数，且没有提供估计的**不确定性**信息。由于抽样误差，每次抽样的点估计值都会有所不同。\n-   **区间估计 (Interval Estimate):** 给出一个包含总体参数真实值的**可能范围**，并附带一定的**置信水平 (Confidence Level)**。\n    -   最常见的区间估计是**置信区间 (Confidence Interval, CI)**。\n    -   **优点:** 提供了估计的不确定性度量。\n    -   **缺点:** 理解和解释比点估计复杂。\n\n## 9. 置信区间 (Confidence Interval)\n\n-   **概念:** 基于样本数据构造的一个区间，我们有**一定程度的信心**（由置信水平决定）认为该区间包含了未知的总体参数。\n-   **置信水平 (Confidence Level):** 通常表示为 $(1-\\alpha) \\times 100\\%$，常用 95%。\n    -   **95% 置信区间的含义 (重要！):** 如果我们反复从总体中抽取**无数个**相同大小的样本，并为每个样本构造一个 95% 置信区间，那么**大约有 95% 的这些区间会包含真实的总体参数**。\n    -   **错误理解:** 不能说“总体参数有 95% 的概率落在这个具体的区间内”。总体参数是一个固定的值，它要么在区间内，要么不在。置信水平描述的是构造区间这个**方法**的长期可靠性。\n-   **置信区间的构成 (以总体均值** $\\mu$ 为例，假设 $\\sigma$ 已知或 $n$ 很大):\n    -   置信区间 = 点估计 $\\pm$ 边际误差 (Margin of Error, MOE)\n    -   $CI = \\bar{x} \\pm Z_{\\alpha/2} \\times SE = \\bar{x} \\pm Z_{\\alpha/2} \\times \\frac{\\sigma}{\\sqrt{n}}$\n    -   $Z_{\\alpha/2}$ 是标准正态分布上侧 $\\alpha/2$ 分位数（例如，95% 置信水平对应 $\\alpha=0.05$, $Z_{0.025} \\approx 1.96$）。\n    -   边际误差取决于：\n        -   **置信水平:** 水平越高，区间越宽。\n        -   **数据变异性 (**$\\sigma$): 变异性越大，区间越宽。\n        -   **样本量 (**$n$): 样本量越大，区间越窄（估计越精确）。\n-   **解释示例:** 假设我们计算出某产品用户满意度的 95% 置信区间为 \\[8.2, 8.8\\]。\n    -   **正确解释:** 我们有 95% 的信心认为，该产品用户的真实平均满意度介于 8.2 和 8.8 之间。或者说，如果我们重复抽样并构造区间，预计 95% 的区间会包含真实的平均满意度。\n    -   **错误解释:**\n        -   “用户的满意度有 95% 的概率在 8.2 到 8.8 之间。” (概率是针对区间的构造方法，不是针对具体区间或参数)\n        -   “95% 的用户满意度在 8.2 到 8.8 之间。” (置信区间是关于总体**均值**，不是关于个体数据)\n\n## 10. 项目相关与本周总结\n\n-   **项目任务:**\n    -   使用 `ggplot2` 对你的项目数据进行深入的探索性数据分析 (EDA)。尝试绘制各种单变量和双变量图形，探索变量分布和关系。\n    -   思考你的项目中可能需要进行**参数估计**的问题。例如，你想估计某个群体的平均值、比例或两个变量间的关系强度吗？这些估计是点估计还是区间估计更有意义？\n-   **本周回顾:** 我们学习了数据可视化的重要性和 `ggplot2` 的强大功能，能够绘制和定制常见的统计图形。同时，我们初步踏入了推断统计的大门，理解了从样本推断总体的基本思想、抽样分布、CLT 的直观意义，以及点估计和置信区间的概念与解释。\n\n**下周预告:** 我们将正式学习**假设检验**，这是推断统计的另一个核心工具，用于基于样本证据对关于总体的某个断言（假设）做出决策。我们将学习单样本和双样本 t 检验，以及方差分析 (ANOVA)。"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":false,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles/custom.css"],"toc":true,"number-sections":false,"include-in-header":[{"text":"<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\" integrity=\"sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xkm/sYwpb+ilR5gUw==\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\">\n"}],"output-file":"week4_lecture.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","knitr":{"opts_chunk":{"comment":"#>","fig.align":"center","fig.width":8,"fig.height":6,"out.width":"90%","dpi":300,"dev":"ragg_png"}},"theme":"cosmo","callout-appearance":"none","message":false,"title":"第四周：眼见为实：`ggplot2` 可视化探索与推断初步"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}