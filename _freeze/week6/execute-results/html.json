{
  "hash": "502445218050c84e08daa687e36aca08",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"第六周：回归分析初步\"\n---\n\n\n\n\n## 第十一次课：线性回归模型与最小二乘法\n\n### 回归分析概述\n\n**回归分析的目的**：\n- 研究因变量与一个或多个自变量之间的关系\n- 建立模型进行预测和解释\n- 评估变量之间的关联程度和方向\n\n回归分析是商业分析中最常用的分析技术之一，它能够帮助我们回答以下问题：\n- 影响销售额的关键因素有哪些？每个因素的影响程度如何？\n- 如何根据产品特征预测价格？\n- 不同营销投入对业绩的边际贡献是多少？\n\n**回归分析的应用场景**：\n- 预测销售额、房价、股票价格等\n- 分析影响消费者购买行为的因素\n- 评估营销活动的效果\n- 识别影响企业绩效的关键指标\n\n**回归分析的类型**：\n- **线性回归**：因变量与自变量之间呈线性关系\n- **非线性回归**：因变量与自变量之间呈非线性关系\n- **简单线性回归**：只有一个自变量\n- **多元线性回归**：有多个自变量\n\n**回归分析与其他统计方法的区别**：\n- 与相关分析相比：回归不仅描述关系，还建立预测模型\n- 与方差分析相比：回归处理连续自变量，方差分析处理分类自变量\n\n**回归分析的基本步骤**：\n1. **确定回归模型**：选择合适的回归模型类型\n2. **估计模型参数**：使用样本数据估计模型中的未知参数\n3. **模型检验**：检验模型的拟合效果和显著性\n4. **模型应用**：使用建立的模型进行预测、解释和决策\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 创建示例数据\nset.seed(123)\nadvertising_data <- data.frame(\n  TV = runif(100, 5, 50),\n  Radio = runif(100, 1, 30),\n  Newspaper = runif(100, 0, 20)\n)\n# 生成销售额数据，使其与广告投入有一定关系\nadvertising_data$Sales <- 5 + 0.15 * advertising_data$TV + \n                            0.3 * advertising_data$Radio + \n                            0.1 * advertising_data$Newspaper + \n                            rnorm(100, 0, 2)\n\n# 探索性数据分析\nsummary(advertising_data)\ncor(advertising_data)\n\n# 可视化变量关系\nlibrary(ggplot2)\nlibrary(gridExtra)\n\np1 <- ggplot(advertising_data, aes(x = TV, y = Sales)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"电视广告与销售额关系\")\n\np2 <- ggplot(advertising_data, aes(x = Radio, y = Sales)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"广播广告与销售额关系\")\n\np3 <- ggplot(advertising_data, aes(x = Newspaper, y = Sales)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"报纸广告与销售额关系\")\n\ngrid.arrange(p1, p2, p3, ncol = 2)\n```\n:::\n\n\n\n\n### 简单线性回归模型\n\n**模型形式**：$y = \\beta_0 + \\beta_1 x + \\epsilon$\n- $y$：因变量\n- $x$：自变量\n- $\\beta_0$：截距，当$x=0$时，$y$的期望值\n- $\\beta_1$：斜率，自变量$x$每增加一个单位，因变量$y$的平均变化量\n- $\\epsilon$：随机误差项，反映模型无法解释的随机变异\n\n简单线性回归是理解回归分析的基础，它描述了一个自变量和一个因变量之间的线性关系。例如，我们可以建立一个模型来描述广告支出（自变量）与销售额（因变量）之间的关系。\n\n**最小二乘法(OLS)**：\n\n最小二乘法是一种估计回归系数的方法，其目标是找到能使误差平方和最小的回归线。\n\n- 目标：使残差平方和(RSS)最小化\n- $\\text{RSS} = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2 = \\sum_{i=1}^{n} (y_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 x_i))^2$\n- $\\hat{\\beta}_0$和$\\hat{\\beta}_1$是$\\beta_0$和$\\beta_1$的估计值\n- $\\hat{y}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_i$是因变量$y_i$的预测值\n\n**最小二乘估计的公式**：\n- $\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n}(x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n}(x_i - \\bar{x})^2}$\n- $\\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}$\n\n**回归系数的解释**：\n- $\\hat{\\beta}_0$：当自变量$x$为0时，因变量$y$的预测值（在实际情况中，自变量为0可能没有现实意义）\n- $\\hat{\\beta}_1$：自变量$x$每增加一个单位，因变量$y$的预测值平均增加$\\hat{\\beta}_1$个单位（边际效应）\n\n**回归模型的评估指标**：\n\n1. **拟合优度 $R^2$**：\n   - 表示模型解释的因变量方差比例\n   - 取值范围[0,1]，越接近1表示模型拟合越好\n   - $R^2 = 1 - \\frac{SSE}{SST} = 1 - \\frac{\\sum(y_i - \\hat{y}_i)^2}{\\sum(y_i - \\bar{y})^2}$\n\n2. **残差标准误差(RSE)**：\n   - 衡量因变量实际值偏离预测值的平均程度\n   - $RSE = \\sqrt{\\frac{SSE}{n-2}} = \\sqrt{\\frac{\\sum(y_i - \\hat{y}_i)^2}{n-2}}$\n\n**回归模型的假设条件**：\n- **线性性**：因变量与自变量之间存在线性关系\n- **独立性**：误差项之间相互独立\n- **同方差性**：误差项的方差为常数（同质性）\n- **正态性**：误差项服从均值为0的正态分布\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 简单线性回归示例：电视广告与销售额\ntv_model <- lm(Sales ~ TV, data = advertising_data)\n\n# 查看回归结果\nsummary(tv_model)\n\n# 可视化回归线和预测区间\nggplot(advertising_data, aes(x = TV, y = Sales)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", level = 0.95) +\n  labs(title = \"电视广告支出与销售额的简单线性回归\",\n       x = \"电视广告支出（千元）\",\n       y = \"销售额（万元）\") +\n  theme_minimal()\n\n# 残差分析\npar(mfrow = c(2, 2))\nplot(tv_model)\n```\n:::\n\n\n\n\n### R语言实现简单线性回归\n\n**基本函数**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 建立简单线性回归模型\nlm_model <- lm(Sales ~ TV, data = advertising_data)\n\n# 查看模型摘要\nsummary(lm_model)\n\n# 提取回归系数\ncoef(lm_model)\n\n# 置信区间\nconfint(lm_model, level = 0.95)\n\n# 模型预测\nnew_data <- data.frame(TV = c(10, 20, 30, 40))\npredict(lm_model, newdata = new_data, interval = \"confidence\")\npredict(lm_model, newdata = new_data, interval = \"prediction\")\n\n# 残差和拟合值\nresiduals(lm_model)\nfitted(lm_model)\n\n# 回归诊断图\npar(mfrow = c(2, 2))\nplot(lm_model)\n```\n:::\n\n\n\n\n**ggplot2进行回归可视化**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# 基本散点图和回归线\nggplot(advertising_data, aes(x = TV, y = Sales)) +\n  geom_point(alpha = 0.6) +\n  geom_smooth(method = \"lm\", se = TRUE) +\n  labs(title = \"电视广告支出与销售额关系\",\n       x = \"电视广告支出（千元）\", \n       y = \"销售额（万元）\") +\n  theme_minimal()\n\n# 回归残差可视化\nadvertising_data$predicted <- fitted(lm_model)\nadvertising_data$residuals <- residuals(lm_model)\n\nggplot(advertising_data, aes(x = predicted, y = residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(title = \"残差vs拟合值\",\n       x = \"拟合值\", y = \"残差\") +\n  theme_minimal()\n\n# QQ图检验正态性\nggplot(advertising_data, aes(sample = residuals)) +\n  stat_qq() +\n  stat_qq_line() +\n  labs(title = \"残差QQ图\") +\n  theme_minimal()\n```\n:::\n\n\n\n\n**结果解读**：\n- **系数估计值**：截距($\\hat{\\beta}_0$)和斜率($\\hat{\\beta}_1$)的估计值\n- **标准误差**：系数估计值的标准误差，表示估计的精确度\n- **t值**：系数估计值与标准误差的比值，用于检验系数是否显著不为0\n- **p值**：系数是否显著不为0的显著性水平\n- **R²值**：模型解释的方差比例，衡量拟合优度\n- **F统计量**：整个模型的显著性检验\n\n**案例解读**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 假设这是summary(lm_model)的输出结果：\n# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)    \n# (Intercept)   7.0326     0.4578  15.361  < 2e-16 ***\n# TV            0.0475     0.0097   4.897 4.75e-06 ***\n# ---\n# R-squared: 0.612, Adjusted R-squared: 0.606 \n# F-statistic: 23.97 on 1 and 98 DF, p-value: 4.75e-06\n\n# 商业解读：\n# 1. 截距7.0326表示当电视广告支出为0时，预期销售额为7.0326万元\n# 2. 电视广告系数0.0475表示每增加1千元的电视广告支出，销售额平均增加0.0475万元\n# 3. 电视广告变量的p值非常小(<0.0001)，表示电视广告支出对销售额有显著影响\n# 4. R²值为0.612，说明模型解释了约61.2%的销售额变异\n# 5. 整体模型F检验显著(p<0.0001)，表明模型有统计学意义\n```\n:::\n\n\n\n\n## 第十二次课：多元线性回归模型\n\n### 多元线性回归模型\n\n**多元线性回归的意义**：\n在商业环境中，一个因变量往往受多个因素影响。例如，销售额不仅受电视广告的影响，还可能受广播、报纸、社交媒体等多种营销渠道的影响。多元线性回归能够同时考虑多个自变量的影响，更全面地分析因素间的关系。\n\n**模型形式**：$y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p + \\epsilon$\n- $y$：因变量\n- $x_1, x_2, \\dots, x_p$：$p$个自变量\n- $\\beta_0$：截距\n- $\\beta_1, \\beta_2, \\dots, \\beta_p$：偏回归系数，控制其他自变量不变时，每个自变量对因变量的边际影响\n- $\\epsilon$：随机误差项\n\n**偏回归系数的解释**：\n- $\\beta_1$表示在其他自变量$x_2, \\dots, x_p$保持不变的情况下，自变量$x_1$每增加一个单位，因变量$y$的平均变化量\n\n这个解释非常重要，因为它体现了\"控制变量\"的思想，即我们能够分离出单个自变量的\"净效应\"。这在商业分析中尤为有用，例如，我们可以分析在广播广告投入不变的情况下，增加电视广告对销售的边际贡献。\n\n**参数估计**：\n- 同样使用最小二乘法(OLS)\n- 通过矩阵运算求解：$\\hat{\\beta} = (X^TX)^{-1}X^Ty$\n- 其中$X$是自变量矩阵，$y$是因变量向量\n\n**多元线性回归模型的假设条件**：\n- 线性性：因变量与每个自变量之间存在线性关系\n- 独立性：观测值之间相互独立\n- 同方差性：误差项方差恒定\n- 正态性：误差项服从正态分布\n- 无多重共线性：自变量之间不存在高度相关性\n\n**多重共线性问题**：\n- 定义：自变量之间存在强相关关系\n- 后果：回归系数估计不稳定，标准误增大\n- 诊断：方差膨胀因子(VIF)\n- 处理：变量选择、正则化、主成分分析等\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 检测多重共线性\nlibrary(car)\nmulti_model <- lm(Sales ~ TV + Radio + Newspaper, data = advertising_data)\nvif(multi_model)\n# VIF > 10通常表示存在严重多重共线性\n```\n:::\n\n\n\n\n**模型拟合与检验**：\n- **R²**：衡量模型对数据的拟合程度，取值范围[0,1]\n- **调整R²**：考虑自变量个数对R²的影响，防止过拟合\n- **F检验**：检验模型整体的显著性\n- **t检验**：检验每个偏回归系数的显著性\n\n**解释多元回归模型时需注意**：\n- 解释系数时必须强调\"控制其他变量不变\"\n- R²会随自变量增加而增加，应关注调整R²\n- 显著性水平应解释为\"在控制了其他变量后\"\n\n### R语言实现多元线性回归\n\n下面我们将使用广告投入数据集建立多元线性回归模型，分析不同广告渠道对销售额的影响：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 多元线性回归示例\nmulti_model <- lm(Sales ~ TV + Radio + Newspaper, data = advertising_data)\n\n# 查看模型摘要\nsummary(multi_model)\n\n# 方差分析表，展示模型整体显著性\nanova(multi_model)\n\n# 检验多重共线性\nlibrary(car)\nvif(multi_model)\n```\n:::\n\n\n\n\n**嵌套模型比较**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 构建不同的嵌套模型\nmodel1 <- lm(Sales ~ TV, data = advertising_data)\nmodel2 <- lm(Sales ~ TV + Radio, data = advertising_data)\nmodel3 <- lm(Sales ~ TV + Radio + Newspaper, data = advertising_data)\n\n# 使用anova函数比较嵌套模型\nanova(model1, model2, model3)\n\n# 使用AIC比较模型\nAIC(model1, model2, model3)\nBIC(model1, model2, model3)\n```\n:::\n\n\n\n\n**偏回归图**：观察单个自变量的边际贡献\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\navPlots(multi_model)\n```\n:::\n\n\n\n\n**变量重要性评估**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(relaimpo)\ncalc.relimp(multi_model, type = \"lmg\", rela = TRUE)\n```\n:::\n\n\n\n\n**多元回归的可视化**：\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 可视化不同渠道的边际效应\nlibrary(ggplot2)\nlibrary(gridExtra)\n\n# 构建效应图\neffect_tv <- ggplot(advertising_data, aes(x = TV, y = Sales)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"电视广告的边际效应\") +\n  theme_minimal()\n\neffect_radio <- ggplot(advertising_data, aes(x = Radio, y = Sales)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"广播广告的边际效应\") +\n  theme_minimal()\n\neffect_newspaper <- ggplot(advertising_data, aes(x = Newspaper, y = Sales)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(method = \"lm\") +\n  labs(title = \"报纸广告的边际效应\") +\n  theme_minimal()\n\ngrid.arrange(effect_tv, effect_radio, effect_newspaper, ncol = 2)\n\n# 3D可视化（针对两个自变量）\nlibrary(plotly)\nfit <- lm(Sales ~ TV + Radio, data = advertising_data)\n\n# 创建网格点\ngrid.lines = 50\nx.pred <- seq(min(advertising_data$TV), max(advertising_data$TV), length.out = grid.lines)\ny.pred <- seq(min(advertising_data$Radio), max(advertising_data$Radio), length.out = grid.lines)\nxy <- expand.grid(TV = x.pred, Radio = y.pred)\n\n# 预测z值\nz.pred <- matrix(predict(fit, newdata = xy), \n                nrow = grid.lines, ncol = grid.lines)\n\n# 创建3D图\nplot_ly() %>%\n  add_trace(data = advertising_data, \n            x = ~TV, y = ~Radio, z = ~Sales,\n            type = \"scatter3d\", mode = \"markers\",\n            marker = list(size = 5, color = \"blue\", opacity = 0.5)) %>%\n  add_surface(x = x.pred, y = y.pred, z = z.pred,\n              colorscale = \"Viridis\", opacity = 0.8) %>%\n  layout(title = \"销售额与电视、广播广告投入的关系\",\n         scene = list(xaxis = list(title = \"电视广告\"),\n                     yaxis = list(title = \"广播广告\"),\n                     zaxis = list(title = \"销售额\")))\n```\n:::\n\n\n\n\n**变量选择方法**：\n当有多个潜在自变量时，我们需要选择一个最佳的变量子集：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 向前逐步回归\nnull_model <- lm(Sales ~ 1, data = advertising_data)\nfull_model <- lm(Sales ~ ., data = advertising_data)\nforward_model <- step(null_model, scope = list(lower = null_model, upper = full_model), \n                    direction = \"forward\")\n\n# 向后逐步回归\nbackward_model <- step(full_model, direction = \"backward\")\n\n# 双向逐步回归（同时考虑增加和删除变量）\nstepwise_model <- step(null_model, scope = list(lower = null_model, upper = full_model), \n                     direction = \"both\")\n\n# 使用Leaps包进行最优子集选择\nlibrary(leaps)\nsubsets <- regsubsets(Sales ~ ., data = advertising_data, nvmax = ncol(advertising_data) - 1)\nsummary(subsets)\nplot(subsets, scale = \"r2\")\nplot(subsets, scale = \"adjr2\")\nplot(subsets, scale = \"Cp\")\nplot(subsets, scale = \"bic\")\n```\n:::\n\n\n\n\n**正则化回归**：\n处理多重共线性和预防过拟合的现代方法：\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 岭回归\nlibrary(glmnet)\nx <- as.matrix(advertising_data[, c(\"TV\", \"Radio\", \"Newspaper\")])\ny <- advertising_data$Sales\nridge_model <- glmnet(x, y, alpha = 0)\nplot(ridge_model, xvar = \"lambda\", label = TRUE)\ncv_ridge <- cv.glmnet(x, y, alpha = 0)\nbest_lambda <- cv_ridge$lambda.min\nridge_coef <- coef(ridge_model, s = best_lambda)\n\n# Lasso回归\nlasso_model <- glmnet(x, y, alpha = 1)\nplot(lasso_model, xvar = \"lambda\", label = TRUE)\ncv_lasso <- cv.glmnet(x, y, alpha = 1)\nbest_lambda <- cv_lasso$lambda.min\nlasso_coef <- coef(lasso_model, s = best_lambda)\n```\n:::\n\n\n\n\n### 回归分析的实际应用案例\n\n**案例1：房价预测模型**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 导入波士顿房价数据集\nlibrary(MASS)\ndata(Boston)\nhead(Boston)\n\n# 变量说明\n# medv: 自住房屋的中位数价值（千美元）（因变量）\n# rm: 每套住宅的平均房间数\n# lstat: 人口中地位较低人群的百分比\n# crim: 城镇人均犯罪率\n# zn: 占地面积超过2.5万平方英尺的住宅用地比例\n# indus: 每个城镇非零售业务的比例\n# chas: 查尔斯河虚拟变量（1 = 边界在河边；0 = 否）\n# nox: 一氧化氮浓度（千万分之一）\n# ...\n\n# 探索性分析\npairs(Boston[, c(\"medv\", \"rm\", \"lstat\", \"crim\", \"nox\")])\ncor(Boston)\n\n# 建立模型\nmodel_all <- lm(medv ~ ., data = Boston)\nsummary(model_all)\n\n# 变量选择\nstep_model <- step(model_all, direction = \"both\")\nsummary(step_model)\n\n# 最优模型解释与诊断\npar(mfrow = c(2, 2))\nplot(step_model)\n\n# 预测\nnew_house <- data.frame(\n  rm = 6.5,\n  lstat = 10,\n  crim = 0.5,\n  zn = 50,\n  indus = 5,\n  chas = 0,\n  nox = 0.5,\n  age = 50,\n  dis = 4,\n  rad = 6,\n  tax = 400,\n  ptratio = 15,\n  black = 380,\n  chas = 0\n)\n\npredict(step_model, newdata = new_house, interval = \"prediction\")\n```\n:::\n\n\n\n\n**案例2：销售额预测与营销投资优化**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 使用前面的广告数据\n# 假设我们有一个额外的数据集，包含不同产品线的广告效果\nproduct_data <- data.frame(\n  product = rep(c(\"A\", \"B\", \"C\"), each = 30),\n  TV = runif(90, 5, 50),\n  Radio = runif(90, 1, 30),\n  Newspaper = runif(90, 0, 20)\n)\n# 生成不同的效应模式\nproduct_data$Sales <- 5 + \n  ifelse(product_data$product == \"A\", 0.2, \n         ifelse(product_data$product == \"B\", 0.1, 0.05)) * product_data$TV +\n  ifelse(product_data$product == \"A\", 0.15, \n         ifelse(product_data$product == \"B\", 0.3, 0.1)) * product_data$Radio +\n  ifelse(product_data$product == \"A\", 0.05, \n         ifelse(product_data$product == \"B\", 0.1, 0.2)) * product_data$Newspaper +\n  rnorm(90, 0, 2)\n\n# 分析不同产品线的广告效果\nlibrary(ggplot2)\nggplot(product_data, aes(x = TV, y = Sales, color = product)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~product) +\n  labs(title = \"不同产品线的电视广告效果\") +\n  theme_minimal()\n\n# 为每个产品线建立单独的模型\nproduct_models <- list()\nfor(p in unique(product_data$product)) {\n  subset_data <- product_data[product_data$product == p, ]\n  product_models[[p]] <- lm(Sales ~ TV + Radio + Newspaper, data = subset_data)\n  print(paste(\"Product\", p, \"model:\"))\n  print(summary(product_models[[p]]))\n}\n\n# 互动效应模型（产品与广告渠道的交互）\ninteraction_model <- lm(Sales ~ product * (TV + Radio + Newspaper), \n                        data = product_data)\nsummary(interaction_model)\n\n# 营销预算优化：基于边际回报率\n# 根据回归系数计算每个渠道的投资回报率，优化预算分配\n```\n:::\n\n\n\n\n**案例3：市场细分分析**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 不同市场细分的回归分析\nsegment_data <- data.frame(\n  customer_segment = rep(c(\"高收入\", \"中收入\", \"低收入\"), each = 30),\n  price = runif(90, 50, 200),\n  promotion = runif(90, 0, 1),\n  store_quality = runif(90, 1, 5)\n)\n# 不同细分市场的消费者对价格和促销的敏感度不同\nsegment_data$purchase <- 10 +\n  ifelse(segment_data$customer_segment == \"高收入\", -0.01, \n         ifelse(segment_data$customer_segment == \"中收入\", -0.03, -0.05)) * segment_data$price +\n  ifelse(segment_data$customer_segment == \"高收入\", 1, \n         ifelse(segment_data$customer_segment == \"中收入\", 2, 3)) * segment_data$promotion +\n  0.5 * segment_data$store_quality +\n  rnorm(90, 0, 1)\n\n# 分析不同细分市场的价格敏感度\nsegment_models <- list()\nfor(s in unique(segment_data$customer_segment)) {\n  subset_data <- segment_data[segment_data$customer_segment == s, ]\n  segment_models[[s]] <- lm(purchase ~ price + promotion + store_quality, \n                           data = subset_data)\n  print(paste(\"Segment\", s, \"model:\"))\n  print(summary(segment_models[[s]]))\n}\n\n# 差异化定价策略建议\nprice_sensitivity <- data.frame(\n  segment = names(segment_models),\n  price_effect = sapply(segment_models, function(model) coef(model)[\"price\"])\n)\nprint(price_sensitivity)\n```\n:::\n\n\n\n\n::: {.callout-tip appearance=\"simple\"}\n## AI辅助学习建议（第六周）\n\n### 回归分析理解与解释\n- **请AI解释回归系数的含义**：要求AI使用通俗易懂的语言解释回归系数的实际意义\n- **让AI比较相关分析与回归分析**：理解两者的区别和各自适用场景\n- **要求AI解释拟合优度(R²)**：深入理解R²的含义、局限性和在商业分析中的解读方式\n\n### R代码编写与模型构建\n- **请AI生成完整的回归分析流程代码**：从数据探索、模型构建到诊断和解释的全流程代码\n- **让AI帮助进行变量选择**：生成向前、向后或逐步回归代码，并解释选择逻辑\n- **要求AI编写回归结果可视化代码**：创建更专业和直观的回归结果展示图\n\n### 回归模型诊断与优化\n- **请AI检查回归模型假设**：生成检验线性性、同方差性、独立性和正态性的代码和解释\n- **让AI解释多重共线性问题**：诊断和处理多重共线性的方法\n- **要求AI优化模型预测性能**：提供提高模型预测准确性的建议\n\n### 回归分析应用场景\n- **请AI推荐适合项目主题的回归应用问题**：根据选择的项目主题获取具体的研究问题建议\n- **让AI设计商业分析方案**：设计从数据收集到分析解释的完整方案\n- **要求AI解释回归分析在不同行业的应用**：了解回归分析在市场营销、金融、人力资源等领域的典型应用案例\n:::\n\n### 参考文献与扩展阅读\n\n1. James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). An Introduction to Statistical Learning. Springer.\n2. Kutner, M. H., Nachtsheim, C. J., Neter, J., & Li, W. (2005). Applied Linear Statistical Models (5th ed.). McGraw-Hill.\n3. Fox, J. (2016). Applied Regression Analysis and Generalized Linear Models (3rd ed.). SAGE Publications.\n4. Faraway, J. J. (2014). Linear Models with R (2nd ed.). Chapman and Hall/CRC.\n5. 李惠莲. (2018). 回归分析在商业决策中的应用. 统计与决策, 34(15), 82-85. ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}