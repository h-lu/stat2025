<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>第五周：做出判断：假设检验 (单/双样本) 与 ANOVA 应用 – 统计学与R语言</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week6_lecture.html" rel="next">
<link href="./week4_lecture.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xkm/sYwpb+ilR5gUw==" crossorigin="anonymous" referrerpolicy="no-referrer">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week1_lecture.html">讲义</a></li><li class="breadcrumb-item"><a href="./week5_lecture.html"><span class="chapter-title">第五周：做出判断：假设检验 (单/双样本) 与 ANOVA 应用</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">统计学与R语言</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">课程介绍</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">讲义</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第一周：启程：统计思维、R与数据世界</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第二周：数据的语言：获取、导入与初步描述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第三周：数据整形：<code>tidyverse</code> 的核心技艺</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第四周：眼见为实：<code>ggplot2</code> 可视化探索与推断初步</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5_lecture.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">第五周：做出判断：假设检验 (单/双样本) 与 ANOVA 应用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第六周：探索关系：相关与简单线性回归入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第七周：分类数据的智慧：卡方检验与阶段总结</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第八周：承前启后：阶段回顾与多元回归再探</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week9_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第九周：模型诊断实战：发现模型的问题</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十周：模型改进与选择的批判性视角</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week11_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十一周：预测分类结果：Logistic 回归（一）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week12_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十二周：Logistic 回归评估 与 模型比较初步</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./综合实践项目启动指南_五一假期.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">综合实践项目启动详细指南 (五一假期任务)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week13_lecture.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第13周：AI赋能分析、可重复报告与项目实践</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./统计学与R语言期末复习指南.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">统计学与R语言期末复习指南</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">实验</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第一周实验：R 环境与基础操作</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第二周实验：数据导入与描述性统计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第三周实验：<code>dplyr</code> 进阶与 <code>tidyr</code> 数据整形</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第四周实验：<code>ggplot2</code> 可视化探索</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第五周实验：假设检验实践 (t-检验与 ANOVA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第六周实验：相关与简单线性回归实践</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第七周实验：卡方检验与统计方法选择</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第八周实验：阶段回顾与多元回归实践</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week9_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第九周实验：回归模型诊断实践</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十周实验：模型改进与选择实践</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week11_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十一周实验：Logistic 回归拟合与解释</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week12_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第十二周实验：Logistic 回归评估与模型比较</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week13_lab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第13周实验：深入探索nycflights13 - AI与Quarto实战</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#假设检验基于证据做决策" id="toc-假设检验基于证据做决策" class="nav-link active" data-scroll-target="#假设检验基于证据做决策">1. 假设检验：基于证据做决策</a></li>
  <li><a href="#假设检验的逻辑步骤" id="toc-假设检验的逻辑步骤" class="nav-link" data-scroll-target="#假设检验的逻辑步骤">2. 假设检验的逻辑步骤</a></li>
  <li><a href="#两类错误" id="toc-两类错误" class="nav-link" data-scroll-target="#两类错误">3. 两类错误</a></li>
  <li><a href="#单样本-t-检验-one-sample-t-test" id="toc-单样本-t-检验-one-sample-t-test" class="nav-link" data-scroll-target="#单样本-t-检验-one-sample-t-test">4. 单样本 t 检验 (One-Sample t-test)</a></li>
  <li><a href="#双独立样本-t-检验-two-independent-samples-t-test" id="toc-双独立样本-t-检验-two-independent-samples-t-test" class="nav-link" data-scroll-target="#双独立样本-t-检验-two-independent-samples-t-test">5. 双独立样本 t 检验 (Two-Independent-Samples t-test)</a></li>
  <li><a href="#配对样本-t-检验-paired-samples-t-test" id="toc-配对样本-t-检验-paired-samples-t-test" class="nav-link" data-scroll-target="#配对样本-t-检验-paired-samples-t-test">6. 配对样本 t 检验 (Paired-Samples t-test)</a></li>
  <li><a href="#单因素方差分析-one-way-anova" id="toc-单因素方差分析-one-way-anova" class="nav-link" data-scroll-target="#单因素方差分析-one-way-anova">7. 单因素方差分析 (One-Way ANOVA)</a></li>
  <li><a href="#事后检验-post-hoc-tests" id="toc-事后检验-post-hoc-tests" class="nav-link" data-scroll-target="#事后检验-post-hoc-tests">8. 事后检验 (Post-hoc Tests)</a></li>
  <li><a href="#项目相关与本周总结" id="toc-项目相关与本周总结" class="nav-link" data-scroll-target="#项目相关与本周总结">9. 项目相关与本周总结</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week1_lecture.html">讲义</a></li><li class="breadcrumb-item"><a href="./week5_lecture.html"><span class="chapter-title">第五周：做出判断：假设检验 (单/双样本) 与 ANOVA 应用</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">第五周：做出判断：假设检验 (单/双样本) 与 ANOVA 应用</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="假设检验基于证据做决策" class="level2">
<h2 class="anchored" data-anchor-id="假设检验基于证据做决策">1. 假设检验：基于证据做决策</h2>
<p>上周我们学习了如何用置信区间来估计总体参数的范围。<strong>假设检验 (Hypothesis Testing)</strong> 是推断统计的另一个核心工具，它提供了一个正式的框架，用于<strong>利用样本数据来判断关于总体的某个断言（假设）是否可信</strong>。</p>
<ul>
<li><strong>核心思想:</strong> 我们想检验一个关于总体的<strong>原假设 (Null Hypothesis,</strong> <span class="math inline">\(H_0\)</span>)。我们收集样本数据，看样本证据<strong>在多大程度上反对</strong> <span class="math inline">\(H_0\)</span>。如果证据足够强（即样本结果在 <span class="math inline">\(H_0\)</span> 成立的条件下非常罕见），我们就<strong>拒绝</strong> <span class="math inline">\(H_0\)</span>，并接受与之对立的<strong>备择假设 (Alternative Hypothesis,</strong> <span class="math inline">\(H_1\)</span> 或 <span class="math inline">\(H_a\)</span>)。</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="本周目标">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
本周目标
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>理解假设检验的基本逻辑：原假设、备择假设、P 值、显著性水平、决策规则。</li>
<li>区分并理解两类错误。</li>
<li>掌握单样本 t 检验的应用场景、假设、R 实现和结果解读。</li>
<li>掌握双独立样本 t 检验的应用场景、假设（特别是方差齐性）、R 实现和结果解读。</li>
<li>掌握配对样本 t 检验的应用场景、与独立样本的区别、R 实现和结果解读。</li>
<li>理解为何需要方差分析 (ANOVA) 来比较多组均值。</li>
<li>掌握单因素 ANOVA 的应用场景、假设、R 实现和结果解读（ANOVA 表）。</li>
<li>理解事后检验的必要性，并掌握 Tukey’s HSD 的 R 实现和解读。</li>
</ul>
</div>
</div>
</section>
<section id="假设检验的逻辑步骤" class="level2">
<h2 class="anchored" data-anchor-id="假设检验的逻辑步骤">2. 假设检验的逻辑步骤</h2>
<p>一个典型的假设检验包含以下步骤：</p>
<ol type="1">
<li><strong>陈述假设:</strong>
<ul>
<li><strong>原假设 (</strong><span class="math inline">\(H_0\)</span>): 通常是表示“没有效应”、“没有差异”或维持现状的陈述。它包含等号（=, ≤, ≥）。我们总是<strong>假设</strong> <span class="math inline">\(H_0\)</span> 为真开始分析。
<ul>
<li>例：新药无效 (<span class="math inline">\(μ_{新药} = μ_{安慰剂}\)</span>)。</li>
<li>例：产品合格率不低于 95% (<span class="math inline">\(p \ge 0.95\)</span>)。</li>
</ul></li>
<li><strong>备择假设 (</strong><span class="math inline">\(H_1\)</span> 或 <span class="math inline">\(H_a\)</span>): 我们希望找到证据支持的陈述，通常是表示“有效应”、“有差异”或我们怀疑的情况。它不包含等号（≠, &lt;, &gt;）。
<ul>
<li>例：新药有效 (<span class="math inline">\(μ_{新药} \ne μ_{安慰剂}\)</span>，双侧检验；或 <span class="math inline">\(μ_{新药} &gt; μ_{安慰剂}\)</span>，单侧检验)。</li>
<li>例：产品合格率低于 95% (<span class="math inline">\(p &lt; 0.95\)</span>)。</li>
</ul></li>
</ul></li>
<li><strong>选择显著性水平 (</strong><span class="math inline">\(\alpha\)</span>):
<ul>
<li><span class="math inline">\(\alpha\)</span> 是我们愿意承担的<strong>犯第一类错误的概率</strong>（见下文）。</li>
<li>它代表了我们拒绝 <span class="math inline">\(H_0\)</span> 所需的证据强度阈值。</li>
<li>常用值：0.05 (5%)，有时也用 0.01 或 0.10。<strong>需要在分析前确定</strong>。</li>
</ul></li>
<li><strong>计算检验统计量 (Test Statistic)</strong>:
<ul>
<li>根据样本数据计算一个值，该值衡量了样本结果与 <span class="math inline">\(H_0\)</span> 预期结果之间的差异程度（考虑了抽样变异性）。</li>
<li>不同的检验方法有不同的检验统计量（如 t 值, F 值, <span class="math inline">\(\chi^2\)</span> 值）。</li>
</ul></li>
<li><strong>计算 P 值 (P-value)</strong>:
<ul>
<li><strong>核心概念:</strong> P 值是在<strong>假设</strong> <span class="math inline">\(H_0\)</span> 为真的前提下，观察到<strong>当前样本结果或更极端结果</strong>的概率。</li>
<li>P 值越小，表示样本结果在 <span class="math inline">\(H_0\)</span> 下越不可能发生，反对 <span class="math inline">\(H_0\)</span> 的证据越强。</li>
</ul></li>
<li><strong>做出决策:</strong>
<ul>
<li>将 P 值与显著性水平 <span class="math inline">\(\alpha\)</span> 进行比较：
<ul>
<li>如果 <strong>P 值 ≤</strong> <span class="math inline">\(\alpha\)</span>: 结果具有<strong>统计显著性 (Statistically Significant)</strong>。我们<strong>拒绝</strong> <span class="math inline">\(H_0\)</span>，接受 <span class="math inline">\(H_1\)</span>。有足够证据反对原假设。</li>
<li>如果 <strong>P 值 &gt;</strong> <span class="math inline">\(\alpha\)</span>: 结果<strong>不具有</strong>统计显著性。我们<strong>未能拒绝 (Fail to Reject)</strong> <span class="math inline">\(H_0\)</span>。没有足够证据反对原假设。</li>
</ul></li>
<li><strong>注意:</strong> 未能拒绝 <span class="math inline">\(H_0\)</span> <strong>不等于</strong> 证明 <span class="math inline">\(H_0\)</span> 为真，只是证据不足以推翻它。</li>
</ul></li>
<li><strong>解释结果:</strong> 结合具体问题情境，用通俗语言解释决策的含义。</li>
</ol>
</section>
<section id="两类错误" class="level2">
<h2 class="anchored" data-anchor-id="两类错误">3. 两类错误</h2>
<p>在假设检验中，我们可能做出错误的决策：</p>
<ul>
<li><strong>第一类错误 (Type I Error,</strong> <span class="math inline">\(\alpha\)</span> 错误, 弃真错误):
<ul>
<li>当 <span class="math inline">\(H_0\)</span> <strong>实际上为真</strong>时，我们却<strong>拒绝</strong>了它。</li>
<li>发生概率为 <span class="math inline">\(\alpha\)</span> (显著性水平)。</li>
<li>后果：错误地认为有效应或差异（例如，认为无效药有效）。</li>
</ul></li>
<li><strong>第二类错误 (Type II Error,</strong> <span class="math inline">\(\beta\)</span> 错误, 取伪错误):
<ul>
<li>当 <span class="math inline">\(H_0\)</span> <strong>实际上为假</strong>（<span class="math inline">\(H_1\)</span> 为真）时，我们却<strong>未能拒绝</strong>它。</li>
<li>发生概率为 <span class="math inline">\(\beta\)</span>。</li>
<li><strong>统计功效 (Power)</strong> = <span class="math inline">\(1 - \beta\)</span>，即当 <span class="math inline">\(H_1\)</span> 为真时，正确拒绝 <span class="math inline">\(H_0\)</span> 的概率。</li>
<li>后果：未能发现存在的效应或差异（例如，未能发现有效药物的效果）。</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled" title="错误权衡">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
错误权衡
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 通常是相互制约的。降低 <span class="math inline">\(\alpha\)</span>（减少犯第一类错误的风险）通常会增加 <span class="math inline">\(\beta\)</span>（增加犯第二类错误的风险），反之亦然。选择 <span class="math inline">\(\alpha\)</span> 需要权衡两类错误的相对严重性。统计功效受样本量、效应大小、<span class="math inline">\(\alpha\)</span> 水平和数据变异性影响。</p>
</div>
</div>
</section>
<section id="单样本-t-检验-one-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="单样本-t-检验-one-sample-t-test">4. 单样本 t 检验 (One-Sample t-test)</h2>
<ul>
<li><p><strong>目的:</strong> 检验<strong>单个总体的均值</strong> <span class="math inline">\(\mu\)</span> 是否等于某个<strong>已知的特定值</strong> <span class="math inline">\(\mu_0\)</span>。</p></li>
<li><p><strong>应用场景:</strong></p>
<ul>
<li>某品牌矿泉水声称每瓶含钠量为 20mg，检验是否属实？(<span class="math inline">\(H_0: \mu = 20\)</span>)</li>
<li>某地区去年人均收入为 50000 元，今年是否有显著变化？(<span class="math inline">\(H_0: \mu = 50000\)</span>)</li>
</ul></li>
<li><p><strong>假设条件:</strong></p>
<ol type="1">
<li>样本是<strong>随机</strong>从总体中抽取的。</li>
<li>总体分布<strong>近似正态</strong>，或者<strong>样本量足够大</strong>（通常 n ≥ 30，中心极限定理保证样本均值的抽样分布近似正态）。可以通过 QQ 图或 Shapiro-Wilk 检验来检查正态性。</li>
</ol></li>
<li><p><strong>检验统计量 (t 值):</strong> <span class="math display">\[ t = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} \]</span> 其中 <span class="math inline">\(\bar{x}\)</span> 是样本均值，<span class="math inline">\(\mu_0\)</span> 是假设的总体均值， <span class="math inline">\(s\)</span> 是样本标准差， <span class="math inline">\(n\)</span> 是样本量。该统计量服从自由度为 <span class="math inline">\(df = n-1\)</span> 的 t 分布。</p></li>
<li><p><strong>R 实现: <code>t.test()</code></strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例：检验一批灯泡的平均寿命是否显著不等于 1000 小时</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>lifespan <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">980</span>, <span class="dv">1020</span>, <span class="dv">1010</span>, <span class="dv">995</span>, <span class="dv">970</span>, <span class="dv">1035</span>, <span class="dv">1005</span>, <span class="dv">960</span>, <span class="dv">1015</span>, <span class="dv">990</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(lifespan)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(lifespan)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(lifespan)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Sample Mean:"</span>, sample_mean, <span class="st">"Sample SD:"</span>, sample_sd, <span class="st">"n:"</span>, n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "Sample Mean: 998 Sample SD: 23.4757558155453 n: 10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu = 1000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: mu != 1000 (双侧检验)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(lifespan, <span class="at">mu =</span> <span class="dv">1000</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  One Sample t-test
#&gt; 
#&gt; data:  lifespan
#&gt; t = -0.26941, df = 9, p-value = 0.7937
#&gt; alternative hypothesis: true mean is not equal to 1000
#&gt; 95 percent confidence interval:
#&gt;   981.2065 1014.7935
#&gt; sample estimates:
#&gt; mean of x 
#&gt;       998</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 访问结果的关键信息</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>t_test_result<span class="sc">$</span>statistic <span class="co"># t 值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;         t 
#&gt; -0.269408</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>t_test_result<span class="sc">$</span>parameter <span class="co"># 自由度 (df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; df 
#&gt;  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>t_test_result<span class="sc">$</span>p.value   <span class="co"># P 值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.7936906</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t_test_result<span class="sc">$</span>conf.int  <span class="co"># 总体均值的置信区间 (默认 95%)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1]  981.2065 1014.7935
#&gt; attr(,"conf.level")
#&gt; [1] 0.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>t_test_result<span class="sc">$</span>estimate  <span class="co"># 样本均值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; mean of x 
#&gt;       998</code></pre>
</div>
</div></li>
<li><p><strong>结果解读:</strong></p>
<ul>
<li>查看 <strong>P 值</strong>。如果 P 值 &lt; <span class="math inline">\(\alpha\)</span> (例如 0.05)，则拒绝 <span class="math inline">\(H_0\)</span>。</li>
<li>在上面的例子中，如果 P 值 &lt; 0.05，我们可以说：有统计学证据表明这批灯泡的平均寿命<strong>显著不等于</strong> 1000 小时 (在 <span class="math inline">\(\alpha=0.05\)</span> 水平下)。</li>
<li>查看<strong>置信区间</strong>。如果 <span class="math inline">\(\mu_0\)</span> (这里是 1000) <strong>不包含</strong>在置信区间内，也支持拒绝 <span class="math inline">\(H_0\)</span>。置信区间给出了总体均值可能的范围。</li>
<li><strong>单侧检验:</strong> 如果想检验平均寿命是否<strong>大于</strong> 1000 (<span class="math inline">\(H_1: \mu &gt; 1000\)</span>)，使用 <code>alternative = "greater"</code>；如果想检验是否<strong>小于</strong> 1000 (<span class="math inline">\(H_1: \mu &lt; 1000\)</span>)，使用 <code>alternative = "less"</code>。</li>
</ul></li>
</ul>
</section>
<section id="双独立样本-t-检验-two-independent-samples-t-test" class="level2">
<h2 class="anchored" data-anchor-id="双独立样本-t-检验-two-independent-samples-t-test">5. 双独立样本 t 检验 (Two-Independent-Samples t-test)</h2>
<ul>
<li><p><strong>目的:</strong> 比较<strong>两个独立总体</strong>的均值 <span class="math inline">\(\mu_1\)</span> 和 <span class="math inline">\(\mu_2\)</span> 是否相等。</p></li>
<li><p><strong>应用场景:</strong></p>
<ul>
<li>比较两种不同教学方法下学生的平均成绩是否有差异？(<span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>)</li>
<li>比较男性和女性的平均工资是否有差异？(<span class="math inline">\(H_0: \mu_{male} = \mu_{female}\)</span>)</li>
</ul></li>
<li><p><strong>假设条件:</strong></p>
<ol type="1">
<li>两个样本是<strong>独立</strong>随机抽取的。</li>
<li>两个总体都<strong>近似正态</strong>分布，或者两个样本量都<strong>足够大</strong> (n1 ≥ 30, n2 ≥ 30)。</li>
<li><strong>方差齐性 (Homogeneity of Variances):</strong> 两个总体的方差 <span class="math inline">\(\sigma_1^2\)</span> 和 <span class="math inline">\(\sigma_2^2\)</span> 相等。这是传统 Student’s t-test 的要求。
<ul>
<li><strong>检验方差齐性:</strong> 可以使用 Levene’s test 或 F 检验 (<code>var.test()</code>)。<span class="math inline">\(H_0\)</span>: 方差相等。如果 P 值 &gt; <span class="math inline">\(\alpha\)</span> (如 0.05)，则不能拒绝方差齐性的假设。</li>
<li><strong>方差不齐怎么办？</strong> R 中的 <code>t.test()</code> 默认使用 <strong>Welch’s t-test</strong>，它<strong>不要求方差齐性</strong>，是对自由度进行了调整的 t 检验，通常更推荐使用。</li>
</ul></li>
</ol></li>
<li><p><strong>R 实现: <code>t.test()</code></strong> (使用公式语法或分别传入两个向量)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例：比较两种肥料对作物产量的影响</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>yield_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">26</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>yield_B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">29</span>, <span class="dv">38</span>, <span class="dv">31</span>, <span class="dv">33</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. (可选但推荐) 检查方差齐性</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>var_test_result <span class="ot">&lt;-</span> <span class="fu">var.test</span>(yield_A, yield_B)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_test_result) <span class="co"># 查看 P 值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  F test to compare two variances
#&gt; 
#&gt; data:  yield_A and yield_B
#&gt; F = 0.92, num df = 4, denom df = 5, p-value = 0.9625
#&gt; alternative hypothesis: true ratio of variances is not equal to 1
#&gt; 95 percent confidence interval:
#&gt;  0.1245282 8.6153132
#&gt; sample estimates:
#&gt; ratio of variances 
#&gt;               0.92</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 执行 t 检验</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu_A = mu_B (或 mu_A - mu_B = 0)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: mu_A != mu_B</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 默认使用 Welch's t-test (var.equal = FALSE)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>t_test_ind_welch <span class="ot">&lt;-</span> <span class="fu">t.test</span>(yield_A, yield_B)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_ind_welch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  yield_A and yield_B
#&gt; t = -3.6313, df = 8.7711, p-value = 0.005715
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -11.053048  -2.546952
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;      26.2      33.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 如果方差齐性检验 P 值很大 (如 &gt; 0.1 或 0.05)，且你坚持使用 Student's t-test</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># t_test_ind_student &lt;- t.test(yield_A, yield_B, var.equal = TRUE)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(t_test_ind_student)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用公式语法 (数据需要是长格式)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>yield_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Yield =</span> <span class="fu">c</span>(yield_A, yield_B),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fertilizer =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="fu">length</span>(yield_A), <span class="fu">length</span>(yield_B))))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(yield_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 11 × 2
#&gt;    Yield Fertilizer
#&gt;    &lt;dbl&gt; &lt;fct&gt;     
#&gt;  1    25 A         
#&gt;  2    28 A         
#&gt;  3    22 A         
#&gt;  4    30 A         
#&gt;  5    26 A         
#&gt;  6    32 B         
#&gt;  7    35 B         
#&gt;  8    29 B         
#&gt;  9    38 B         
#&gt; 10    31 B         
#&gt; 11    33 B</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Yield <span class="sc">~</span> Fertilizer, <span class="at">data =</span> yield_data) <span class="co"># 默认 Welch</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  Yield by Fertilizer
#&gt; t = -3.6313, df = 8.7711, p-value = 0.005715
#&gt; alternative hypothesis: true difference in means between group A and group B is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -11.053048  -2.546952
#&gt; sample estimates:
#&gt; mean in group A mean in group B 
#&gt;            26.2            33.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(Yield ~ Fertilizer, data = yield_data, var.equal = TRUE) # Student's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><strong>结果解读:</strong></p>
<ul>
<li>同样关注 <strong>P 值</strong>。如果 P 值 &lt; <span class="math inline">\(\alpha\)</span>，拒绝 <span class="math inline">\(H_0\)</span>，认为两个总体的均值有显著差异。</li>
<li>查看<strong>置信区间</strong> (针对均值差 <span class="math inline">\(\mu_1 - \mu_2\)</span>)。如果区间<strong>不包含 0</strong>，也支持拒绝 <span class="math inline">\(H_0\)</span>。区间给出了两个总体均值差异的可能范围。</li>
<li>同样可以进行单侧检验 (<code>alternative = "greater"</code> 或 <code>"less"</code>)。</li>
</ul></li>
</ul>
</section>
<section id="配对样本-t-检验-paired-samples-t-test" class="level2">
<h2 class="anchored" data-anchor-id="配对样本-t-检验-paired-samples-t-test">6. 配对样本 t 检验 (Paired-Samples t-test)</h2>
<ul>
<li><p><strong>目的:</strong> 比较<strong>同一个对象</strong>在<strong>两种不同条件下</strong>或<strong>两个不同时间点</strong>的均值是否存在差异。本质上是检验<strong>差值的均值</strong>是否等于 0。</p></li>
<li><p><strong>应用场景:</strong></p>
<ul>
<li>比较同一批患者服药前后的血压平均值是否有变化？</li>
<li>比较同一组学生使用两种不同学习方法后的测试成绩是否有差异？</li>
<li>比较同一块土地使用两种不同肥料的产量是否有差异（需要配对设计）？</li>
</ul></li>
<li><p><strong>与独立样本的区别:</strong> 独立样本是比较<strong>两个不同组</strong>的对象；配对样本是比较<strong>同一组对象</strong>的两次测量。配对设计可以有效控制个体差异。</p></li>
<li><p><strong>假设条件:</strong></p>
<ol type="1">
<li>样本是<strong>配对</strong>的。</li>
<li>配对<strong>差值 (Differences)</strong> 来自的总体<strong>近似正态</strong>分布，或者<strong>配对数量足够大</strong> (n_pairs ≥ 30)。</li>
</ol></li>
<li><p><strong>检验统计量:</strong> 对<strong>差值</strong>进行单样本 t 检验，检验差值的均值 <span class="math inline">\(\mu_d\)</span> 是否等于 0。 <span class="math display">\[ t = \frac{\bar{d} - 0}{s_d / \sqrt{n_{pairs}}} \]</span> 其中 <span class="math inline">\(\bar{d}\)</span> 是差值的样本均值，<span class="math inline">\(s_d\)</span> 是差值的样本标准差，<span class="math inline">\(n_{pairs}\)</span> 是配对数量。自由度 <span class="math inline">\(df = n_{pairs}-1\)</span>。</p></li>
<li><p><strong>R 实现: <code>t.test()</code></strong> (设置 <code>paired = TRUE</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例：比较 10 名学生使用新旧两种教学方法后的测试得分</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>score_old <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">82</span>, <span class="dv">68</span>, <span class="dv">79</span>, <span class="dv">88</span>, <span class="dv">72</span>, <span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">77</span>, <span class="dv">81</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>score_new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">75</span>, <span class="dv">81</span>, <span class="dv">92</span>, <span class="dv">78</span>, <span class="dv">93</span>, <span class="dv">88</span>, <span class="dv">80</span>, <span class="dv">84</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu_diff = 0 (两种方法得分均值无差异)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: mu_diff != 0</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>t_test_paired <span class="ot">&lt;-</span> <span class="fu">t.test</span>(score_new, score_old, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_paired)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Paired t-test
#&gt; 
#&gt; data:  score_new and score_old
#&gt; t = 7.7316, df = 9, p-value = 2.904e-05
#&gt; alternative hypothesis: true mean difference is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  2.758912 5.041088
#&gt; sample estimates:
#&gt; mean difference 
#&gt;             3.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 也可以先计算差值，再做单样本 t 检验</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># differences &lt;- score_new - score_old</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(differences, mu = 0) # 结果与上面相同</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><strong>结果解读:</strong></p>
<ul>
<li>关注 <strong>P 值</strong>。如果 P 值 &lt; <span class="math inline">\(\alpha\)</span>，拒绝 <span class="math inline">\(H_0\)</span>，认为两种条件下或两个时间点的均值存在显著差异。</li>
<li>查看<strong>置信区间</strong> (针对差值的均值 <span class="math inline">\(\mu_d\)</span>)。如果区间<strong>不包含 0</strong>，也支持拒绝 <span class="math inline">\(H_0\)</span>。区间给出了均值差异的可能范围。</li>
<li>同样可以进行单侧检验。例如，检验新方法是否<strong>优于</strong>旧方法 (<span class="math inline">\(H_1: \mu_d &gt; 0\)</span>)，使用 <code>alternative = "greater"</code>。</li>
</ul></li>
</ul>
</section>
<section id="单因素方差分析-one-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="单因素方差分析-one-way-anova">7. 单因素方差分析 (One-Way ANOVA)</h2>
<ul>
<li><p><strong>动机:</strong> 当我们要比较<strong>三个或更多</strong>独立组的均值时，如果两两进行 t 检验，会增加犯第一类错误的概率（多重比较问题）。例如，比较 3 组，需要做 3 次 t 检验，总体 <span class="math inline">\(\alpha\)</span> 会膨胀。ANOVA 提供了一种<strong>一次性</strong>检验所有组均值是否<strong>完全相等</strong>的方法。</p></li>
<li><p><strong>目的:</strong> 检验<strong>三个或更多</strong>独立总体的均值是否<strong>全部相等</strong>。</p></li>
<li><p><strong>应用场景:</strong></p>
<ul>
<li>比较三种不同肥料对作物产量的平均影响是否相同？</li>
<li>比较四种不同教学方法下学生的平均成绩是否都一样？</li>
<li>比较不同地区（≥3个）的平均房价是否相同？</li>
</ul></li>
<li><p><strong>基本思想:</strong> 比较组间变异 (Between-group Variation) 与组内变异 (Within-group Variation)。</p>
<ul>
<li>如果组间变异<strong>显著大于</strong>组内变异，则说明各组均值之间可能存在显著差异。</li>
</ul></li>
<li><p><strong>假设条件:</strong></p>
<ol type="1">
<li>各样本是<strong>独立</strong>随机抽取的。</li>
<li>各总体都<strong>近似正态</strong>分布。</li>
<li><strong>方差齐性:</strong> 各总体的方差<strong>相等</strong>。这对 ANOVA 比较重要，可以用 Levene’s test 检验。</li>
</ol></li>
<li><p><strong>假设陈述:</strong></p>
<ul>
<li><span class="math inline">\(H_0: \mu_1 = \mu_2 = ... = \mu_k\)</span> (所有 k 个总体的均值都相等)</li>
<li><span class="math inline">\(H_1:\)</span> 至少有一个总体的均值与其他总体不相等 (注意：不是所有均值都不等)。</li>
</ul></li>
<li><p><strong>检验统计量 (F 值):</strong> <span class="math display">\[ F = \frac{\text{组间均方 (Mean Square Between, MSB)}}{\text{组内均方 (Mean Square Within, MSW)}} \]</span></p>
<ul>
<li>MSB 度量了各样本均值相对于总均值的变异。</li>
<li>MSW 度量了每个样本内部数据的变异（是总体方差的估计）。</li>
<li>F 值服从 F 分布，具有两个自由度：<span class="math inline">\(df_1 = k-1\)</span> (组间自由度) 和 <span class="math inline">\(df_2 = N-k\)</span> (组内自由度)，其中 k 是组数，N 是总样本量。</li>
</ul></li>
<li><p><strong>R 实现: <code>aov()</code> (Analysis of Variance)</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例：比较三种不同教学方法 (A, B, C) 的学生成绩</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>scores_methodA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">85</span>, <span class="dv">82</span>, <span class="dv">79</span>, <span class="dv">88</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>scores_methodB <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">90</span>, <span class="dv">86</span>, <span class="dv">94</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>scores_methodC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">78</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">70</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 准备长格式数据</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>anova_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Score =</span> <span class="fu">c</span>(scores_methodA, scores_methodB, scores_methodC),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">5</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 15 × 2
#&gt;    Score Method
#&gt;    &lt;dbl&gt; &lt;fct&gt; 
#&gt;  1    78 A     
#&gt;  2    85 A     
#&gt;  3    82 A     
#&gt;  4    79 A     
#&gt;  5    88 A     
#&gt;  6    88 B     
#&gt;  7    92 B     
#&gt;  8    90 B     
#&gt;  9    86 B     
#&gt; 10    94 B     
#&gt; 11    72 C     
#&gt; 12    78 C     
#&gt; 13    75 C     
#&gt; 14    80 C     
#&gt; 15    70 C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (可选) 检查方差齐性 (例如使用 car 包的 leveneTest)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(car)</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># leveneTest(Score ~ Method, data = anova_data)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行 ANOVA</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: mu_A = mu_B = mu_C</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># H1: 至少有一个 mu 不相等</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Score <span class="sc">~</span> Method, <span class="at">data =</span> anova_data)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看 ANOVA 表</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
#&gt; Method       2  562.5  281.27   19.05 0.000189 ***
#&gt; Residuals   12  177.2   14.77                     
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><p><strong>解读 ANOVA 表 (<code>summary(anova_result)</code>)</strong></p>
<ul>
<li><code>Df</code>: 自由度 (<span class="math inline">\(k-1\)</span> 和 <span class="math inline">\(N-k\)</span>)。</li>
<li><code>Sum Sq</code>: 平方和 (组间 SSb, 组内 SSw)。</li>
<li><code>Mean Sq</code>: 均方 (MSB = SSb/df1, MSW = SSw/df2)。</li>
<li><code>F value</code>: F 统计量 (<span class="math inline">\(F = MSB / MSW\)</span>)。</li>
<li><code>Pr(&gt;F)</code>: <strong>P 值</strong>。</li>
<li><strong>决策:</strong> 查看 P 值。如果 P 值 &lt; <span class="math inline">\(\alpha\)</span> (如 0.05)，则<strong>拒绝</strong> <span class="math inline">\(H_0\)</span>。</li>
<li><strong>结论:</strong> 在上面的例子中，P 值 (0.000311) 远小于 0.05，因此我们拒绝 <span class="math inline">\(H_0\)</span>，认为<strong>至少有一种教学方法的平均成绩与其他方法存在显著差异</strong>。</li>
</ul></li>
</ul>
</section>
<section id="事后检验-post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="事后检验-post-hoc-tests">8. 事后检验 (Post-hoc Tests)</h2>
<ul>
<li><p><strong>为何需要？</strong> ANOVA 检验的 P 值 &lt; <span class="math inline">\(\alpha\)</span> 只能告诉我们<strong>至少有一组均值不同</strong>，但<strong>不能</strong>告诉我们具体是<strong>哪些组之间</strong>存在差异。</p></li>
<li><p><strong>目的:</strong> 在 ANOVA 拒绝 <span class="math inline">\(H_0\)</span> 后，进行两两比较，找出具体哪些组的均值存在显著差异。</p></li>
<li><p><strong>常用方法：Tukey’s Honest Significant Difference (HSD)</strong></p>
<ul>
<li>控制了进行所有可能两两比较时的总体第一类错误率。</li>
<li>计算每对组均值差的置信区间和调整后的 P 值。</li>
</ul></li>
<li><p><strong>R 实现: <code>TukeyHSD()</code></strong> (需要先运行 <code>aov()</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 对之前的 anova_result 进行 Tukey HSD 检验</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   Tukey multiple comparisons of means
#&gt;     95% family-wise confidence level
#&gt; 
#&gt; Fit: aov(formula = Score ~ Method, data = anova_data)
#&gt; 
#&gt; $Method
#&gt;      diff        lwr        upr     p adj
#&gt; B-A   7.6   1.116122 14.0838784 0.0220746
#&gt; C-A  -7.4 -13.883878 -0.9161216 0.0255847
#&gt; C-B -15.0 -21.483878 -8.5161216 0.0001311</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制置信区间图</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week5_lecture_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div></li>
<li><p><strong>解读 <code>TukeyHSD()</code> 结果:</strong></p>
<ul>
<li><code>diff</code>: 两组样本均值的差。</li>
<li><code>lwr</code>, <code>upr</code>: 均值差的 95% 置信区间下限和上限。</li>
<li><code>p adj</code>: 调整后的 P 值 (Adjusted P-value)。</li>
<li><strong>决策:</strong> 查看 <code>p adj</code>。如果 <code>p adj</code> &lt; <span class="math inline">\(\alpha\)</span> (如 0.05)，则认为该对组的均值存在显著差异。</li>
<li><strong>结论:</strong> 从上面的结果看，方法 B 的平均成绩显著高于方法 A 和方法 C；方法 C 和方法 A 之间没有显著差异 (在 <span class="math inline">\(\alpha=0.05\)</span> 水平下)。</li>
<li>置信区间图：如果区间<strong>不包含 0</strong>，则表示差异显著。</li>
</ul></li>
</ul>
</section>
<section id="项目相关与本周总结" class="level2">
<h2 class="anchored" data-anchor-id="项目相关与本周总结">9. 项目相关与本周总结</h2>
<ul>
<li><strong>项目任务:</strong>
<ul>
<li>根据你的项目问题和数据类型，判断是否需要进行 t 检验或 ANOVA。</li>
<li>如果需要比较两组（独立或配对），选择合适的 t 检验，执行并解释结果。</li>
<li>如果需要比较三组或更多组，执行 ANOVA。如果 ANOVA 结果显著，进行 Tukey’s HSD 事后检验，并解释具体哪些组之间存在差异。</li>
<li><strong>注意检查相应检验的假设条件</strong>（特别是正态性和方差齐性），可以在报告中提及检查结果或局限性。</li>
</ul></li>
<li><strong>本周回顾:</strong> 本周内容非常关键且密集。我们系统学习了假设检验的完整逻辑，并掌握了应用最广泛的几种检验方法：单样本 t 检验、双独立样本 t 检验、配对样本 t 检验和单因素方差分析 (ANOVA) 及其事后检验。理解每种检验的应用场景、假设条件、R 实现和结果解读至关重要。</li>
</ul>
<p><strong>下周预告:</strong> 我们将转向探索变量之间的<strong>关系</strong>，学习相关分析和简单线性回归，了解如何量化和描述两个连续变量之间的线性关联程度。</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week4_lecture.html" class="pagination-link" aria-label="第四周：眼见为实：`ggplot2` 可视化探索与推断初步">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">第四周：眼见为实：<code>ggplot2</code> 可视化探索与推断初步</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week6_lecture.html" class="pagination-link" aria-label="第六周：探索关系：相关与简单线性回归入门">
        <span class="nav-page-text"><span class="chapter-title">第六周：探索关系：相关与简单线性回归入门</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>