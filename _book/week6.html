<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>第六周：回归分析初步 – 统计学与R语言</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week7.html" rel="next">
<link href="./week5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/custom.css">
<link rel="stylesheet" href="styles/mermaid.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week5.html">项目二：商业数据分析与统计推断</a></li><li class="breadcrumb-item"><a href="./week6.html"><span class="chapter-title">第六周：回归分析初步</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">统计学与R语言</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/h-lu/stat2025" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">欢迎</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllbus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">课程概述</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">项目一：统计分析基础与数据可视化</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第一周：统计学导论</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第二周：R语言数据导入与数据初步理解</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第三周：描述性统计：数据探索与可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第四周：推断性统计初步：参数估计与假设检验</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">项目二：商业数据分析与统计推断</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第五周：方差分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">第六周：回归分析初步</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第七周：分类数据分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">第八周：项目二总结与汇报</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#第十一次课线性回归模型与最小二乘法" id="toc-第十一次课线性回归模型与最小二乘法" class="nav-link active" data-scroll-target="#第十一次课线性回归模型与最小二乘法">第十一次课：线性回归模型与最小二乘法</a>
  <ul class="collapse">
  <li><a href="#回归分析概述" id="toc-回归分析概述" class="nav-link" data-scroll-target="#回归分析概述">回归分析概述</a></li>
  <li><a href="#简单线性回归模型" id="toc-简单线性回归模型" class="nav-link" data-scroll-target="#简单线性回归模型">简单线性回归模型</a></li>
  <li><a href="#r语言实现简单线性回归" id="toc-r语言实现简单线性回归" class="nav-link" data-scroll-target="#r语言实现简单线性回归">R语言实现简单线性回归</a></li>
  </ul></li>
  <li><a href="#第十二次课多元线性回归模型" id="toc-第十二次课多元线性回归模型" class="nav-link" data-scroll-target="#第十二次课多元线性回归模型">第十二次课：多元线性回归模型</a>
  <ul class="collapse">
  <li><a href="#多元线性回归模型" id="toc-多元线性回归模型" class="nav-link" data-scroll-target="#多元线性回归模型">多元线性回归模型</a></li>
  </ul></li>
  <li><a href="#偏回归系数的解释" id="toc-偏回归系数的解释" class="nav-link" data-scroll-target="#偏回归系数的解释">偏回归系数的解释</a></li>
  <li><a href="#回归分析的实际应用案例" id="toc-回归分析的实际应用案例" class="nav-link" data-scroll-target="#回归分析的实际应用案例">回归分析的实际应用案例</a></li>
  <li><a href="#参考文献与扩展阅读" id="toc-参考文献与扩展阅读" class="nav-link" data-scroll-target="#参考文献与扩展阅读">参考文献与扩展阅读</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week5.html">项目二：商业数据分析与统计推断</a></li><li class="breadcrumb-item"><a href="./week6.html"><span class="chapter-title">第六周：回归分析初步</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">第六周：回归分析初步</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="第十一次课线性回归模型与最小二乘法" class="level2">
<h2 class="anchored" data-anchor-id="第十一次课线性回归模型与最小二乘法">第十一次课：线性回归模型与最小二乘法</h2>
<section id="回归分析概述" class="level3">
<h3 class="anchored" data-anchor-id="回归分析概述">回归分析概述</h3>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
回归分析的目的
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>研究关系</strong>：分析因变量与一个或多个自变量之间的关系。</li>
<li><strong>建立模型</strong>：构建模型以进行预测和解释现象。</li>
<li><strong>评估关联</strong>：评估变量之间关联的程度和方向。</li>
</ul>
<p>回归分析是商业分析中常用的核心技术之一，可以解答以下商业问题：</p>
<ul>
<li>哪些因素关键影响销售额？各自的影响程度如何？</li>
<li>如何通过产品特征预测产品价格？</li>
<li>不同的营销投入对业绩的边际贡献是多少？</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
回归分析的应用场景
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>预测</strong>：销售额预测、房价预测、股票价格预测等。</li>
<li><strong>行为分析</strong>：分析影响消费者购买行为的因素。</li>
<li><strong>效果评估</strong>：评估营销活动、政策实施等效果。</li>
<li><strong>绩效识别</strong>：识别影响企业绩效的关键指标。</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
回归分析的类型
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>按关系类型</strong>
<ul>
<li><strong>线性回归</strong>：自变量与因变量之间呈线性关系。</li>
<li><strong>非线性回归</strong>：自变量与因变量之间呈非线性关系。</li>
</ul></li>
<li><strong>按自变量数量</strong>
<ul>
<li><strong>简单线性回归</strong>：仅有一个自变量。</li>
<li><strong>多元线性回归</strong>：有多个自变量。</li>
</ul></li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
回归分析与其他统计方法的区别
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>与相关分析</strong>：回归分析不仅描述变量间的关系，更侧重于建立预测模型。</li>
<li><strong>与方差分析</strong>：回归分析主要处理连续型自变量，而方差分析侧重于分类自变量。</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
回归分析的基本步骤
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>模型确定</strong>：选择合适的回归模型类型 (线性/非线性，简单/多元)。</li>
<li><strong>参数估计</strong>：使用样本数据估计模型中的未知参数。</li>
<li><strong>模型检验</strong>：评估模型的拟合效果和统计显著性。</li>
<li><strong>模型应用</strong>：运用已建立的模型进行预测、解释和决策。</li>
</ol>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建示例数据</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>advertising_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">TV =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">50</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Radio =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">30</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Newspaper =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sales =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.15</span> <span class="sc">*</span> TV <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> Radio <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> Newspaper <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> TV, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"电视广告与销售额关系"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> Radio, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"广播广告与销售额关系"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> Newspaper, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"报纸广告与销售额关系"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="简单线性回归模型" class="level3">
<h3 class="anchored" data-anchor-id="简单线性回归模型">简单线性回归模型</h3>
<p><strong>模型形式</strong>：<span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span></p>
<ul>
<li><span class="math inline">\(y\)</span>：因变量</li>
<li><span class="math inline">\(x\)</span>：自变量</li>
<li><span class="math inline">\(\beta_0\)</span>：截距，当<span class="math inline">\(x=0\)</span>时，<span class="math inline">\(y\)</span>的期望值</li>
<li><span class="math inline">\(\beta_1\)</span>：斜率，自变量<span class="math inline">\(x\)</span>每增加一个单位，因变量<span class="math inline">\(y\)</span>的平均变化量</li>
<li><span class="math inline">\(\epsilon\)</span>：随机误差项，反映模型无法解释的随机变异</li>
</ul>
<p>简单线性回归是理解回归分析的基础，它描述了一个自变量和一个因变量之间的线性关系。例如，我们可以建立一个模型来描述广告支出（自变量）与销售额（因变量）之间的关系。</p>
<p><strong>最小二乘法(OLS)</strong>：</p>
<p>最小二乘法是一种估计回归系数的方法，其目标是找到能使误差平方和最小的回归线。</p>
<ul>
<li>目标：使残差平方和(RSS)最小化</li>
<li><span class="math inline">\(\text{RSS} = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2 = \sum_{i=1}^{n} (y_i - (\hat{\beta}_0 + \hat{\beta}_1 x_i))^2\)</span></li>
<li><span class="math inline">\(\hat{\beta}_0\)</span>和<span class="math inline">\(\hat{\beta}_1\)</span>是<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>的估计值</li>
<li><span class="math inline">\(\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i\)</span>是因变量<span class="math inline">\(y_i\)</span>的预测值</li>
</ul>
<p><strong>最小二乘估计的公式</strong>：</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_1 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n}(x_i - \bar{x})^2}\)</span></li>
<li><span class="math inline">\(\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\)</span></li>
</ul>
<p><strong>回归系数的解释</strong>：</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0\)</span>：当自变量<span class="math inline">\(x\)</span>为0时，因变量<span class="math inline">\(y\)</span>的预测值（在实际情况中，自变量为0可能没有现实意义）</li>
<li><span class="math inline">\(\hat{\beta}_1\)</span>：自变量<span class="math inline">\(x\)</span>每增加一个单位，因变量<span class="math inline">\(y\)</span>的预测值平均增加<span class="math inline">\(\hat{\beta}_1\)</span>个单位（边际效应）</li>
</ul>
<p><strong>回归模型的评估指标</strong>：</p>
<ol type="1">
<li><strong>拟合优度 <span class="math inline">\(R^2\)</span></strong>：
<ul>
<li>表示模型解释的因变量方差比例</li>
<li>取值范围[0,1]，越接近1表示模型拟合越好</li>
<li><span class="math inline">\(R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{\sum(y_i - \hat{y}_i)^2}{\sum(y_i - \bar{y})^2}\)</span></li>
</ul></li>
<li><strong>残差标准误差(RSE)</strong>：
<ul>
<li>衡量因变量实际值偏离预测值的平均程度</li>
<li><span class="math inline">\(RSE = \sqrt{\frac{SSE}{n-2}} = \sqrt{\frac{\sum(y_i - \hat{y}_i)^2}{n-2}}\)</span></li>
</ul></li>
</ol>
<p><strong>回归模型的假设条件</strong>：</p>
<ul>
<li><strong>线性性</strong>：因变量与自变量之间存在线性关系</li>
<li><strong>独立性</strong>：误差项之间相互独立</li>
<li><strong>同方差性</strong>：误差项的方差为常数（同质性）</li>
<li><strong>正态性</strong>：误差项服从均值为0的正态分布</li>
</ul>
</section>
<section id="r语言实现简单线性回归" class="level3">
<h3 class="anchored" data-anchor-id="r语言实现简单线性回归">R语言实现简单线性回归</h3>
<p><strong>基本函数</strong>：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 建立简单线性回归模型</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV, <span class="at">data =</span> advertising_data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 broom 包获取模型摘要信息</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取整洁的模型系数</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_model, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   11.4      0.770      14.8  8.34e-27   9.90      13.0  
2 TV             0.126    0.0254      4.96 2.93e- 6   0.0758     0.177</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取整洁的模型摘要统计量</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic    p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.201         0.193  3.25      24.6 0.00000293     1  -259.  523.  531.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 模型预测</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">TV =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 augment 获取带预测值和残差的数据框</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>augmented_data <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_model, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>augmented_prediction <span class="ot">&lt;-</span> <span class="fu">augment</span>(lm_model, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>augmented_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
     TV .fitted .lower .upper
  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1    10    12.7   11.6   13.8
2    20    14.0   13.2   14.7
3    30    15.2   14.6   15.9
4    40    16.5   15.6   17.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>augmented_prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
     TV .fitted .lower .upper
  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1    10    12.7   6.15   19.2
2    20    14.0   7.47   20.4
3    30    15.2   8.74   21.7
4    40    16.5   9.97   23.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 回归诊断图</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 ggfortify 包可以绘制更美观的回归诊断图，它是 ggplot2 的扩展包</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<p><strong>结果解读</strong>：</p>
<ul>
<li><strong>系数估计值</strong>：截距(<span class="math inline">\(\hat{\beta}_0\)</span>)和斜率(<span class="math inline">\(\hat{\beta}_1\)</span>)的估计值</li>
<li><strong>标准误差</strong>：系数估计值的标准误差，表示估计的精确度</li>
<li><strong>t值</strong>：系数估计值与标准误差的比值，用于检验系数是否显著不为0</li>
<li><strong>p值</strong>：系数是否显著不为0的显著性水平</li>
<li><strong>R²值</strong>：模型解释的方差比例，衡量拟合优度</li>
<li><strong>F统计量</strong>：整个模型的显著性检验</li>
</ul>
</section>
</section>
<section id="第十二次课多元线性回归模型" class="level2">
<h2 class="anchored" data-anchor-id="第十二次课多元线性回归模型">第十二次课：多元线性回归模型</h2>
<section id="多元线性回归模型" class="level3">
<h3 class="anchored" data-anchor-id="多元线性回归模型">多元线性回归模型</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
多元线性回归的意义
</div>
</div>
<div class="callout-body-container callout-body">
<p>在商业环境中，一个因变量往往受多个因素影响。例如，销售额不仅受电视广告的影响，还可能受广播、报纸、社交媒体等多种营销渠道的影响。多元线性回归能够同时考虑多个自变量的影响，更全面地分析因素间的关系。</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
模型形式
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots + \beta_p x_p + \epsilon\)</span></p>
<ul>
<li><span class="math inline">\(y\)</span>：因变量</li>
<li><span class="math inline">\(x_1, x_2, \dots, x_p\)</span>：<span class="math inline">\(p\)</span>个自变量</li>
<li><span class="math inline">\(\beta_0\)</span>：截距</li>
<li><span class="math inline">\(\beta_1, \beta_2, \dots, \beta_p\)</span>：偏回归系数，控制其他自变量不变时，每个自变量对因变量的边际影响</li>
<li><span class="math inline">\(\epsilon\)</span>：随机误差项</li>
</ul>
</div>
</div>
</section>
</section>
<section id="偏回归系数的解释" class="level2 callout-hint">
<h2 class="anchored" data-anchor-id="偏回归系数的解释">偏回归系数的解释</h2>
<ul>
<li><span class="math inline">\(\beta_1\)</span>表示在其他自变量<span class="math inline">\(x_2, \dots, x_p\)</span>保持不变的情况下，自变量<span class="math inline">\(x_1\)</span>每增加一个单位，因变量<span class="math inline">\(y\)</span>的平均变化量</li>
</ul>
<p>这个解释非常重要，因为它体现了“控制变量”的思想，即我们能够分离出单个自变量的“净效应”。这在商业分析中尤为有用，例如，我们可以分析在广播广告投入不变的情况下，增加电视广告对销售的边际贡献。</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
参数估计
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>同样使用最小二乘法(OLS)</li>
<li>通过矩阵运算求解：<span class="math inline">\(\hat{\beta} = (X^TX)^{-1}X^Ty\)</span></li>
<li>其中<span class="math inline">\(X\)</span>是自变量矩阵，<span class="math inline">\(y\)</span>是因变量向量</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
模型假设
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>线性性：因变量与每个自变量之间存在线性关系</li>
<li>独立性：观测值之间相互独立</li>
<li>同方差性：误差项方差恒定</li>
<li>正态性：误差项服从正态分布</li>
<li>无多重共线性：自变量之间不存在高度相关性</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
多重共线性问题
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>定义</strong>：自变量之间存在强相关关系</li>
<li><strong>后果</strong>：回归系数估计不稳定，标准误增大</li>
<li><strong>诊断</strong>：方差膨胀因子(VIF)</li>
<li><strong>处理</strong>：变量选择、正则化、主成分分析等</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检测多重共线性</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(car)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Newspaper, <span class="at">data =</span> advertising_data)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(multi_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       TV     Radio Newspaper 
 1.013862  1.020265  1.017238 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF &gt; 5通常表示存在多重共线性</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF &gt; 10通常表示存在严重多重共线性</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>模型拟合与检验</strong>：</p>
<ul>
<li><strong>R²</strong>：衡量模型对数据的拟合程度，取值范围[0,1]</li>
<li><strong>调整R²</strong>：考虑自变量个数对R²的影响，防止过拟合</li>
<li><strong>F检验</strong>：检验模型整体的显著性</li>
<li><strong>t检验</strong>：检验每个偏回归系数的显著性</li>
</ul>
<p><strong>解释多元回归模型时需注意</strong>：</p>
<ul>
<li>解释系数时必须强调”控制其他变量不变”</li>
<li>R²会随自变量增加而增加，应关注调整R²</li>
<li>显著性水平应解释为”在控制了其他变量后”</li>
</ul>
<p><strong>嵌套模型比较</strong>：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建不同的嵌套模型</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV, <span class="at">data =</span> advertising_data)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV <span class="sc">+</span> Radio, <span class="at">data =</span> advertising_data)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Newspaper, <span class="at">data =</span> advertising_data)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用anova函数比较嵌套模型</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Sales ~ TV
Model 2: Sales ~ TV + Radio
Model 3: Sales ~ TV + Radio + Newspaper
  Res.Df     RSS Df Sum of Sq       F    Pr(&gt;F)    
1     98 1033.44                                   
2     97  376.26  1    657.18 189.775 &lt; 2.2e-16 ***
3     96  332.44  1     43.82  12.655  0.000584 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用AIC比较模型</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model1, model2, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
model1  3 523.3359
model2  4 424.3000
model3  5 413.9172</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model1, model2, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       df      BIC
model1  3 531.1514
model2  4 434.7206
model3  5 426.9430</code></pre>
</div>
</div>
<p><strong>偏回归图</strong>：观察单个自变量的边际贡献</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avPlots</span>(multi_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<p><strong>变量重要性评估</strong>：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(relaimpo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
下载的二进制程序包在
    /var/folders/84/nbtvpczd2svfk_vdtv79gtnh0000gn/T//RtmpwuLRa5/downloaded_packages里</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc.relimp</span>(multi_model, <span class="at">type =</span> <span class="st">"lmg"</span>, <span class="at">rela =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response variable: Sales 
Total response variance: 13.06276 
Analysis based on 100 observations 

3 Regressors: 
TV Radio Newspaper 
Proportion of variance explained by model: 74.29%
Metrics are normalized to sum to 100% (rela=TRUE). 

Relative importance metrics: 

                 lmg
TV        0.31648933
Radio     0.65886905
Newspaper 0.02464162

Average coefficients for different model sizes: 

                  1X        2Xs       3Xs
TV        0.12630664 0.13610705 0.1479870
Radio     0.31705083 0.33114590 0.3478659
Newspaper 0.04476348 0.07630718 0.1139924</code></pre>
</div>
</div>
<p><strong>多元回归的可视化</strong>：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化不同渠道的边际效应</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建效应图</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>effect_tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> TV, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"电视广告的边际效应"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>effect_radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> Radio, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"广播广告的边际效应"</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>effect_newspaper <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(advertising_data, <span class="fu">aes</span>(<span class="at">x =</span> Newspaper, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"报纸广告的边际效应"</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>effect_tv <span class="sc">+</span> effect_radio <span class="sc">+</span> effect_newspaper</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3D可视化（针对两个自变量）</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(plotly)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV <span class="sc">+</span> Radio, <span class="at">data =</span> advertising_data)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建网格点</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>grid.lines <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>x.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(advertising_data<span class="sc">$</span>TV), <span class="fu">max</span>(advertising_data<span class="sc">$</span>TV), <span class="at">length.out =</span> grid.lines)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>y.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(advertising_data<span class="sc">$</span>Radio), <span class="fu">max</span>(advertising_data<span class="sc">$</span>Radio), <span class="at">length.out =</span> grid.lines)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">TV =</span> x.pred, <span class="at">Radio =</span> y.pred)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 预测z值</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>z.pred <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">predict</span>(fit, <span class="at">newdata =</span> xy), </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> grid.lines, <span class="at">ncol =</span> grid.lines)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建3D图</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">data =</span> advertising_data, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="sc">~</span>TV, <span class="at">y =</span> <span class="sc">~</span>Radio, <span class="at">z =</span> <span class="sc">~</span>Sales,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">"scatter3d"</span>, <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">opacity =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>(<span class="at">x =</span> x.pred, <span class="at">y =</span> y.pred, <span class="at">z =</span> z.pred,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">colorscale =</span> <span class="st">"Viridis"</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"销售额与电视、广播广告投入的关系"</span>,</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"电视广告"</span>),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"广播广告"</span>),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"销售额"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-85cf7f798e923a02ed60" style="width:100%;height:487px;"></div>
<script type="application/json" data-for="htmlwidget-85cf7f798e923a02ed60">{"x":{"visdat":{"acdc6a6de431":["function () ","plotlyVisDat"],"acdc54a0838d":["function () ","data"]},"cur_data":"acdc54a0838d","attrs":{"acdc54a0838d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":5,"color":"blue","opacity":0.5},"inherit":true},"acdc54a0838d.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":[[6.7275183003228189,6.9226542697450348,7.1177902391672507,7.3129262085894666,7.5080621780116825,7.7031981474338993,7.8983341168561152,8.0934700862783302,8.2886060557005479,8.4837420251227638,8.6788779945449797,8.8740139639671956,9.0691499333894114,9.2642859028116273,9.4594218722338432,9.6545578416560591,9.849693811078275,10.044829780500493,10.239965749922709,10.435101719344924,10.63023768876714,10.825373658189356,11.020509627611572,11.215645597033788,11.410781566456004,11.60591753587822,11.801053505300438,11.996189474722653,12.191325444144868,12.386461413567085,12.581597382989301,12.776733352411517,12.971869321833733,13.167005291255949,13.362141260678166,13.557277230100382,13.752413199522598,13.947549168944814,14.14268513836703,14.337821107789246,14.532957077211462,14.728093046633678,14.923229016055894,15.118364985478109,15.313500954900327,15.508636924322543,15.703772893744759,15.898908863166975,16.094044832589191,16.289180802011408],[6.8588372252238523,7.0539731946460682,7.2491091640682841,7.4442451334905,7.6393811029127159,7.8345170723349327,8.0296530417571486,8.2247890111793645,8.4199249806015803,8.6150609500237962,8.8101969194460121,9.005332888868228,9.2004688582904457,9.3956048277126616,9.5907407971348775,9.7858767665570934,9.9810127359793093,10.176148705401525,10.371284674823741,10.566420644245957,10.761556613668173,10.956692583090389,11.151828552512606,11.346964521934822,11.542100491357038,11.737236460779254,11.93237243020147,12.127508399623688,12.322644369045902,12.517780338468118,12.712916307890334,12.908052277312551,13.103188246734767,13.298324216156983,13.493460185579199,13.688596155001415,13.883732124423631,14.078868093845848,14.274004063268062,14.469140032690278,14.664276002112494,14.859411971534712,15.054547940956928,15.249683910379144,15.44481987980136,15.639955849223576,15.835091818645791,16.030227788068007,16.225363757490225,16.420499726912439],[6.9901561501248857,7.1852921195471016,7.3804280889693175,7.5755640583915334,7.7707000278137492,7.965835997235966,8.160971966658181,8.3561079360803969,8.5512439055026146,8.7463798749248305,8.9415158443470464,9.1366518137692623,9.3317877831914782,9.5269237526136941,9.72205972203591,9.9171956914581259,10.112331660880342,10.307467630302559,10.502603599724775,10.697739569146991,10.892875538569207,11.088011507991423,11.283147477413639,11.478283446835855,11.673419416258071,11.868555385680287,12.063691355102504,12.25882732452472,12.453963293946934,12.649099263369152,12.844235232791368,13.039371202213584,13.2345071716358,13.429643141058015,13.624779110480233,13.819915079902449,14.015051049324665,14.210187018746881,14.405322988169097,14.600458957591313,14.795594927013529,14.990730896435744,15.18586686585796,15.381002835280176,15.576138804702394,15.77127477412461,15.966410743546826,16.161546712969042,16.356682682391259,16.551818651813473],[7.1214750750259181,7.316611044448134,7.5117470138703499,7.7068829832925658,7.9020189527147817,8.0971549221369976,8.2922908915592135,8.4874268609814294,8.6825628304036471,8.877698799825863,9.0728347692480789,9.2679707386702948,9.4631067080925106,9.6582426775147265,9.8533786469369424,10.048514616359158,10.243650585781374,10.438786555203592,10.633922524625808,10.829058494048024,11.02419446347024,11.219330432892455,11.414466402314671,11.609602371736887,11.804738341159103,11.999874310581319,12.195010280003537,12.390146249425753,12.585282218847967,12.780418188270184,12.9755541576924,13.170690127114616,13.365826096536832,13.560962065959048,13.756098035381266,13.951234004803482,14.146369974225697,14.341505943647913,14.536641913070129,14.731777882492345,14.926913851914561,15.122049821336777,15.317185790758993,15.512321760181209,15.707457729603426,15.902593699025642,16.097729668447858,16.292865637870076,16.48800160729229,16.683137576714508],[7.2527939999269515,7.4479299693491674,7.6430659387713833,7.8382019081935992,8.033337877615816,8.2284738470380319,8.4236098164602478,8.6187457858824637,8.8138817553046795,9.0090177247268954,9.2041536941491113,9.3992896635713272,9.5944256329935449,9.7895616024157608,9.9846975718379767,10.179833541260193,10.374969510682408,10.570105480104624,10.76524144952684,10.960377418949056,11.155513388371272,11.350649357793488,11.545785327215706,11.740921296637922,11.936057266060137,12.131193235482353,12.326329204904569,12.521465174326787,12.716601143749001,12.911737113171217,13.106873082593433,13.30200905201565,13.497145021437866,13.692280990860082,13.887416960282298,14.082552929704514,14.27768889912673,14.472824868548948,14.667960837971162,14.863096807393378,15.058232776815593,15.253368746237811,15.448504715660027,15.643640685082243,15.838776654504459,16.033912623926675,16.229048593348892,16.424184562771106,16.619320532193324,16.814456501615538],[7.3841129248279849,7.5792488942502008,7.7743848636724167,7.9695208330946326,8.1646568025168484,8.3597927719390643,8.5549287413612802,8.7500647107834961,8.9452006802057138,9.1403366496279297,9.3354726190501456,9.5306085884723615,9.7257445578945774,9.9208805273167933,10.116016496739009,10.311152466161225,10.506288435583441,10.701424405005659,10.896560374427875,11.09169634385009,11.286832313272306,11.481968282694522,11.677104252116738,11.872240221538954,12.06737619096117,12.262512160383386,12.457648129805603,12.652784099227819,12.847920068650033,13.043056038072251,13.238192007494467,13.433327976916683,13.628463946338899,13.823599915761115,14.018735885183332,14.213871854605548,14.409007824027764,14.60414379344998,14.799279762872196,14.994415732294412,15.189551701716628,15.384687671138844,15.57982364056106,15.774959609983275,15.970095579405493,16.165231548827709,16.360367518249923,16.555503487672141,16.750639457094358,16.945775426516573],[7.5154318497290182,7.7105678191512341,7.90570378857345,8.1008397579956668,8.2959757274178827,8.4911116968400986,8.6862476662623145,8.8813836356845304,9.0765196051067463,9.2716555745289622,9.4667915439511781,9.6619275133733939,9.8570634827956116,10.052199452217828,10.247335421640043,10.442471391062259,10.637607360484475,10.832743329906691,11.027879299328907,11.223015268751123,11.418151238173339,11.613287207595555,11.808423177017772,12.003559146439988,12.198695115862204,12.39383108528442,12.588967054706636,12.784103024128854,12.979238993551068,13.174374962973284,13.369510932395499,13.564646901817717,13.759782871239933,13.954918840662149,14.150054810084365,14.345190779506581,14.540326748928797,14.735462718351014,14.930598687773228,15.125734657195444,15.32087062661766,15.516006596039878,15.711142565462094,15.90627853488431,16.101414504306526,16.296550473728743,16.491686443150957,16.686822412573175,16.881958381995389,17.077094351417607],[7.6467507746300516,7.8418867440522675,8.0370227134744834,8.2321586828966993,8.4272946523189152,8.6224306217411311,8.817566591163347,9.0127025605855628,9.2078385300077805,9.4029744994299964,9.5981104688522123,9.7932464382744282,9.9883824076966441,10.18351837711886,10.378654346541076,10.573790315963292,10.768926285385508,10.964062254807725,11.159198224229941,11.354334193652157,11.549470163074373,11.744606132496589,11.939742101918805,12.134878071341021,12.330014040763237,12.525150010185452,12.72028597960767,12.915421949029886,13.1105579184521,13.305693887874318,13.500829857296534,13.69596582671875,13.891101796140966,14.086237765563181,14.281373734985399,14.476509704407615,14.671645673829831,14.866781643252047,15.061917612674263,15.257053582096479,15.452189551518694,15.64732552094091,15.842461490363126,16.037597459785342,16.23273342920756,16.427869398629774,16.623005368051992,16.818141337474209,17.013277306896423,17.208413276318641],[7.778069699531085,7.9732056689533009,8.1683416383755159,8.3634776077977335,8.5586135772199494,8.7537495466421653,8.9488855160643812,9.1440214854865971,9.339157454908813,9.5342934243310289,9.7294293937532448,9.9245653631754607,10.119701332597678,10.314837302019894,10.50997327144211,10.705109240864326,10.900245210286542,11.095381179708758,11.290517149130974,11.48565311855319,11.680789087975405,11.875925057397621,12.071061026819839,12.266196996242055,12.461332965664271,12.656468935086487,12.851604904508703,13.04674087393092,13.241876843353134,13.43701281277535,13.632148782197566,13.827284751619784,14.022420721042,14.217556690464216,14.412692659886432,14.607828629308647,14.802964598730863,14.998100568153081,15.193236537575295,15.388372506997511,15.583508476419727,15.778644445841945,15.97378041526416,16.168916384686376,16.364052354108594,16.559188323530808,16.754324292953026,16.94946026237524,17.144596231797458,17.339732201219672],[7.9093886244321183,8.1045245938543342,8.2996605632765501,8.494796532698766,8.6899325021209819,8.8850684715431978,9.0802044409654137,9.2753404103876296,9.4704763798098472,9.6656123492320631,9.860748318654279,10.055884288076495,10.251020257498711,10.446156226920927,10.641292196343143,10.836428165765359,11.031564135187574,11.226700104609792,11.421836074032008,11.616972043454224,11.81210801287644,12.007243982298656,12.202379951720872,12.397515921143087,12.592651890565303,12.787787859987519,12.982923829409737,13.178059798831953,13.373195768254167,13.568331737676385,13.7634677070986,13.958603676520816,14.153739645943032,14.348875615365248,14.544011584787466,14.739147554209682,14.934283523631898,15.129419493054113,15.324555462476329,15.519691431898545,15.714827401320761,15.909963370742977,16.105099340165193,16.300235309587411,16.495371279009625,16.690507248431842,16.885643217854057,17.080779187276274,17.275915156698492,17.471051126120706],[8.0407075493331508,8.2358435187553667,8.4309794881775826,8.6261154575998003,8.8212514270220161,9.016387396444232,9.2115233658664479,9.4066593352886638,9.6017953047108797,9.7969312741330956,9.9920672435553115,10.187203212977527,10.382339182399745,10.577475151821961,10.772611121244177,10.967747090666393,11.162883060088609,11.358019029510825,11.55315499893304,11.748290968355256,11.943426937777472,12.138562907199688,12.333698876621906,12.528834846044122,12.723970815466338,12.919106784888553,13.114242754310769,13.309378723732987,13.504514693155201,13.699650662577417,13.894786631999633,14.089922601421851,14.285058570844066,14.480194540266282,14.675330509688498,14.870466479110714,15.06560244853293,15.260738417955148,15.455874387377362,15.651010356799578,15.846146326221794,16.04128229564401,16.236418265066227,16.431554234488441,16.626690203910659,16.821826173332877,17.016962142755091,17.212098112177308,17.407234081599523,17.60237005102174],[8.1720264742341833,8.3671624436563992,8.5622984130786151,8.7574343825008327,8.9525703519230486,9.1477063213452645,9.3428422907674804,9.5379782601896963,9.7331142296119122,9.9282501990341281,10.123386168456344,10.31852213787856,10.513658107300778,10.708794076722993,10.903930046145209,11.099066015567425,11.294201984989641,11.489337954411857,11.684473923834073,11.879609893256289,12.074745862678505,12.269881832100721,12.465017801522938,12.660153770945154,12.85528974036737,13.050425709789586,13.245561679211802,13.44069764863402,13.635833618056234,13.83096958747845,14.026105556900665,14.221241526322883,14.416377495745099,14.611513465167315,14.806649434589531,15.001785404011747,15.196921373433963,15.39205734285618,15.587193312278394,15.78232928170061,15.977465251122826,16.172601220545044,16.367737189967258,16.562873159389476,16.758009128811693,16.953145098233907,17.148281067656125,17.343417037078339,17.538553006500557,17.733688975922771],[8.3033453991352175,8.4984813685574334,8.6936173379796493,8.8887533074018652,9.0838892768240811,9.279025246246297,9.4741612156685129,9.6692971850907288,9.8644331545129464,10.059569123935162,10.254705093357378,10.449841062779594,10.64497703220181,10.840113001624026,11.035248971046242,11.230384940468458,11.425520909890674,11.620656879312891,11.815792848735107,12.010928818157323,12.206064787579539,12.401200757001755,12.596336726423971,12.791472695846187,12.986608665268403,13.181744634690618,13.376880604112836,13.572016573535052,13.767152542957266,13.962288512379484,14.1574244818017,14.352560451223916,14.547696420646131,14.742832390068347,14.937968359490565,15.133104328912781,15.328240298334997,15.523376267757213,15.718512237179429,15.913648206601644,16.10878417602386,16.303920145446078,16.499056114868292,16.69419208429051,16.889328053712724,17.084464023134942,17.279599992557156,17.474735961979373,17.669871931401591,17.865007900823805],[8.43466432403625,8.6298002934584659,8.8249362628806818,9.0200722323028995,9.2152082017251153,9.4103441711473312,9.6054801405695471,9.800616109991763,9.9957520794139789,10.190888048836195,10.386024018258411,10.581159987680627,10.776295957102844,10.97143192652506,11.166567895947276,11.361703865369492,11.556839834791708,11.751975804213924,11.94711177363614,12.142247743058356,12.337383712480571,12.532519681902787,12.727655651325005,12.922791620747221,13.117927590169437,13.313063559591653,13.508199529013869,13.703335498436086,13.8984714678583,14.093607437280516,14.288743406702732,14.48387937612495,14.679015345547166,14.874151314969382,15.069287284391597,15.264423253813813,15.459559223236029,15.654695192658247,15.849831162080461,16.044967131502677,16.240103100924895,16.435239070347109,16.630375039769326,16.825511009191541,17.020646978613758,17.215782948035976,17.41091891745819,17.606054886880408,17.801190856302622,17.996326825724839],[8.5659832489372842,8.7611192183595001,8.956255187781716,9.1513911572039319,9.3465271266261478,9.5416630960483637,9.7367990654705796,9.9319350348927955,10.127071004315013,10.322206973737229,10.517342943159445,10.712478912581661,10.907614882003877,11.102750851426093,11.297886820848309,11.493022790270524,11.68815875969274,11.883294729114958,12.078430698537174,12.27356666795939,12.468702637381606,12.663838606803822,12.858974576226037,13.054110545648253,13.249246515070469,13.444382484492685,13.639518453914903,13.834654423337119,14.029790392759333,14.22492636218155,14.420062331603766,14.615198301025982,14.810334270448198,15.005470239870414,15.200606209292632,15.395742178714848,15.590878148137064,15.786014117559279,15.981150086981495,16.176286056403711,16.371422025825925,16.566557995248143,16.761693964670361,16.956829934092575,17.151965903514792,17.347101872937007,17.542237842359224,17.737373811781442,17.932509781203656,18.127645750625874],[8.6973021738383167,8.8924381432605326,9.0875741126827485,9.2827100821049644,9.4778460515271803,9.6729820209493962,9.8681179903716121,10.063253959793828,10.258389929216046,10.453525898638262,10.648661868060477,10.843797837482693,11.038933806904909,11.234069776327125,11.429205745749341,11.624341715171557,11.819477684593773,12.01461365401599,12.209749623438206,12.404885592860422,12.600021562282638,12.795157531704854,12.99029350112707,13.185429470549286,13.380565439971502,13.575701409393718,13.770837378815935,13.965973348238151,14.161109317660365,14.356245287082583,14.551381256504799,14.746517225927015,14.941653195349231,15.136789164771447,15.331925134193664,15.52706110361588,15.722197073038096,15.917333042460312,16.112469011882528,16.307604981304742,16.50274095072696,16.697876920149177,16.893012889571391,17.088148858993609,17.283284828415823,17.478420797838041,17.673556767260255,17.868692736682473,18.06382870610469,18.258964675526904],[8.828621098739351,9.0237570681615669,9.2188930375837828,9.4140290070059987,9.6091649764282145,9.8043009458504304,9.9994369152726463,10.194572884694862,10.38970885411708,10.584844823539296,10.779980792961512,10.975116762383728,11.170252731805943,11.365388701228159,11.560524670650375,11.755660640072591,11.950796609494807,12.145932578917025,12.341068548339241,12.536204517761457,12.731340487183672,12.926476456605888,13.121612426028104,13.31674839545032,13.511884364872536,13.707020334294752,13.90215630371697,14.097292273139185,14.2924282425614,14.487564211983617,14.682700181405833,14.877836150828049,15.072972120250265,15.268108089672481,15.463244059094698,15.658380028516914,15.85351599793913,16.048651967361348,16.243787936783562,16.438923906205776,16.634059875627994,16.829195845050211,17.024331814472426,17.219467783894643,17.414603753316857,17.609739722739075,17.804875692161289,18.000011661583507,18.195147631005725,18.390283600427939],[8.9599400236403834,9.1550759930625993,9.3502119624848152,9.5453479319070311,9.740483901329247,9.9356198707514629,10.130755840173679,10.325891809595895,10.521027779018112,10.716163748440328,10.911299717862544,11.10643568728476,11.301571656706976,11.496707626129192,11.691843595551408,11.886979564973624,12.08211553439584,12.277251503818057,12.472387473240273,12.667523442662489,12.862659412084705,13.057795381506921,13.252931350929137,13.448067320351353,13.643203289773568,13.838339259195784,14.033475228618002,14.228611198040218,14.423747167462432,14.61888313688465,14.814019106306866,15.009155075729081,15.204291045151297,15.399427014573513,15.594562983995731,15.789698953417947,15.984834922840163,16.179970892262379,16.375106861684593,16.57024283110681,16.765378800529025,16.960514769951242,17.15565073937346,17.350786708795674,17.545922678217892,17.741058647640106,17.936194617062323,18.131330586484541,18.326466555906755,18.521602525328973],[9.0912589485414177,9.2863949179636336,9.4815308873858495,9.6766668568080654,9.8718028262302813,10.066938795652497,10.262074765074713,10.457210734496929,10.652346703919147,10.847482673341363,11.042618642763578,11.237754612185794,11.43289058160801,11.628026551030226,11.823162520452442,12.018298489874658,12.213434459296874,12.408570428719091,12.603706398141307,12.798842367563523,12.993978336985739,13.189114306407955,13.384250275830171,13.579386245252387,13.774522214674603,13.969658184096819,14.164794153519036,14.359930122941252,14.555066092363466,14.750202061785684,14.9453380312079,15.140474000630116,15.335609970052332,15.530745939474548,15.725881908896765,15.921017878318981,16.116153847741195,16.311289817163413,16.506425786585627,16.701561756007845,16.896697725430059,17.091833694852276,17.286969664274494,17.482105633696708,17.677241603118926,17.87237757254114,18.067513541963358,18.262649511385575,18.457785480807789,18.652921450230007],[9.2225778734424502,9.4177138428646661,9.612849812286882,9.8079857817090979,10.003121751131314,10.19825772055353,10.393393689975746,10.588529659397961,10.783665628820179,10.978801598242395,11.173937567664611,11.369073537086827,11.564209506509043,11.759345475931259,11.954481445353474,12.14961741477569,12.344753384197906,12.539889353620124,12.73502532304234,12.930161292464556,13.125297261886772,13.320433231308987,13.515569200731203,13.710705170153419,13.905841139575635,14.100977108997851,14.296113078420069,14.491249047842285,14.686385017264499,14.881520986686716,15.076656956108932,15.271792925531148,15.466928894953364,15.66206486437558,15.857200833797798,16.052336803220012,16.247472772642229,16.442608742064447,16.637744711486661,16.832880680908875,17.028016650331093,17.223152619753311,17.418288589175525,17.613424558597742,17.808560528019957,18.003696497442174,18.198832466864388,18.393968436286606,18.589104405708824,18.784240375131038],[9.3538967983434844,9.5490327677657003,9.7441687371879162,9.9393047066101321,10.134440676032348,10.329576645454564,10.52471261487678,10.719848584298996,10.914984553721213,11.110120523143429,11.305256492565645,11.500392461987861,11.695528431410077,11.890664400832293,12.085800370254509,12.280936339676725,12.47607230909894,12.671208278521158,12.866344247943374,13.06148021736559,13.256616186787806,13.451752156210022,13.646888125632238,13.842024095054454,14.037160064476669,14.232296033898885,14.427432003321103,14.622567972743319,14.817703942165533,15.012839911587751,15.207975881009967,15.403111850432182,15.598247819854398,15.793383789276614,15.988519758698832,16.183655728121046,16.378791697543264,16.573927666965481,16.769063636387695,16.96419960580991,17.159335575232127,17.354471544654345,17.549607514076559,17.744743483498777,17.939879452920991,18.135015422343209,18.330151391765423,18.52528736118764,18.720423330609858,18.915559300032072],[9.4852157232445169,9.6803516926667328,9.8754876620889487,10.070623631511165,10.26575960093338,10.460895570355596,10.656031539777812,10.851167509200028,11.046303478622246,11.241439448044462,11.436575417466678,11.631711386888894,11.826847356311109,12.021983325733325,12.217119295155541,12.412255264577757,12.607391233999973,12.802527203422191,12.997663172844407,13.192799142266622,13.387935111688838,13.583071081111054,13.77820705053327,13.973343019955486,14.168478989377702,14.363614958799918,14.558750928222135,14.753886897644351,14.949022867066565,15.144158836488783,15.339294805910999,15.534430775333215,15.729566744755431,15.924702714177647,16.119838683599863,16.31497465302208,16.510110622444294,16.705246591866512,16.900382561288726,17.095518530710944,17.290654500133158,17.485790469555376,17.680926438977593,17.876062408399807,18.071198377822025,18.266334347244239,18.461470316666457,18.656606286088675,18.851742255510889,19.046878224933106],[9.6165346481455494,9.8116706175677653,10.006806586989981,10.201942556412197,10.397078525834413,10.592214495256629,10.787350464678845,10.982486434101061,11.177622403523278,11.372758372945494,11.56789434236771,11.763030311789926,11.958166281212142,12.153302250634358,12.348438220056574,12.54357418947879,12.738710158901005,12.933846128323223,13.128982097745439,13.324118067167655,13.519254036589871,13.714390006012087,13.909525975434303,14.104661944856518,14.299797914278734,14.49493388370095,14.690069853123168,14.885205822545384,15.080341791967598,15.275477761389816,15.470613730812032,15.665749700234247,15.860885669656463,16.056021639078679,16.251157608500897,16.446293577923111,16.641429547345329,16.836565516767546,17.03170148618976,17.226837455611975,17.421973425034192,17.61710939445641,17.812245363878624,18.007381333300842,18.202517302723056,18.397653272145273,18.592789241567488,18.787925210989705,18.983061180411923,19.178197149834137],[9.7478535730465836,9.9429895424687995,10.138125511891015,10.333261481313231,10.528397450735447,10.723533420157663,10.918669389579879,11.113805359002095,11.308941328424313,11.504077297846528,11.699213267268744,11.89434923669096,12.089485206113176,12.284621175535392,12.479757144957608,12.674893114379824,12.87002908380204,13.065165053224257,13.260301022646473,13.455436992068689,13.650572961490905,13.845708930913121,14.040844900335337,14.235980869757553,14.431116839179769,14.626252808601985,14.821388778024202,15.016524747446418,15.211660716868632,15.40679668629085,15.601932655713066,15.797068625135282,15.992204594557498,16.187340563979713,16.382476533401931,16.577612502824145,16.772748472246363,16.967884441668581,17.163020411090795,17.358156380513009,17.553292349935226,17.748428319357444,17.943564288779658,18.138700258201876,18.33383622762409,18.528972197046308,18.724108166468522,18.919244135890739,19.114380105312957,19.309516074735171],[9.8791724979476179,10.074308467369834,10.26944443679205,10.464580406214266,10.659716375636481,10.854852345058697,11.049988314480913,11.245124283903129,11.440260253325347,11.635396222747563,11.830532192169779,12.025668161591994,12.22080413101421,12.415940100436426,12.611076069858642,12.806212039280858,13.001348008703074,13.196483978125292,13.391619947547508,13.586755916969723,13.781891886391939,13.977027855814155,14.172163825236371,14.367299794658587,14.562435764080803,14.757571733503019,14.952707702925236,15.147843672347452,15.342979641769666,15.538115611191884,15.7332515806141,15.928387550036316,16.123523519458534,16.318659488880748,16.513795458302965,16.708931427725179,16.904067397147397,17.099203366569615,17.294339335991829,17.489475305414043,17.684611274836261,17.879747244258478,18.074883213680693,18.27001918310291,18.465155152525124,18.660291121947342,18.855427091369556,19.050563060791774,19.245699030213991,19.440834999636206],[10.01049142284865,10.205627392270866,10.400763361693082,10.595899331115298,10.791035300537514,10.98617126995973,11.181307239381946,11.376443208804162,11.571579178226379,11.766715147648595,11.961851117070811,12.156987086493027,12.352123055915243,12.547259025337459,12.742394994759675,12.937530964181891,13.132666933604106,13.327802903026324,13.52293887244854,13.718074841870756,13.913210811292972,14.108346780715188,14.303482750137404,14.498618719559619,14.693754688981835,14.888890658404051,15.084026627826269,15.279162597248485,15.474298566670699,15.669434536092917,15.864570505515132,16.05970647493735,16.254842444359564,16.449978413781782,16.645114383203996,16.840250352626214,17.035386322048428,17.230522291470646,17.42565826089286,17.620794230315077,17.815930199737291,18.011066169159509,18.206202138581727,18.401338108003941,18.596474077426159,18.791610046848373,18.98674601627059,19.181881985692808,19.377017955115022,19.57215392453724],[10.141810347749685,10.3369463171719,10.532082286594116,10.727218256016332,10.922354225438548,11.117490194860764,11.31262616428298,11.507762133705196,11.702898103127414,11.898034072549629,12.093170041971845,12.288306011394061,12.483441980816277,12.678577950238493,12.873713919660709,13.068849889082925,13.263985858505141,13.459121827927358,13.654257797349574,13.84939376677179,14.044529736194006,14.239665705616222,14.434801675038438,14.629937644460654,14.82507361388287,15.020209583305085,15.215345552727303,15.410481522149519,15.605617491571733,15.800753460993951,15.995889430416167,16.191025399838384,16.386161369260599,16.581297338682816,16.77643330810503,16.971569277527248,17.166705246949462,17.36184121637168,17.556977185793894,17.752113155216112,17.947249124638326,18.142385094060543,18.337521063482761,18.532657032904975,18.727793002327193,18.922928971749407,19.118064941171625,19.313200910593842,19.508336880016056,19.703472849438274],[10.273129272650717,10.468265242072933,10.663401211495149,10.858537180917365,11.053673150339581,11.248809119761797,11.443945089184012,11.639081058606228,11.834217028028446,12.029352997450662,12.224488966872878,12.419624936295094,12.61476090571731,12.809896875139525,13.005032844561741,13.200168813983957,13.395304783406173,13.590440752828391,13.785576722250607,13.980712691672823,14.175848661095038,14.370984630517254,14.56612059993947,14.761256569361686,14.956392538783902,15.151528508206118,15.346664477628336,15.541800447050552,15.736936416472766,15.932072385894983,16.127208355317197,16.322344324739415,16.517480294161633,16.712616263583847,16.907752233006065,17.102888202428279,17.298024171850496,17.493160141272714,17.688296110694928,17.883432080117142,18.07856804953936,18.273704018961578,18.468839988383792,18.663975957806009,18.859111927228223,19.054247896650441,19.249383866072655,19.444519835494873,19.639655804917091,19.834791774339305],[10.40444819755175,10.599584166973965,10.794720136396181,10.989856105818397,11.184992075240613,11.380128044662829,11.575264014085045,11.770399983507261,11.965535952929478,12.160671922351694,12.35580789177391,12.550943861196126,12.746079830618342,12.941215800040558,13.136351769462774,13.33148773888499,13.526623708307206,13.721759677729423,13.916895647151639,14.112031616573855,14.307167585996071,14.502303555418287,14.697439524840503,14.892575494262719,15.087711463684935,15.28284743310715,15.477983402529368,15.673119371951584,15.868255341373798,16.063391310796014,16.258527280218232,16.453663249640449,16.648799219062663,16.843935188484881,17.039071157907095,17.234207127329313,17.429343096751527,17.624479066173745,17.819615035595959,18.014751005018176,18.209886974440391,18.405022943862608,18.600158913284826,18.79529488270704,18.990430852129258,19.185566821551472,19.38070279097369,19.575838760395907,19.770974729818121,19.966110699240339],[10.535767122452784,10.730903091875,10.926039061297216,11.121175030719431,11.316311000141647,11.511446969563863,11.706582938986079,11.901718908408295,12.096854877830513,12.291990847252729,12.487126816674945,12.68226278609716,12.877398755519376,13.072534724941592,13.267670694363808,13.462806663786024,13.65794263320824,13.853078602630458,14.048214572052673,14.243350541474889,14.438486510897105,14.633622480319321,14.828758449741537,15.023894419163753,15.219030388585969,15.414166358008185,15.609302327430402,15.804438296852618,15.999574266274832,16.194710235697048,16.389846205119266,16.584982174541484,16.780118143963698,16.975254113385915,17.17039008280813,17.365526052230347,17.560662021652561,17.755797991074779,17.950933960496993,18.146069929919211,18.341205899341425,18.536341868763643,18.73147783818586,18.926613807608074,19.121749777030292,19.316885746452506,19.512021715874724,19.707157685296941,19.902293654719156,20.097429624141373],[10.667086047353816,10.862222016776032,11.057357986198248,11.252493955620464,11.44762992504268,11.642765894464896,11.837901863887112,12.033037833309328,12.228173802731545,12.423309772153761,12.618445741575977,12.813581710998193,13.008717680420409,13.203853649842625,13.398989619264841,13.594125588687056,13.789261558109272,13.98439752753149,14.179533496953706,14.374669466375922,14.569805435798138,14.764941405220354,14.960077374642569,15.155213344064785,15.350349313487001,15.545485282909217,15.740621252331435,15.935757221753651,16.130893191175865,16.326029160598083,16.521165130020297,16.716301099442514,16.911437068864732,17.106573038286946,17.301709007709164,17.496844977131378,17.691980946553596,17.887116915975813,18.082252885398027,18.277388854820241,18.472524824242459,18.667660793664677,18.862796763086891,19.057932732509109,19.253068701931323,19.44820467135354,19.643340640775754,19.838476610197972,20.03361257962019,20.228748549042404],[10.798404972254851,10.993540941677066,11.188676911099282,11.383812880521498,11.578948849943714,11.77408481936593,11.969220788788146,12.164356758210362,12.359492727632579,12.554628697054795,12.749764666477011,12.944900635899227,13.140036605321443,13.335172574743659,13.530308544165875,13.725444513588091,13.920580483010307,14.115716452432524,14.31085242185474,14.505988391276956,14.701124360699172,14.896260330121388,15.091396299543604,15.28653226896582,15.481668238388036,15.676804207810251,15.871940177232469,16.067076146654685,16.262212116076899,16.457348085499117,16.652484054921331,16.847620024343549,17.042755993765766,17.23789196318798,17.433027932610198,17.628163902032412,17.82329987145463,18.018435840876847,18.213571810299062,18.408707779721276,18.603843749143493,18.798979718565711,18.994115687987925,19.189251657410143,19.384387626832357,19.579523596254575,19.774659565676789,19.969795535099006,20.164931504521224,20.360067473943438],[10.929723897155883,11.124859866578099,11.319995836000315,11.515131805422531,11.710267774844747,11.905403744266962,12.100539713689178,12.295675683111394,12.490811652533612,12.685947621955828,12.881083591378044,13.07621956080026,13.271355530222475,13.466491499644691,13.661627469066907,13.856763438489123,14.051899407911339,14.247035377333557,14.442171346755773,14.637307316177989,14.832443285600204,15.02757925502242,15.222715224444636,15.417851193866852,15.612987163289068,15.808123132711284,16.003259102133502,16.198395071555719,16.393531040977933,16.588667010400147,16.783802979822365,16.978938949244583,17.174074918666797,17.369210888089015,17.564346857511229,17.759482826933446,17.95461879635566,18.149754765777878,18.344890735200092,18.54002670462231,18.735162674044524,18.930298643466742,19.125434612888959,19.320570582311174,19.515706551733391,19.710842521155605,19.905978490577823,20.101114460000041,20.296250429422255,20.491386398844472],[11.061042822056915,11.256178791479131,11.451314760901347,11.646450730323563,11.841586699745779,12.036722669167995,12.231858638590211,12.426994608012427,12.622130577434644,12.81726654685686,13.012402516279076,13.207538485701292,13.402674455123508,13.597810424545724,13.79294639396794,13.988082363390156,14.183218332812372,14.378354302234589,14.573490271656805,14.768626241079021,14.963762210501237,15.158898179923453,15.354034149345669,15.549170118767885,15.7443060881901,15.939442057612316,16.134578027034532,16.32971399645675,16.524849965878964,16.719985935301182,16.915121904723396,17.110257874145613,17.305393843567831,17.500529812990045,17.695665782412263,17.890801751834477,18.085937721256695,18.281073690678912,18.476209660101127,18.671345629523341,18.866481598945558,19.061617568367776,19.25675353778999,19.451889507212208,19.647025476634422,19.84216144605664,20.037297415478854,20.232433384901071,20.427569354323289,20.622705323745503],[11.19236174695795,11.387497716380166,11.582633685802382,11.777769655224597,11.972905624646813,12.168041594069029,12.363177563491245,12.558313532913461,12.753449502335679,12.948585471757895,13.14372144118011,13.338857410602326,13.533993380024542,13.729129349446758,13.924265318868974,14.11940128829119,14.314537257713406,14.509673227135623,14.704809196557839,14.899945165980055,15.095081135402271,15.290217104824487,15.485353074246703,15.680489043668919,15.875625013091135,16.070760982513352,16.265896951935567,16.461032921357784,16.656168890779998,16.851304860202216,17.04644082962443,17.241576799046648,17.436712768468865,17.63184873789108,17.826984707313297,18.022120676735511,18.217256646157729,18.412392615579947,18.607528585002161,18.802664554424375,18.997800523846593,19.19293649326881,19.388072462691024,19.583208432113242,19.778344401535456,19.973480370957674,20.168616340379888,20.363752309802106,20.558888279224323,20.754024248646537],[11.323680671858982,11.518816641281198,11.713952610703414,11.90908858012563,12.104224549547846,12.299360518970062,12.494496488392278,12.689632457814493,12.884768427236711,13.079904396658927,13.275040366081143,13.470176335503359,13.665312304925575,13.860448274347791,14.055584243770006,14.250720213192222,14.445856182614438,14.640992152036656,14.836128121458872,15.031264090881088,15.226400060303304,15.42153602972552,15.616671999147735,15.811807968569951,16.006943937992169,16.202079907414383,16.397215876836601,16.592351846258818,16.787487815681033,16.982623785103247,17.177759754525464,17.372895723947682,17.568031693369896,17.763167662792114,17.958303632214328,18.153439601636546,18.34857557105876,18.543711540480977,18.738847509903191,18.933983479325409,19.129119448747623,19.324255418169841,19.519391387592059,19.714527357014273,19.90966332643649,20.104799295858705,20.299935265280922,20.49507123470314,20.690207204125354,20.885343173547572],[11.454999596760016,11.650135566182232,11.845271535604448,12.040407505026664,12.23554347444888,12.430679443871096,12.625815413293312,12.820951382715528,13.016087352137745,13.211223321559961,13.406359290982177,13.601495260404393,13.796631229826609,13.991767199248825,14.186903168671041,14.382039138093257,14.577175107515473,14.77231107693769,14.967447046359906,15.162583015782122,15.357718985204338,15.552854954626554,15.74799092404877,15.943126893470986,16.138262862893203,16.333398832315417,16.528534801737635,16.723670771159853,16.918806740582067,17.113942710004281,17.309078679426499,17.504214648848716,17.69935061827093,17.894486587693148,18.089622557115362,18.28475852653758,18.479894495959794,18.675030465382012,18.870166434804226,19.065302404226443,19.260438373648658,19.455574343070875,19.650710312493093,19.845846281915307,20.040982251337525,20.236118220759739,20.431254190181956,20.626390159604174,20.821526129026388,21.016662098448606],[11.586318521661049,11.781454491083265,11.976590460505481,12.171726429927697,12.366862399349912,12.561998368772128,12.757134338194344,12.95227030761656,13.147406277038778,13.342542246460994,13.53767821588321,13.732814185305426,13.927950154727641,14.123086124149857,14.318222093572073,14.513358062994289,14.708494032416505,14.903630001838723,15.098765971260939,15.293901940683154,15.48903791010537,15.684173879527586,15.879309848949802,16.07444581837202,16.269581787794234,16.464717757216452,16.659853726638666,16.854989696060883,17.050125665483097,17.245261634905315,17.440397604327529,17.635533573749747,17.830669543171965,18.025805512594179,18.220941482016396,18.416077451438611,18.611213420860828,18.806349390283046,19.00148535970526,19.196621329127474,19.391757298549692,19.586893267971909,19.782029237394124,19.977165206816341,20.172301176238555,20.367437145660773,20.562573115082987,20.757709084505205,20.952845053927422,21.147981023349637],[11.717637446562083,11.912773415984299,12.107909385406515,12.303045354828731,12.498181324250947,12.693317293673163,12.888453263095379,13.083589232517594,13.278725201939812,13.473861171362028,13.668997140784244,13.86413311020646,14.059269079628676,14.254405049050892,14.449541018473107,14.644676987895323,14.839812957317539,15.034948926739757,15.230084896161973,15.425220865584189,15.620356835006405,15.81549280442862,16.010628773850836,16.205764743273054,16.400900712695268,16.596036682117486,16.7911726515397,16.986308620961918,17.181444590384132,17.376580559806349,17.571716529228564,17.766852498650781,17.961988468072999,18.157124437495213,18.352260406917431,18.547396376339645,18.742532345761862,18.93766831518408,19.132804284606294,19.327940254028508,19.523076223450726,19.718212192872944,19.913348162295158,20.108484131717375,20.30362010113959,20.498756070561807,20.693892039984021,20.889028009406239,21.084163978828457,21.279299948250671],[11.848956371463116,12.044092340885332,12.239228310307547,12.434364279729763,12.629500249151979,12.824636218574195,13.019772187996411,13.214908157418627,13.410044126840845,13.60518009626306,13.800316065685276,13.995452035107492,14.190588004529708,14.385723973951924,14.58085994337414,14.775995912796356,14.971131882218572,15.166267851640789,15.361403821063005,15.556539790485221,15.751675759907437,15.946811729329653,16.141947698751871,16.337083668174085,16.532219637596302,16.727355607018517,16.922491576440734,17.117627545862952,17.312763515285166,17.50789948470738,17.703035454129598,17.898171423551815,18.09330739297403,18.288443362396247,18.483579331818461,18.678715301240679,18.873851270662893,19.068987240085111,19.264123209507325,19.459259178929543,19.654395148351757,19.849531117773974,20.044667087196192,20.239803056618406,20.434939026040624,20.630074995462838,20.825210964885056,21.020346934307273,21.215482903729487,21.410618873151705],[11.98027529636415,12.175411265786366,12.370547235208582,12.565683204630798,12.760819174053013,12.955955143475229,13.151091112897445,13.346227082319661,13.541363051741879,13.736499021164095,13.931634990586311,14.126770960008527,14.321906929430742,14.517042898852958,14.712178868275174,14.90731483769739,15.102450807119606,15.297586776541824,15.49272274596404,15.687858715386255,15.882994684808471,16.078130654230687,16.273266623652905,16.468402593075119,16.663538562497337,16.858674531919551,17.053810501341768,17.248946470763986,17.4440824401862,17.639218409608414,17.834354379030632,18.02949034845285,18.224626317875064,18.419762287297281,18.614898256719496,18.810034226141713,19.005170195563927,19.200306164986145,19.395442134408359,19.590578103830577,19.785714073252791,19.980850042675009,20.175986012097226,20.37112198151944,20.566257950941658,20.761393920363872,20.95652988978609,21.151665859208308,21.346801828630522,21.541937798052739],[12.111594221265182,12.306730190687398,12.501866160109614,12.69700212953183,12.892138098954046,13.087274068376262,13.282410037798478,13.477546007220694,13.672681976642911,13.867817946065127,14.062953915487343,14.258089884909559,14.453225854331775,14.648361823753991,14.843497793176207,15.038633762598423,15.233769732020638,15.428905701442856,15.624041670865072,15.819177640287288,16.014313609709504,16.209449579131718,16.404585548553936,16.599721517976153,16.794857487398367,16.989993456820585,17.185129426242799,17.380265395665017,17.575401365087231,17.770537334509449,17.965673303931663,18.16080927335388,18.355945242776098,18.551081212198312,18.74621718162053,18.941353151042744,19.136489120464962,19.331625089887179,19.526761059309393,19.721897028731608,19.917032998153825,20.112168967576043,20.307304936998257,20.502440906420475,20.697576875842689,20.892712845264906,21.087848814687121,21.282984784109338,21.478120753531556,21.67325672295377],[12.242913146166217,12.438049115588433,12.633185085010648,12.828321054432864,13.02345702385508,13.218592993277296,13.413728962699512,13.608864932121728,13.804000901543946,13.999136870966161,14.194272840388377,14.389408809810593,14.584544779232809,14.779680748655025,14.974816718077241,15.169952687499457,15.365088656921673,15.56022462634389,15.755360595766106,15.950496565188322,16.145632534610538,16.340768504032752,16.53590447345497,16.731040442877188,16.926176412299402,17.121312381721619,17.316448351143833,17.511584320566051,17.706720289988265,17.901856259410483,18.096992228832697,18.292128198254915,18.487264167677132,18.682400137099346,18.877536106521564,19.072672075943778,19.267808045365996,19.462944014788214,19.658079984210428,19.853215953632642,20.048351923054859,20.243487892477077,20.438623861899291,20.633759831321509,20.828895800743723,21.024031770165941,21.219167739588155,21.414303709010373,21.60943967843259,21.804575647854804],[12.374232071067249,12.569368040489465,12.764504009911681,12.959639979333897,13.154775948756113,13.349911918178329,13.545047887600544,13.74018385702276,13.935319826444978,14.130455795867194,14.32559176528941,14.520727734711626,14.715863704133842,14.910999673556057,15.106135642978273,15.301271612400489,15.496407581822705,15.691543551244923,15.886679520667139,16.081815490089355,16.276951459511569,16.472087428933786,16.667223398356004,16.862359367778218,17.057495337200436,17.25263130662265,17.447767276044868,17.642903245467085,17.838039214889299,18.033175184311514,18.228311153733731,18.423447123155949,18.618583092578163,18.813719062000381,19.008855031422595,19.203991000844812,19.399126970267027,19.594262939689244,19.789398909111458,19.984534878533676,20.17967084795589,20.374806817378108,20.569942786800326,20.76507875622254,20.960214725644757,21.155350695066971,21.350486664489189,21.545622633911407,21.740758603333621,21.935894572755839],[12.505550995968282,12.700686965390497,12.895822934812713,13.090958904234929,13.286094873657145,13.481230843079361,13.676366812501577,13.871502781923793,14.06663875134601,14.261774720768226,14.456910690190442,14.652046659612658,14.847182629034874,15.04231859845709,15.237454567879306,15.432590537301522,15.627726506723738,15.822862476145955,16.017998445568171,16.213134414990385,16.408270384412603,16.603406353834817,16.798542323257035,16.993678292679252,17.188814262101467,17.383950231523684,17.579086200945898,17.774222170368116,17.96935813979033,18.164494109212548,18.359630078634762,18.55476604805698,18.749902017479197,18.945037986901411,19.140173956323629,19.335309925745843,19.530445895168061,19.725581864590279,19.920717834012493,20.115853803434707,20.310989772856924,20.506125742279142,20.701261711701356,20.896397681123574,21.091533650545788,21.286669619968006,21.48180558939022,21.676941558812437,21.872077528234655,22.067213497656869],[12.636869920869316,12.832005890291532,13.027141859713748,13.222277829135964,13.417413798558179,13.612549767980395,13.807685737402611,14.002821706824827,14.197957676247045,14.393093645669261,14.588229615091477,14.783365584513692,14.978501553935908,15.173637523358124,15.36877349278034,15.563909462202556,15.759045431624772,15.95418140104699,16.149317370469205,16.34445333989142,16.539589309313637,16.734725278735851,16.929861248158069,17.124997217580287,17.320133187002501,17.515269156424718,17.710405125846933,17.90554109526915,18.100677064691364,18.295813034113582,18.490949003535796,18.686084972958014,18.881220942380232,19.076356911802446,19.271492881224663,19.466628850646877,19.661764820069095,19.856900789491313,20.052036758913527,20.247172728335741,20.442308697757959,20.637444667180176,20.83258063660239,21.027716606024608,21.222852575446822,21.41798854486904,21.613124514291254,21.808260483713472,22.003396453135689,22.198532422557903],[12.768188845770348,12.963324815192564,13.15846078461478,13.353596754036996,13.548732723459212,13.743868692881428,13.939004662303644,14.13414063172586,14.329276601148077,14.524412570570293,14.719548539992509,14.914684509414725,15.109820478836941,15.304956448259157,15.500092417681373,15.695228387103588,15.890364356525804,16.085500325948022,16.280636295370236,16.475772264792454,16.670908234214668,16.866044203636886,17.061180173059103,17.256316142481317,17.451452111903535,17.646588081325749,17.841724050747967,18.036860020170185,18.231995989592399,18.427131959014613,18.62226792843683,18.817403897859048,19.012539867281262,19.20767583670348,19.402811806125694,19.597947775547912,19.793083744970126,19.988219714392343,20.183355683814558,20.378491653236775,20.573627622658989,20.768763592081207,20.963899561503425,21.159035530925639,21.354171500347856,21.549307469770071,21.744443439192288,21.939579408614506,22.13471537803672,22.329851347458938],[12.899507770671383,13.094643740093598,13.289779709515814,13.48491567893803,13.680051648360246,13.875187617782462,14.070323587204678,14.265459556626894,14.460595526049111,14.655731495471327,14.850867464893543,15.046003434315759,15.241139403737975,15.436275373160191,15.631411342582407,15.826547312004623,16.021683281426839,16.216819250849056,16.41195522027127,16.607091189693488,16.802227159115702,16.99736312853792,17.192499097960138,17.387635067382352,17.582771036804569,17.777907006226783,17.973042975649001,18.168178945071219,18.363314914493433,18.558450883915647,18.753586853337865,18.948722822760082,19.143858792182296,19.338994761604514,19.534130731026728,19.729266700448946,19.92440266987116,20.119538639293378,20.314674608715592,20.50981057813781,20.704946547560024,20.900082516982241,21.095218486404459,21.290354455826673,21.485490425248891,21.680626394671105,21.875762364093323,22.07089833351554,22.266034302937754,22.461170272359972],[13.030826695572415,13.225962664994631,13.421098634416847,13.616234603839063,13.811370573261279,14.006506542683494,14.20164251210571,14.396778481527926,14.591914450950144,14.78705042037236,14.982186389794576,15.177322359216792,15.372458328639008,15.567594298061223,15.762730267483439,15.957866236905655,16.153002206327873,16.348138175750087,16.543274145172305,16.738410114594519,16.933546084016736,17.128682053438951,17.323818022861168,17.518953992283386,17.7140899617056,17.909225931127818,18.104361900550032,18.299497869972249,18.494633839394464,18.689769808816681,18.884905778238895,19.080041747661113,19.275177717083331,19.470313686505545,19.665449655927763,19.860585625349977,20.055721594772194,20.250857564194412,20.445993533616626,20.64112950303884,20.836265472461058,21.031401441883276,21.22653741130549,21.421673380727707,21.616809350149921,21.811945319572139,22.007081288994353,22.202217258416571,22.397353227838789,22.592489197261003],[13.162145620473447,13.357281589895663,13.552417559317879,13.747553528740095,13.942689498162311,14.137825467584527,14.332961437006743,14.528097406428959,14.723233375851176,14.918369345273392,15.113505314695608,15.308641284117824,15.50377725354004,15.698913222962256,15.894049192384472,16.089185161806689,16.284321131228904,16.479457100651121,16.674593070073335,16.869729039495553,17.064865008917767,17.260000978339985,17.455136947762202,17.650272917184417,17.845408886606634,18.040544856028848,18.235680825451066,18.430816794873284,18.625952764295498,18.821088733717712,19.01622470313993,19.211360672562147,19.406496641984361,19.601632611406579,19.796768580828793,19.991904550251011,20.187040519673225,20.382176489095443,20.577312458517657,20.772448427939874,20.967584397362089,21.162720366784306,21.357856336206524,21.552992305628738,21.748128275050956,21.94326424447317,22.138400213895387,22.333536183317605,22.528672152739819,22.723808122162037]],"type":"surface","x":[5.0281147996429354,5.9406459251209638,6.8531770505989922,7.7657081760770206,8.678239301555049,9.5907704270330782,10.503301552511106,11.415832677989133,12.328363803467163,13.240894928945192,14.153426054423219,15.065957179901247,15.978488305379276,16.891019430857305,17.803550556335331,18.71608168181336,19.62861280729139,20.541143932769419,21.453675058247448,22.366206183725474,23.278737309203503,24.191268434681533,25.103799560159558,26.016330685637588,26.928861811115617,27.841392936593646,28.753924062071675,29.666455187549701,30.57898631302773,31.49151743850576,32.404048563983785,33.316579689461818,34.229110814939844,35.14164194041787,36.054173065895903,36.966704191373928,37.879235316851961,38.791766442329987,39.704297567808013,40.616828693286045,41.529359818764071,42.441890944242097,43.35442206972013,44.266953195198155,45.179484320676181,46.092015446154214,47.00454657163224,47.917077697110273,48.829608822588298,49.742139948066324],"y":[1.3035462431143969,1.8806899044168541,2.4578335657193113,3.034977227021769,3.6121208883242262,4.1892645496266834,4.766408210929141,5.3435518722315978,5.9206955335340554,6.4978391948365131,7.0749828561389698,7.6521265174414275,8.2292701787438851,8.8064138400463428,9.3835575013487986,9.9607011626512563,10.537844823953714,11.114988485256172,11.692132146558629,12.269275807861085,12.846419469163543,13.423563130466,14.000706791768458,14.577850453070916,15.154994114373373,15.732137775675829,16.309281436978289,16.886425098280746,17.4635687595832,18.040712420885658,18.617856082188116,19.194999743490573,19.772143404793031,20.349287066095489,20.926430727397946,21.503574388700404,22.080718050002861,22.657861711305319,23.235005372607773,23.812149033910231,24.389292695212688,24.966436356515146,25.543580017817604,26.120723679120061,26.697867340422519,27.275011001724977,27.852154663027434,28.429298324329892,29.00644198563235,29.583585646934807],"colorscale":"Viridis","opacity":0.80000000000000004,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"销售额与电视、广播广告投入的关系","scene":{"xaxis":{"title":"电视广告"},"yaxis":{"title":"广播广告"},"zaxis":{"title":"销售额"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[17.940988405607641,40.473731094971299,23.403961481526494,44.735783180221915,47.321027793223038,7.0500424725469202,28.764746962115169,45.158856997732073,29.81457565096207,25.547663088655099,48.057500540744513,25.400037028593943,35.490678595378995,30.768503088038415,9.6316107199527323,45.492123668082058,16.073948045959696,6.8926790088880807,19.756432367721573,47.952664211625233,45.029269222868606,36.176153277046978,33.822806619573385,49.742139948066324,34.506760960211977,36.883871067548171,29.482971112011001,31.736390920123085,18.012188178254291,11.620114129036665,48.336090464144945,45.603457030374557,36.081737529020756,40.796033795922995,6.1076158029027283,26.500818699132651,39.130679188529029,14.73835711251013,19.318145343568176,15.423160340869799,11.426001007203013,23.654585111653432,23.617594683310017,21.598045291611925,11.860013648401946,11.246272855205461,15.48653447534889,25.968310261378065,16.968768816441298,43.602247190428898,7.0624025003053248,24.899003339232877,40.951618053950369,10.485466698883101,30.242659269133583,14.293912532739341,10.738924260949716,38.898853893624619,45.277041161898524,21.850824914872646,34.930183758260682,9.2678297415841371,22.278633700916544,17.347264005802572,41.658801749581471,25.183235362637788,41.452895887196064,41.557527928380296,40.745404449990019,24.792425942141563,38.951382138766348,33.314950920175761,36.958208060823381,5.0281147996429354,26.389245834434405,14.905349832260981,22.091744197532535,32.574695147341117,20.830905915936455,10.001094095641747,15.962876272387803,35.062501435168087,23.794105085544288,40.468812531325966,9.628908991580829,24.570173367392272,49.32306409929879,45.187300147954375,44.891107735456899,12.87736926227808,10.881306120427325,34.389586626784876,20.458241251762956,34.554115758510306,19.416795911965892,13.446100367000327,40.203243559226394,9.2117744020652026,26.005056870635599,28.017745695542544],"y":[18.399679818656296,10.651882669189945,15.169777976348996,28.679740997496992,15.004169517895207,26.820156441535801,27.518707420444116,18.653314487310126,12.91000351938419,5.2657460372429341,28.123694294830784,9.7356380992569029,2.7608965749386698,28.484081261092797,21.897291929461062,5.1265345723368227,16.929255025926977,28.668645918136463,17.979017240460962,12.730798170669004,19.788910900475457,10.274797895690426,9.9238803151529282,7.3732613066677004,11.715177109232172,29.542356900637969,5.4718667238485068,3.6402759966440499,5.1153003256767988,21.010205943835899,18.958438018336892,26.850429397309199,20.516973685706034,22.375254399841651,16.112936047604308,20.135315040592104,24.832358344225213,23.802164999302477,29.414835603674874,13.743514551082626,10.039363860152662,12.874773625750095,1.3035462431143969,6.3316361962351948,25.439150247722864,7.7036916795186698,7.9338987139053643,3.2240437946747988,8.1259866629261523,22.231920960359275,25.576141787925735,15.428290745476261,12.249361865455285,8.1470208303071558,4.2217973778024316,12.309838622109964,17.586124105611816,7.2898901214357466,13.898272058693692,7.3217293929774314,15.56668733456172,11.263232583645731,19.849569605663419,11.866704741725698,11.307916042860597,16.476950418204069,22.469696451444179,7.411985196871683,12.969637439819053,8.704913918627426,19.269218550529331,6.3310262328013778,26.045679231639951,22.65047211991623,20.380254842108116,18.922518324572593,11.794903746573254,16.365234889788553,26.365787943126634,17.870752893621102,25.353265178855509,10.060996782500297,21.540419344324619,8.6855163765139878,18.235952627146617,14.957404214190319,8.6859492124058306,17.373122608521953,27.48245846782811,27.154357295483351,8.95083202351816,10.322999935830012,29.583585646934807,18.979805995477363,28.182108585489914,14.529448367422447,12.798145204549655,20.117679401999339,5.418051888467744,17.613144688308239],"z":[15.263981955076856,17.729426819873723,14.928664224984876,19.327596014225321,17.16564649549516,15.303255715462301,19.424487066465552,17.201423945031657,15.640424647043506,10.007055051698371,23.715241511765615,10.138272827760815,9.0640698515023246,25.991332487579246,12.275541265360781,15.359940279942109,14.466785339650587,14.484822371214408,16.032796763836245,18.58778283401767,17.825359298502118,15.561658014728623,14.439239436541108,20.302953346252252,12.313582969800986,17.993735465454513,12.095273241998152,12.59400946326593,11.505988471992492,13.960715313924311,17.047995161922472,23.278860743435267,16.952212693591495,16.217912641207885,10.79917776094983,15.415669434966247,20.934639434335722,16.184732776723596,18.536054498652241,12.044781466161957,11.248252241398941,13.085883315512872,9.4662671195439927,9.614581656304523,12.412883548466352,14.441583894449742,11.702447082144984,9.2986297766326338,10.695576229215474,17.292358275512346,18.644257102097349,16.431739546709203,15.473352457696151,10.638357236659299,11.036399005603583,11.455128019887271,10.645591816201534,12.6413589475907,20.206005281830798,12.102299918720423,16.999440148652187,12.020474214129802,18.109991378839311,12.030307320176481,13.689070563016015,18.22500233726074,17.749179296518509,12.705742071258241,12.570204262783442,9.7665327135417819,17.217612754667091,13.14512371009778,20.721245504463841,14.292958013587317,15.885816882154502,14.502426458606454,12.386791097590164,14.29428316956264,17.952442294904476,11.127841073862493,20.428185264513029,13.371247224103971,16.25348840863197,12.648892041576834,10.882261878414763,11.330500381367548,14.768250201831588,18.27976948043797,20.736270607192466,14.855403682994243,8.335685148648917,12.452383702690387,20.079741415973722,15.363333058656769,17.517543577829095,16.813684983851843,16.632261071934092,9.9045878631959141,9.3947188852902102,17.055188440980064],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5,"opacity":0.5,"line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"Sales","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"z":[[6.7275183003228189,6.9226542697450348,7.1177902391672507,7.3129262085894666,7.5080621780116825,7.7031981474338993,7.8983341168561152,8.0934700862783302,8.2886060557005479,8.4837420251227638,8.6788779945449797,8.8740139639671956,9.0691499333894114,9.2642859028116273,9.4594218722338432,9.6545578416560591,9.849693811078275,10.044829780500493,10.239965749922709,10.435101719344924,10.63023768876714,10.825373658189356,11.020509627611572,11.215645597033788,11.410781566456004,11.60591753587822,11.801053505300438,11.996189474722653,12.191325444144868,12.386461413567085,12.581597382989301,12.776733352411517,12.971869321833733,13.167005291255949,13.362141260678166,13.557277230100382,13.752413199522598,13.947549168944814,14.14268513836703,14.337821107789246,14.532957077211462,14.728093046633678,14.923229016055894,15.118364985478109,15.313500954900327,15.508636924322543,15.703772893744759,15.898908863166975,16.094044832589191,16.289180802011408],[6.8588372252238523,7.0539731946460682,7.2491091640682841,7.4442451334905,7.6393811029127159,7.8345170723349327,8.0296530417571486,8.2247890111793645,8.4199249806015803,8.6150609500237962,8.8101969194460121,9.005332888868228,9.2004688582904457,9.3956048277126616,9.5907407971348775,9.7858767665570934,9.9810127359793093,10.176148705401525,10.371284674823741,10.566420644245957,10.761556613668173,10.956692583090389,11.151828552512606,11.346964521934822,11.542100491357038,11.737236460779254,11.93237243020147,12.127508399623688,12.322644369045902,12.517780338468118,12.712916307890334,12.908052277312551,13.103188246734767,13.298324216156983,13.493460185579199,13.688596155001415,13.883732124423631,14.078868093845848,14.274004063268062,14.469140032690278,14.664276002112494,14.859411971534712,15.054547940956928,15.249683910379144,15.44481987980136,15.639955849223576,15.835091818645791,16.030227788068007,16.225363757490225,16.420499726912439],[6.9901561501248857,7.1852921195471016,7.3804280889693175,7.5755640583915334,7.7707000278137492,7.965835997235966,8.160971966658181,8.3561079360803969,8.5512439055026146,8.7463798749248305,8.9415158443470464,9.1366518137692623,9.3317877831914782,9.5269237526136941,9.72205972203591,9.9171956914581259,10.112331660880342,10.307467630302559,10.502603599724775,10.697739569146991,10.892875538569207,11.088011507991423,11.283147477413639,11.478283446835855,11.673419416258071,11.868555385680287,12.063691355102504,12.25882732452472,12.453963293946934,12.649099263369152,12.844235232791368,13.039371202213584,13.2345071716358,13.429643141058015,13.624779110480233,13.819915079902449,14.015051049324665,14.210187018746881,14.405322988169097,14.600458957591313,14.795594927013529,14.990730896435744,15.18586686585796,15.381002835280176,15.576138804702394,15.77127477412461,15.966410743546826,16.161546712969042,16.356682682391259,16.551818651813473],[7.1214750750259181,7.316611044448134,7.5117470138703499,7.7068829832925658,7.9020189527147817,8.0971549221369976,8.2922908915592135,8.4874268609814294,8.6825628304036471,8.877698799825863,9.0728347692480789,9.2679707386702948,9.4631067080925106,9.6582426775147265,9.8533786469369424,10.048514616359158,10.243650585781374,10.438786555203592,10.633922524625808,10.829058494048024,11.02419446347024,11.219330432892455,11.414466402314671,11.609602371736887,11.804738341159103,11.999874310581319,12.195010280003537,12.390146249425753,12.585282218847967,12.780418188270184,12.9755541576924,13.170690127114616,13.365826096536832,13.560962065959048,13.756098035381266,13.951234004803482,14.146369974225697,14.341505943647913,14.536641913070129,14.731777882492345,14.926913851914561,15.122049821336777,15.317185790758993,15.512321760181209,15.707457729603426,15.902593699025642,16.097729668447858,16.292865637870076,16.48800160729229,16.683137576714508],[7.2527939999269515,7.4479299693491674,7.6430659387713833,7.8382019081935992,8.033337877615816,8.2284738470380319,8.4236098164602478,8.6187457858824637,8.8138817553046795,9.0090177247268954,9.2041536941491113,9.3992896635713272,9.5944256329935449,9.7895616024157608,9.9846975718379767,10.179833541260193,10.374969510682408,10.570105480104624,10.76524144952684,10.960377418949056,11.155513388371272,11.350649357793488,11.545785327215706,11.740921296637922,11.936057266060137,12.131193235482353,12.326329204904569,12.521465174326787,12.716601143749001,12.911737113171217,13.106873082593433,13.30200905201565,13.497145021437866,13.692280990860082,13.887416960282298,14.082552929704514,14.27768889912673,14.472824868548948,14.667960837971162,14.863096807393378,15.058232776815593,15.253368746237811,15.448504715660027,15.643640685082243,15.838776654504459,16.033912623926675,16.229048593348892,16.424184562771106,16.619320532193324,16.814456501615538],[7.3841129248279849,7.5792488942502008,7.7743848636724167,7.9695208330946326,8.1646568025168484,8.3597927719390643,8.5549287413612802,8.7500647107834961,8.9452006802057138,9.1403366496279297,9.3354726190501456,9.5306085884723615,9.7257445578945774,9.9208805273167933,10.116016496739009,10.311152466161225,10.506288435583441,10.701424405005659,10.896560374427875,11.09169634385009,11.286832313272306,11.481968282694522,11.677104252116738,11.872240221538954,12.06737619096117,12.262512160383386,12.457648129805603,12.652784099227819,12.847920068650033,13.043056038072251,13.238192007494467,13.433327976916683,13.628463946338899,13.823599915761115,14.018735885183332,14.213871854605548,14.409007824027764,14.60414379344998,14.799279762872196,14.994415732294412,15.189551701716628,15.384687671138844,15.57982364056106,15.774959609983275,15.970095579405493,16.165231548827709,16.360367518249923,16.555503487672141,16.750639457094358,16.945775426516573],[7.5154318497290182,7.7105678191512341,7.90570378857345,8.1008397579956668,8.2959757274178827,8.4911116968400986,8.6862476662623145,8.8813836356845304,9.0765196051067463,9.2716555745289622,9.4667915439511781,9.6619275133733939,9.8570634827956116,10.052199452217828,10.247335421640043,10.442471391062259,10.637607360484475,10.832743329906691,11.027879299328907,11.223015268751123,11.418151238173339,11.613287207595555,11.808423177017772,12.003559146439988,12.198695115862204,12.39383108528442,12.588967054706636,12.784103024128854,12.979238993551068,13.174374962973284,13.369510932395499,13.564646901817717,13.759782871239933,13.954918840662149,14.150054810084365,14.345190779506581,14.540326748928797,14.735462718351014,14.930598687773228,15.125734657195444,15.32087062661766,15.516006596039878,15.711142565462094,15.90627853488431,16.101414504306526,16.296550473728743,16.491686443150957,16.686822412573175,16.881958381995389,17.077094351417607],[7.6467507746300516,7.8418867440522675,8.0370227134744834,8.2321586828966993,8.4272946523189152,8.6224306217411311,8.817566591163347,9.0127025605855628,9.2078385300077805,9.4029744994299964,9.5981104688522123,9.7932464382744282,9.9883824076966441,10.18351837711886,10.378654346541076,10.573790315963292,10.768926285385508,10.964062254807725,11.159198224229941,11.354334193652157,11.549470163074373,11.744606132496589,11.939742101918805,12.134878071341021,12.330014040763237,12.525150010185452,12.72028597960767,12.915421949029886,13.1105579184521,13.305693887874318,13.500829857296534,13.69596582671875,13.891101796140966,14.086237765563181,14.281373734985399,14.476509704407615,14.671645673829831,14.866781643252047,15.061917612674263,15.257053582096479,15.452189551518694,15.64732552094091,15.842461490363126,16.037597459785342,16.23273342920756,16.427869398629774,16.623005368051992,16.818141337474209,17.013277306896423,17.208413276318641],[7.778069699531085,7.9732056689533009,8.1683416383755159,8.3634776077977335,8.5586135772199494,8.7537495466421653,8.9488855160643812,9.1440214854865971,9.339157454908813,9.5342934243310289,9.7294293937532448,9.9245653631754607,10.119701332597678,10.314837302019894,10.50997327144211,10.705109240864326,10.900245210286542,11.095381179708758,11.290517149130974,11.48565311855319,11.680789087975405,11.875925057397621,12.071061026819839,12.266196996242055,12.461332965664271,12.656468935086487,12.851604904508703,13.04674087393092,13.241876843353134,13.43701281277535,13.632148782197566,13.827284751619784,14.022420721042,14.217556690464216,14.412692659886432,14.607828629308647,14.802964598730863,14.998100568153081,15.193236537575295,15.388372506997511,15.583508476419727,15.778644445841945,15.97378041526416,16.168916384686376,16.364052354108594,16.559188323530808,16.754324292953026,16.94946026237524,17.144596231797458,17.339732201219672],[7.9093886244321183,8.1045245938543342,8.2996605632765501,8.494796532698766,8.6899325021209819,8.8850684715431978,9.0802044409654137,9.2753404103876296,9.4704763798098472,9.6656123492320631,9.860748318654279,10.055884288076495,10.251020257498711,10.446156226920927,10.641292196343143,10.836428165765359,11.031564135187574,11.226700104609792,11.421836074032008,11.616972043454224,11.81210801287644,12.007243982298656,12.202379951720872,12.397515921143087,12.592651890565303,12.787787859987519,12.982923829409737,13.178059798831953,13.373195768254167,13.568331737676385,13.7634677070986,13.958603676520816,14.153739645943032,14.348875615365248,14.544011584787466,14.739147554209682,14.934283523631898,15.129419493054113,15.324555462476329,15.519691431898545,15.714827401320761,15.909963370742977,16.105099340165193,16.300235309587411,16.495371279009625,16.690507248431842,16.885643217854057,17.080779187276274,17.275915156698492,17.471051126120706],[8.0407075493331508,8.2358435187553667,8.4309794881775826,8.6261154575998003,8.8212514270220161,9.016387396444232,9.2115233658664479,9.4066593352886638,9.6017953047108797,9.7969312741330956,9.9920672435553115,10.187203212977527,10.382339182399745,10.577475151821961,10.772611121244177,10.967747090666393,11.162883060088609,11.358019029510825,11.55315499893304,11.748290968355256,11.943426937777472,12.138562907199688,12.333698876621906,12.528834846044122,12.723970815466338,12.919106784888553,13.114242754310769,13.309378723732987,13.504514693155201,13.699650662577417,13.894786631999633,14.089922601421851,14.285058570844066,14.480194540266282,14.675330509688498,14.870466479110714,15.06560244853293,15.260738417955148,15.455874387377362,15.651010356799578,15.846146326221794,16.04128229564401,16.236418265066227,16.431554234488441,16.626690203910659,16.821826173332877,17.016962142755091,17.212098112177308,17.407234081599523,17.60237005102174],[8.1720264742341833,8.3671624436563992,8.5622984130786151,8.7574343825008327,8.9525703519230486,9.1477063213452645,9.3428422907674804,9.5379782601896963,9.7331142296119122,9.9282501990341281,10.123386168456344,10.31852213787856,10.513658107300778,10.708794076722993,10.903930046145209,11.099066015567425,11.294201984989641,11.489337954411857,11.684473923834073,11.879609893256289,12.074745862678505,12.269881832100721,12.465017801522938,12.660153770945154,12.85528974036737,13.050425709789586,13.245561679211802,13.44069764863402,13.635833618056234,13.83096958747845,14.026105556900665,14.221241526322883,14.416377495745099,14.611513465167315,14.806649434589531,15.001785404011747,15.196921373433963,15.39205734285618,15.587193312278394,15.78232928170061,15.977465251122826,16.172601220545044,16.367737189967258,16.562873159389476,16.758009128811693,16.953145098233907,17.148281067656125,17.343417037078339,17.538553006500557,17.733688975922771],[8.3033453991352175,8.4984813685574334,8.6936173379796493,8.8887533074018652,9.0838892768240811,9.279025246246297,9.4741612156685129,9.6692971850907288,9.8644331545129464,10.059569123935162,10.254705093357378,10.449841062779594,10.64497703220181,10.840113001624026,11.035248971046242,11.230384940468458,11.425520909890674,11.620656879312891,11.815792848735107,12.010928818157323,12.206064787579539,12.401200757001755,12.596336726423971,12.791472695846187,12.986608665268403,13.181744634690618,13.376880604112836,13.572016573535052,13.767152542957266,13.962288512379484,14.1574244818017,14.352560451223916,14.547696420646131,14.742832390068347,14.937968359490565,15.133104328912781,15.328240298334997,15.523376267757213,15.718512237179429,15.913648206601644,16.10878417602386,16.303920145446078,16.499056114868292,16.69419208429051,16.889328053712724,17.084464023134942,17.279599992557156,17.474735961979373,17.669871931401591,17.865007900823805],[8.43466432403625,8.6298002934584659,8.8249362628806818,9.0200722323028995,9.2152082017251153,9.4103441711473312,9.6054801405695471,9.800616109991763,9.9957520794139789,10.190888048836195,10.386024018258411,10.581159987680627,10.776295957102844,10.97143192652506,11.166567895947276,11.361703865369492,11.556839834791708,11.751975804213924,11.94711177363614,12.142247743058356,12.337383712480571,12.532519681902787,12.727655651325005,12.922791620747221,13.117927590169437,13.313063559591653,13.508199529013869,13.703335498436086,13.8984714678583,14.093607437280516,14.288743406702732,14.48387937612495,14.679015345547166,14.874151314969382,15.069287284391597,15.264423253813813,15.459559223236029,15.654695192658247,15.849831162080461,16.044967131502677,16.240103100924895,16.435239070347109,16.630375039769326,16.825511009191541,17.020646978613758,17.215782948035976,17.41091891745819,17.606054886880408,17.801190856302622,17.996326825724839],[8.5659832489372842,8.7611192183595001,8.956255187781716,9.1513911572039319,9.3465271266261478,9.5416630960483637,9.7367990654705796,9.9319350348927955,10.127071004315013,10.322206973737229,10.517342943159445,10.712478912581661,10.907614882003877,11.102750851426093,11.297886820848309,11.493022790270524,11.68815875969274,11.883294729114958,12.078430698537174,12.27356666795939,12.468702637381606,12.663838606803822,12.858974576226037,13.054110545648253,13.249246515070469,13.444382484492685,13.639518453914903,13.834654423337119,14.029790392759333,14.22492636218155,14.420062331603766,14.615198301025982,14.810334270448198,15.005470239870414,15.200606209292632,15.395742178714848,15.590878148137064,15.786014117559279,15.981150086981495,16.176286056403711,16.371422025825925,16.566557995248143,16.761693964670361,16.956829934092575,17.151965903514792,17.347101872937007,17.542237842359224,17.737373811781442,17.932509781203656,18.127645750625874],[8.6973021738383167,8.8924381432605326,9.0875741126827485,9.2827100821049644,9.4778460515271803,9.6729820209493962,9.8681179903716121,10.063253959793828,10.258389929216046,10.453525898638262,10.648661868060477,10.843797837482693,11.038933806904909,11.234069776327125,11.429205745749341,11.624341715171557,11.819477684593773,12.01461365401599,12.209749623438206,12.404885592860422,12.600021562282638,12.795157531704854,12.99029350112707,13.185429470549286,13.380565439971502,13.575701409393718,13.770837378815935,13.965973348238151,14.161109317660365,14.356245287082583,14.551381256504799,14.746517225927015,14.941653195349231,15.136789164771447,15.331925134193664,15.52706110361588,15.722197073038096,15.917333042460312,16.112469011882528,16.307604981304742,16.50274095072696,16.697876920149177,16.893012889571391,17.088148858993609,17.283284828415823,17.478420797838041,17.673556767260255,17.868692736682473,18.06382870610469,18.258964675526904],[8.828621098739351,9.0237570681615669,9.2188930375837828,9.4140290070059987,9.6091649764282145,9.8043009458504304,9.9994369152726463,10.194572884694862,10.38970885411708,10.584844823539296,10.779980792961512,10.975116762383728,11.170252731805943,11.365388701228159,11.560524670650375,11.755660640072591,11.950796609494807,12.145932578917025,12.341068548339241,12.536204517761457,12.731340487183672,12.926476456605888,13.121612426028104,13.31674839545032,13.511884364872536,13.707020334294752,13.90215630371697,14.097292273139185,14.2924282425614,14.487564211983617,14.682700181405833,14.877836150828049,15.072972120250265,15.268108089672481,15.463244059094698,15.658380028516914,15.85351599793913,16.048651967361348,16.243787936783562,16.438923906205776,16.634059875627994,16.829195845050211,17.024331814472426,17.219467783894643,17.414603753316857,17.609739722739075,17.804875692161289,18.000011661583507,18.195147631005725,18.390283600427939],[8.9599400236403834,9.1550759930625993,9.3502119624848152,9.5453479319070311,9.740483901329247,9.9356198707514629,10.130755840173679,10.325891809595895,10.521027779018112,10.716163748440328,10.911299717862544,11.10643568728476,11.301571656706976,11.496707626129192,11.691843595551408,11.886979564973624,12.08211553439584,12.277251503818057,12.472387473240273,12.667523442662489,12.862659412084705,13.057795381506921,13.252931350929137,13.448067320351353,13.643203289773568,13.838339259195784,14.033475228618002,14.228611198040218,14.423747167462432,14.61888313688465,14.814019106306866,15.009155075729081,15.204291045151297,15.399427014573513,15.594562983995731,15.789698953417947,15.984834922840163,16.179970892262379,16.375106861684593,16.57024283110681,16.765378800529025,16.960514769951242,17.15565073937346,17.350786708795674,17.545922678217892,17.741058647640106,17.936194617062323,18.131330586484541,18.326466555906755,18.521602525328973],[9.0912589485414177,9.2863949179636336,9.4815308873858495,9.6766668568080654,9.8718028262302813,10.066938795652497,10.262074765074713,10.457210734496929,10.652346703919147,10.847482673341363,11.042618642763578,11.237754612185794,11.43289058160801,11.628026551030226,11.823162520452442,12.018298489874658,12.213434459296874,12.408570428719091,12.603706398141307,12.798842367563523,12.993978336985739,13.189114306407955,13.384250275830171,13.579386245252387,13.774522214674603,13.969658184096819,14.164794153519036,14.359930122941252,14.555066092363466,14.750202061785684,14.9453380312079,15.140474000630116,15.335609970052332,15.530745939474548,15.725881908896765,15.921017878318981,16.116153847741195,16.311289817163413,16.506425786585627,16.701561756007845,16.896697725430059,17.091833694852276,17.286969664274494,17.482105633696708,17.677241603118926,17.87237757254114,18.067513541963358,18.262649511385575,18.457785480807789,18.652921450230007],[9.2225778734424502,9.4177138428646661,9.612849812286882,9.8079857817090979,10.003121751131314,10.19825772055353,10.393393689975746,10.588529659397961,10.783665628820179,10.978801598242395,11.173937567664611,11.369073537086827,11.564209506509043,11.759345475931259,11.954481445353474,12.14961741477569,12.344753384197906,12.539889353620124,12.73502532304234,12.930161292464556,13.125297261886772,13.320433231308987,13.515569200731203,13.710705170153419,13.905841139575635,14.100977108997851,14.296113078420069,14.491249047842285,14.686385017264499,14.881520986686716,15.076656956108932,15.271792925531148,15.466928894953364,15.66206486437558,15.857200833797798,16.052336803220012,16.247472772642229,16.442608742064447,16.637744711486661,16.832880680908875,17.028016650331093,17.223152619753311,17.418288589175525,17.613424558597742,17.808560528019957,18.003696497442174,18.198832466864388,18.393968436286606,18.589104405708824,18.784240375131038],[9.3538967983434844,9.5490327677657003,9.7441687371879162,9.9393047066101321,10.134440676032348,10.329576645454564,10.52471261487678,10.719848584298996,10.914984553721213,11.110120523143429,11.305256492565645,11.500392461987861,11.695528431410077,11.890664400832293,12.085800370254509,12.280936339676725,12.47607230909894,12.671208278521158,12.866344247943374,13.06148021736559,13.256616186787806,13.451752156210022,13.646888125632238,13.842024095054454,14.037160064476669,14.232296033898885,14.427432003321103,14.622567972743319,14.817703942165533,15.012839911587751,15.207975881009967,15.403111850432182,15.598247819854398,15.793383789276614,15.988519758698832,16.183655728121046,16.378791697543264,16.573927666965481,16.769063636387695,16.96419960580991,17.159335575232127,17.354471544654345,17.549607514076559,17.744743483498777,17.939879452920991,18.135015422343209,18.330151391765423,18.52528736118764,18.720423330609858,18.915559300032072],[9.4852157232445169,9.6803516926667328,9.8754876620889487,10.070623631511165,10.26575960093338,10.460895570355596,10.656031539777812,10.851167509200028,11.046303478622246,11.241439448044462,11.436575417466678,11.631711386888894,11.826847356311109,12.021983325733325,12.217119295155541,12.412255264577757,12.607391233999973,12.802527203422191,12.997663172844407,13.192799142266622,13.387935111688838,13.583071081111054,13.77820705053327,13.973343019955486,14.168478989377702,14.363614958799918,14.558750928222135,14.753886897644351,14.949022867066565,15.144158836488783,15.339294805910999,15.534430775333215,15.729566744755431,15.924702714177647,16.119838683599863,16.31497465302208,16.510110622444294,16.705246591866512,16.900382561288726,17.095518530710944,17.290654500133158,17.485790469555376,17.680926438977593,17.876062408399807,18.071198377822025,18.266334347244239,18.461470316666457,18.656606286088675,18.851742255510889,19.046878224933106],[9.6165346481455494,9.8116706175677653,10.006806586989981,10.201942556412197,10.397078525834413,10.592214495256629,10.787350464678845,10.982486434101061,11.177622403523278,11.372758372945494,11.56789434236771,11.763030311789926,11.958166281212142,12.153302250634358,12.348438220056574,12.54357418947879,12.738710158901005,12.933846128323223,13.128982097745439,13.324118067167655,13.519254036589871,13.714390006012087,13.909525975434303,14.104661944856518,14.299797914278734,14.49493388370095,14.690069853123168,14.885205822545384,15.080341791967598,15.275477761389816,15.470613730812032,15.665749700234247,15.860885669656463,16.056021639078679,16.251157608500897,16.446293577923111,16.641429547345329,16.836565516767546,17.03170148618976,17.226837455611975,17.421973425034192,17.61710939445641,17.812245363878624,18.007381333300842,18.202517302723056,18.397653272145273,18.592789241567488,18.787925210989705,18.983061180411923,19.178197149834137],[9.7478535730465836,9.9429895424687995,10.138125511891015,10.333261481313231,10.528397450735447,10.723533420157663,10.918669389579879,11.113805359002095,11.308941328424313,11.504077297846528,11.699213267268744,11.89434923669096,12.089485206113176,12.284621175535392,12.479757144957608,12.674893114379824,12.87002908380204,13.065165053224257,13.260301022646473,13.455436992068689,13.650572961490905,13.845708930913121,14.040844900335337,14.235980869757553,14.431116839179769,14.626252808601985,14.821388778024202,15.016524747446418,15.211660716868632,15.40679668629085,15.601932655713066,15.797068625135282,15.992204594557498,16.187340563979713,16.382476533401931,16.577612502824145,16.772748472246363,16.967884441668581,17.163020411090795,17.358156380513009,17.553292349935226,17.748428319357444,17.943564288779658,18.138700258201876,18.33383622762409,18.528972197046308,18.724108166468522,18.919244135890739,19.114380105312957,19.309516074735171],[9.8791724979476179,10.074308467369834,10.26944443679205,10.464580406214266,10.659716375636481,10.854852345058697,11.049988314480913,11.245124283903129,11.440260253325347,11.635396222747563,11.830532192169779,12.025668161591994,12.22080413101421,12.415940100436426,12.611076069858642,12.806212039280858,13.001348008703074,13.196483978125292,13.391619947547508,13.586755916969723,13.781891886391939,13.977027855814155,14.172163825236371,14.367299794658587,14.562435764080803,14.757571733503019,14.952707702925236,15.147843672347452,15.342979641769666,15.538115611191884,15.7332515806141,15.928387550036316,16.123523519458534,16.318659488880748,16.513795458302965,16.708931427725179,16.904067397147397,17.099203366569615,17.294339335991829,17.489475305414043,17.684611274836261,17.879747244258478,18.074883213680693,18.27001918310291,18.465155152525124,18.660291121947342,18.855427091369556,19.050563060791774,19.245699030213991,19.440834999636206],[10.01049142284865,10.205627392270866,10.400763361693082,10.595899331115298,10.791035300537514,10.98617126995973,11.181307239381946,11.376443208804162,11.571579178226379,11.766715147648595,11.961851117070811,12.156987086493027,12.352123055915243,12.547259025337459,12.742394994759675,12.937530964181891,13.132666933604106,13.327802903026324,13.52293887244854,13.718074841870756,13.913210811292972,14.108346780715188,14.303482750137404,14.498618719559619,14.693754688981835,14.888890658404051,15.084026627826269,15.279162597248485,15.474298566670699,15.669434536092917,15.864570505515132,16.05970647493735,16.254842444359564,16.449978413781782,16.645114383203996,16.840250352626214,17.035386322048428,17.230522291470646,17.42565826089286,17.620794230315077,17.815930199737291,18.011066169159509,18.206202138581727,18.401338108003941,18.596474077426159,18.791610046848373,18.98674601627059,19.181881985692808,19.377017955115022,19.57215392453724],[10.141810347749685,10.3369463171719,10.532082286594116,10.727218256016332,10.922354225438548,11.117490194860764,11.31262616428298,11.507762133705196,11.702898103127414,11.898034072549629,12.093170041971845,12.288306011394061,12.483441980816277,12.678577950238493,12.873713919660709,13.068849889082925,13.263985858505141,13.459121827927358,13.654257797349574,13.84939376677179,14.044529736194006,14.239665705616222,14.434801675038438,14.629937644460654,14.82507361388287,15.020209583305085,15.215345552727303,15.410481522149519,15.605617491571733,15.800753460993951,15.995889430416167,16.191025399838384,16.386161369260599,16.581297338682816,16.77643330810503,16.971569277527248,17.166705246949462,17.36184121637168,17.556977185793894,17.752113155216112,17.947249124638326,18.142385094060543,18.337521063482761,18.532657032904975,18.727793002327193,18.922928971749407,19.118064941171625,19.313200910593842,19.508336880016056,19.703472849438274],[10.273129272650717,10.468265242072933,10.663401211495149,10.858537180917365,11.053673150339581,11.248809119761797,11.443945089184012,11.639081058606228,11.834217028028446,12.029352997450662,12.224488966872878,12.419624936295094,12.61476090571731,12.809896875139525,13.005032844561741,13.200168813983957,13.395304783406173,13.590440752828391,13.785576722250607,13.980712691672823,14.175848661095038,14.370984630517254,14.56612059993947,14.761256569361686,14.956392538783902,15.151528508206118,15.346664477628336,15.541800447050552,15.736936416472766,15.932072385894983,16.127208355317197,16.322344324739415,16.517480294161633,16.712616263583847,16.907752233006065,17.102888202428279,17.298024171850496,17.493160141272714,17.688296110694928,17.883432080117142,18.07856804953936,18.273704018961578,18.468839988383792,18.663975957806009,18.859111927228223,19.054247896650441,19.249383866072655,19.444519835494873,19.639655804917091,19.834791774339305],[10.40444819755175,10.599584166973965,10.794720136396181,10.989856105818397,11.184992075240613,11.380128044662829,11.575264014085045,11.770399983507261,11.965535952929478,12.160671922351694,12.35580789177391,12.550943861196126,12.746079830618342,12.941215800040558,13.136351769462774,13.33148773888499,13.526623708307206,13.721759677729423,13.916895647151639,14.112031616573855,14.307167585996071,14.502303555418287,14.697439524840503,14.892575494262719,15.087711463684935,15.28284743310715,15.477983402529368,15.673119371951584,15.868255341373798,16.063391310796014,16.258527280218232,16.453663249640449,16.648799219062663,16.843935188484881,17.039071157907095,17.234207127329313,17.429343096751527,17.624479066173745,17.819615035595959,18.014751005018176,18.209886974440391,18.405022943862608,18.600158913284826,18.79529488270704,18.990430852129258,19.185566821551472,19.38070279097369,19.575838760395907,19.770974729818121,19.966110699240339],[10.535767122452784,10.730903091875,10.926039061297216,11.121175030719431,11.316311000141647,11.511446969563863,11.706582938986079,11.901718908408295,12.096854877830513,12.291990847252729,12.487126816674945,12.68226278609716,12.877398755519376,13.072534724941592,13.267670694363808,13.462806663786024,13.65794263320824,13.853078602630458,14.048214572052673,14.243350541474889,14.438486510897105,14.633622480319321,14.828758449741537,15.023894419163753,15.219030388585969,15.414166358008185,15.609302327430402,15.804438296852618,15.999574266274832,16.194710235697048,16.389846205119266,16.584982174541484,16.780118143963698,16.975254113385915,17.17039008280813,17.365526052230347,17.560662021652561,17.755797991074779,17.950933960496993,18.146069929919211,18.341205899341425,18.536341868763643,18.73147783818586,18.926613807608074,19.121749777030292,19.316885746452506,19.512021715874724,19.707157685296941,19.902293654719156,20.097429624141373],[10.667086047353816,10.862222016776032,11.057357986198248,11.252493955620464,11.44762992504268,11.642765894464896,11.837901863887112,12.033037833309328,12.228173802731545,12.423309772153761,12.618445741575977,12.813581710998193,13.008717680420409,13.203853649842625,13.398989619264841,13.594125588687056,13.789261558109272,13.98439752753149,14.179533496953706,14.374669466375922,14.569805435798138,14.764941405220354,14.960077374642569,15.155213344064785,15.350349313487001,15.545485282909217,15.740621252331435,15.935757221753651,16.130893191175865,16.326029160598083,16.521165130020297,16.716301099442514,16.911437068864732,17.106573038286946,17.301709007709164,17.496844977131378,17.691980946553596,17.887116915975813,18.082252885398027,18.277388854820241,18.472524824242459,18.667660793664677,18.862796763086891,19.057932732509109,19.253068701931323,19.44820467135354,19.643340640775754,19.838476610197972,20.03361257962019,20.228748549042404],[10.798404972254851,10.993540941677066,11.188676911099282,11.383812880521498,11.578948849943714,11.77408481936593,11.969220788788146,12.164356758210362,12.359492727632579,12.554628697054795,12.749764666477011,12.944900635899227,13.140036605321443,13.335172574743659,13.530308544165875,13.725444513588091,13.920580483010307,14.115716452432524,14.31085242185474,14.505988391276956,14.701124360699172,14.896260330121388,15.091396299543604,15.28653226896582,15.481668238388036,15.676804207810251,15.871940177232469,16.067076146654685,16.262212116076899,16.457348085499117,16.652484054921331,16.847620024343549,17.042755993765766,17.23789196318798,17.433027932610198,17.628163902032412,17.82329987145463,18.018435840876847,18.213571810299062,18.408707779721276,18.603843749143493,18.798979718565711,18.994115687987925,19.189251657410143,19.384387626832357,19.579523596254575,19.774659565676789,19.969795535099006,20.164931504521224,20.360067473943438],[10.929723897155883,11.124859866578099,11.319995836000315,11.515131805422531,11.710267774844747,11.905403744266962,12.100539713689178,12.295675683111394,12.490811652533612,12.685947621955828,12.881083591378044,13.07621956080026,13.271355530222475,13.466491499644691,13.661627469066907,13.856763438489123,14.051899407911339,14.247035377333557,14.442171346755773,14.637307316177989,14.832443285600204,15.02757925502242,15.222715224444636,15.417851193866852,15.612987163289068,15.808123132711284,16.003259102133502,16.198395071555719,16.393531040977933,16.588667010400147,16.783802979822365,16.978938949244583,17.174074918666797,17.369210888089015,17.564346857511229,17.759482826933446,17.95461879635566,18.149754765777878,18.344890735200092,18.54002670462231,18.735162674044524,18.930298643466742,19.125434612888959,19.320570582311174,19.515706551733391,19.710842521155605,19.905978490577823,20.101114460000041,20.296250429422255,20.491386398844472],[11.061042822056915,11.256178791479131,11.451314760901347,11.646450730323563,11.841586699745779,12.036722669167995,12.231858638590211,12.426994608012427,12.622130577434644,12.81726654685686,13.012402516279076,13.207538485701292,13.402674455123508,13.597810424545724,13.79294639396794,13.988082363390156,14.183218332812372,14.378354302234589,14.573490271656805,14.768626241079021,14.963762210501237,15.158898179923453,15.354034149345669,15.549170118767885,15.7443060881901,15.939442057612316,16.134578027034532,16.32971399645675,16.524849965878964,16.719985935301182,16.915121904723396,17.110257874145613,17.305393843567831,17.500529812990045,17.695665782412263,17.890801751834477,18.085937721256695,18.281073690678912,18.476209660101127,18.671345629523341,18.866481598945558,19.061617568367776,19.25675353778999,19.451889507212208,19.647025476634422,19.84216144605664,20.037297415478854,20.232433384901071,20.427569354323289,20.622705323745503],[11.19236174695795,11.387497716380166,11.582633685802382,11.777769655224597,11.972905624646813,12.168041594069029,12.363177563491245,12.558313532913461,12.753449502335679,12.948585471757895,13.14372144118011,13.338857410602326,13.533993380024542,13.729129349446758,13.924265318868974,14.11940128829119,14.314537257713406,14.509673227135623,14.704809196557839,14.899945165980055,15.095081135402271,15.290217104824487,15.485353074246703,15.680489043668919,15.875625013091135,16.070760982513352,16.265896951935567,16.461032921357784,16.656168890779998,16.851304860202216,17.04644082962443,17.241576799046648,17.436712768468865,17.63184873789108,17.826984707313297,18.022120676735511,18.217256646157729,18.412392615579947,18.607528585002161,18.802664554424375,18.997800523846593,19.19293649326881,19.388072462691024,19.583208432113242,19.778344401535456,19.973480370957674,20.168616340379888,20.363752309802106,20.558888279224323,20.754024248646537],[11.323680671858982,11.518816641281198,11.713952610703414,11.90908858012563,12.104224549547846,12.299360518970062,12.494496488392278,12.689632457814493,12.884768427236711,13.079904396658927,13.275040366081143,13.470176335503359,13.665312304925575,13.860448274347791,14.055584243770006,14.250720213192222,14.445856182614438,14.640992152036656,14.836128121458872,15.031264090881088,15.226400060303304,15.42153602972552,15.616671999147735,15.811807968569951,16.006943937992169,16.202079907414383,16.397215876836601,16.592351846258818,16.787487815681033,16.982623785103247,17.177759754525464,17.372895723947682,17.568031693369896,17.763167662792114,17.958303632214328,18.153439601636546,18.34857557105876,18.543711540480977,18.738847509903191,18.933983479325409,19.129119448747623,19.324255418169841,19.519391387592059,19.714527357014273,19.90966332643649,20.104799295858705,20.299935265280922,20.49507123470314,20.690207204125354,20.885343173547572],[11.454999596760016,11.650135566182232,11.845271535604448,12.040407505026664,12.23554347444888,12.430679443871096,12.625815413293312,12.820951382715528,13.016087352137745,13.211223321559961,13.406359290982177,13.601495260404393,13.796631229826609,13.991767199248825,14.186903168671041,14.382039138093257,14.577175107515473,14.77231107693769,14.967447046359906,15.162583015782122,15.357718985204338,15.552854954626554,15.74799092404877,15.943126893470986,16.138262862893203,16.333398832315417,16.528534801737635,16.723670771159853,16.918806740582067,17.113942710004281,17.309078679426499,17.504214648848716,17.69935061827093,17.894486587693148,18.089622557115362,18.28475852653758,18.479894495959794,18.675030465382012,18.870166434804226,19.065302404226443,19.260438373648658,19.455574343070875,19.650710312493093,19.845846281915307,20.040982251337525,20.236118220759739,20.431254190181956,20.626390159604174,20.821526129026388,21.016662098448606],[11.586318521661049,11.781454491083265,11.976590460505481,12.171726429927697,12.366862399349912,12.561998368772128,12.757134338194344,12.95227030761656,13.147406277038778,13.342542246460994,13.53767821588321,13.732814185305426,13.927950154727641,14.123086124149857,14.318222093572073,14.513358062994289,14.708494032416505,14.903630001838723,15.098765971260939,15.293901940683154,15.48903791010537,15.684173879527586,15.879309848949802,16.07444581837202,16.269581787794234,16.464717757216452,16.659853726638666,16.854989696060883,17.050125665483097,17.245261634905315,17.440397604327529,17.635533573749747,17.830669543171965,18.025805512594179,18.220941482016396,18.416077451438611,18.611213420860828,18.806349390283046,19.00148535970526,19.196621329127474,19.391757298549692,19.586893267971909,19.782029237394124,19.977165206816341,20.172301176238555,20.367437145660773,20.562573115082987,20.757709084505205,20.952845053927422,21.147981023349637],[11.717637446562083,11.912773415984299,12.107909385406515,12.303045354828731,12.498181324250947,12.693317293673163,12.888453263095379,13.083589232517594,13.278725201939812,13.473861171362028,13.668997140784244,13.86413311020646,14.059269079628676,14.254405049050892,14.449541018473107,14.644676987895323,14.839812957317539,15.034948926739757,15.230084896161973,15.425220865584189,15.620356835006405,15.81549280442862,16.010628773850836,16.205764743273054,16.400900712695268,16.596036682117486,16.7911726515397,16.986308620961918,17.181444590384132,17.376580559806349,17.571716529228564,17.766852498650781,17.961988468072999,18.157124437495213,18.352260406917431,18.547396376339645,18.742532345761862,18.93766831518408,19.132804284606294,19.327940254028508,19.523076223450726,19.718212192872944,19.913348162295158,20.108484131717375,20.30362010113959,20.498756070561807,20.693892039984021,20.889028009406239,21.084163978828457,21.279299948250671],[11.848956371463116,12.044092340885332,12.239228310307547,12.434364279729763,12.629500249151979,12.824636218574195,13.019772187996411,13.214908157418627,13.410044126840845,13.60518009626306,13.800316065685276,13.995452035107492,14.190588004529708,14.385723973951924,14.58085994337414,14.775995912796356,14.971131882218572,15.166267851640789,15.361403821063005,15.556539790485221,15.751675759907437,15.946811729329653,16.141947698751871,16.337083668174085,16.532219637596302,16.727355607018517,16.922491576440734,17.117627545862952,17.312763515285166,17.50789948470738,17.703035454129598,17.898171423551815,18.09330739297403,18.288443362396247,18.483579331818461,18.678715301240679,18.873851270662893,19.068987240085111,19.264123209507325,19.459259178929543,19.654395148351757,19.849531117773974,20.044667087196192,20.239803056618406,20.434939026040624,20.630074995462838,20.825210964885056,21.020346934307273,21.215482903729487,21.410618873151705],[11.98027529636415,12.175411265786366,12.370547235208582,12.565683204630798,12.760819174053013,12.955955143475229,13.151091112897445,13.346227082319661,13.541363051741879,13.736499021164095,13.931634990586311,14.126770960008527,14.321906929430742,14.517042898852958,14.712178868275174,14.90731483769739,15.102450807119606,15.297586776541824,15.49272274596404,15.687858715386255,15.882994684808471,16.078130654230687,16.273266623652905,16.468402593075119,16.663538562497337,16.858674531919551,17.053810501341768,17.248946470763986,17.4440824401862,17.639218409608414,17.834354379030632,18.02949034845285,18.224626317875064,18.419762287297281,18.614898256719496,18.810034226141713,19.005170195563927,19.200306164986145,19.395442134408359,19.590578103830577,19.785714073252791,19.980850042675009,20.175986012097226,20.37112198151944,20.566257950941658,20.761393920363872,20.95652988978609,21.151665859208308,21.346801828630522,21.541937798052739],[12.111594221265182,12.306730190687398,12.501866160109614,12.69700212953183,12.892138098954046,13.087274068376262,13.282410037798478,13.477546007220694,13.672681976642911,13.867817946065127,14.062953915487343,14.258089884909559,14.453225854331775,14.648361823753991,14.843497793176207,15.038633762598423,15.233769732020638,15.428905701442856,15.624041670865072,15.819177640287288,16.014313609709504,16.209449579131718,16.404585548553936,16.599721517976153,16.794857487398367,16.989993456820585,17.185129426242799,17.380265395665017,17.575401365087231,17.770537334509449,17.965673303931663,18.16080927335388,18.355945242776098,18.551081212198312,18.74621718162053,18.941353151042744,19.136489120464962,19.331625089887179,19.526761059309393,19.721897028731608,19.917032998153825,20.112168967576043,20.307304936998257,20.502440906420475,20.697576875842689,20.892712845264906,21.087848814687121,21.282984784109338,21.478120753531556,21.67325672295377],[12.242913146166217,12.438049115588433,12.633185085010648,12.828321054432864,13.02345702385508,13.218592993277296,13.413728962699512,13.608864932121728,13.804000901543946,13.999136870966161,14.194272840388377,14.389408809810593,14.584544779232809,14.779680748655025,14.974816718077241,15.169952687499457,15.365088656921673,15.56022462634389,15.755360595766106,15.950496565188322,16.145632534610538,16.340768504032752,16.53590447345497,16.731040442877188,16.926176412299402,17.121312381721619,17.316448351143833,17.511584320566051,17.706720289988265,17.901856259410483,18.096992228832697,18.292128198254915,18.487264167677132,18.682400137099346,18.877536106521564,19.072672075943778,19.267808045365996,19.462944014788214,19.658079984210428,19.853215953632642,20.048351923054859,20.243487892477077,20.438623861899291,20.633759831321509,20.828895800743723,21.024031770165941,21.219167739588155,21.414303709010373,21.60943967843259,21.804575647854804],[12.374232071067249,12.569368040489465,12.764504009911681,12.959639979333897,13.154775948756113,13.349911918178329,13.545047887600544,13.74018385702276,13.935319826444978,14.130455795867194,14.32559176528941,14.520727734711626,14.715863704133842,14.910999673556057,15.106135642978273,15.301271612400489,15.496407581822705,15.691543551244923,15.886679520667139,16.081815490089355,16.276951459511569,16.472087428933786,16.667223398356004,16.862359367778218,17.057495337200436,17.25263130662265,17.447767276044868,17.642903245467085,17.838039214889299,18.033175184311514,18.228311153733731,18.423447123155949,18.618583092578163,18.813719062000381,19.008855031422595,19.203991000844812,19.399126970267027,19.594262939689244,19.789398909111458,19.984534878533676,20.17967084795589,20.374806817378108,20.569942786800326,20.76507875622254,20.960214725644757,21.155350695066971,21.350486664489189,21.545622633911407,21.740758603333621,21.935894572755839],[12.505550995968282,12.700686965390497,12.895822934812713,13.090958904234929,13.286094873657145,13.481230843079361,13.676366812501577,13.871502781923793,14.06663875134601,14.261774720768226,14.456910690190442,14.652046659612658,14.847182629034874,15.04231859845709,15.237454567879306,15.432590537301522,15.627726506723738,15.822862476145955,16.017998445568171,16.213134414990385,16.408270384412603,16.603406353834817,16.798542323257035,16.993678292679252,17.188814262101467,17.383950231523684,17.579086200945898,17.774222170368116,17.96935813979033,18.164494109212548,18.359630078634762,18.55476604805698,18.749902017479197,18.945037986901411,19.140173956323629,19.335309925745843,19.530445895168061,19.725581864590279,19.920717834012493,20.115853803434707,20.310989772856924,20.506125742279142,20.701261711701356,20.896397681123574,21.091533650545788,21.286669619968006,21.48180558939022,21.676941558812437,21.872077528234655,22.067213497656869],[12.636869920869316,12.832005890291532,13.027141859713748,13.222277829135964,13.417413798558179,13.612549767980395,13.807685737402611,14.002821706824827,14.197957676247045,14.393093645669261,14.588229615091477,14.783365584513692,14.978501553935908,15.173637523358124,15.36877349278034,15.563909462202556,15.759045431624772,15.95418140104699,16.149317370469205,16.34445333989142,16.539589309313637,16.734725278735851,16.929861248158069,17.124997217580287,17.320133187002501,17.515269156424718,17.710405125846933,17.90554109526915,18.100677064691364,18.295813034113582,18.490949003535796,18.686084972958014,18.881220942380232,19.076356911802446,19.271492881224663,19.466628850646877,19.661764820069095,19.856900789491313,20.052036758913527,20.247172728335741,20.442308697757959,20.637444667180176,20.83258063660239,21.027716606024608,21.222852575446822,21.41798854486904,21.613124514291254,21.808260483713472,22.003396453135689,22.198532422557903],[12.768188845770348,12.963324815192564,13.15846078461478,13.353596754036996,13.548732723459212,13.743868692881428,13.939004662303644,14.13414063172586,14.329276601148077,14.524412570570293,14.719548539992509,14.914684509414725,15.109820478836941,15.304956448259157,15.500092417681373,15.695228387103588,15.890364356525804,16.085500325948022,16.280636295370236,16.475772264792454,16.670908234214668,16.866044203636886,17.061180173059103,17.256316142481317,17.451452111903535,17.646588081325749,17.841724050747967,18.036860020170185,18.231995989592399,18.427131959014613,18.62226792843683,18.817403897859048,19.012539867281262,19.20767583670348,19.402811806125694,19.597947775547912,19.793083744970126,19.988219714392343,20.183355683814558,20.378491653236775,20.573627622658989,20.768763592081207,20.963899561503425,21.159035530925639,21.354171500347856,21.549307469770071,21.744443439192288,21.939579408614506,22.13471537803672,22.329851347458938],[12.899507770671383,13.094643740093598,13.289779709515814,13.48491567893803,13.680051648360246,13.875187617782462,14.070323587204678,14.265459556626894,14.460595526049111,14.655731495471327,14.850867464893543,15.046003434315759,15.241139403737975,15.436275373160191,15.631411342582407,15.826547312004623,16.021683281426839,16.216819250849056,16.41195522027127,16.607091189693488,16.802227159115702,16.99736312853792,17.192499097960138,17.387635067382352,17.582771036804569,17.777907006226783,17.973042975649001,18.168178945071219,18.363314914493433,18.558450883915647,18.753586853337865,18.948722822760082,19.143858792182296,19.338994761604514,19.534130731026728,19.729266700448946,19.92440266987116,20.119538639293378,20.314674608715592,20.50981057813781,20.704946547560024,20.900082516982241,21.095218486404459,21.290354455826673,21.485490425248891,21.680626394671105,21.875762364093323,22.07089833351554,22.266034302937754,22.461170272359972],[13.030826695572415,13.225962664994631,13.421098634416847,13.616234603839063,13.811370573261279,14.006506542683494,14.20164251210571,14.396778481527926,14.591914450950144,14.78705042037236,14.982186389794576,15.177322359216792,15.372458328639008,15.567594298061223,15.762730267483439,15.957866236905655,16.153002206327873,16.348138175750087,16.543274145172305,16.738410114594519,16.933546084016736,17.128682053438951,17.323818022861168,17.518953992283386,17.7140899617056,17.909225931127818,18.104361900550032,18.299497869972249,18.494633839394464,18.689769808816681,18.884905778238895,19.080041747661113,19.275177717083331,19.470313686505545,19.665449655927763,19.860585625349977,20.055721594772194,20.250857564194412,20.445993533616626,20.64112950303884,20.836265472461058,21.031401441883276,21.22653741130549,21.421673380727707,21.616809350149921,21.811945319572139,22.007081288994353,22.202217258416571,22.397353227838789,22.592489197261003],[13.162145620473447,13.357281589895663,13.552417559317879,13.747553528740095,13.942689498162311,14.137825467584527,14.332961437006743,14.528097406428959,14.723233375851176,14.918369345273392,15.113505314695608,15.308641284117824,15.50377725354004,15.698913222962256,15.894049192384472,16.089185161806689,16.284321131228904,16.479457100651121,16.674593070073335,16.869729039495553,17.064865008917767,17.260000978339985,17.455136947762202,17.650272917184417,17.845408886606634,18.040544856028848,18.235680825451066,18.430816794873284,18.625952764295498,18.821088733717712,19.01622470313993,19.211360672562147,19.406496641984361,19.601632611406579,19.796768580828793,19.991904550251011,20.187040519673225,20.382176489095443,20.577312458517657,20.772448427939874,20.967584397362089,21.162720366784306,21.357856336206524,21.552992305628738,21.748128275050956,21.94326424447317,22.138400213895387,22.333536183317605,22.528672152739819,22.723808122162037]],"type":"surface","x":[5.0281147996429354,5.9406459251209638,6.8531770505989922,7.7657081760770206,8.678239301555049,9.5907704270330782,10.503301552511106,11.415832677989133,12.328363803467163,13.240894928945192,14.153426054423219,15.065957179901247,15.978488305379276,16.891019430857305,17.803550556335331,18.71608168181336,19.62861280729139,20.541143932769419,21.453675058247448,22.366206183725474,23.278737309203503,24.191268434681533,25.103799560159558,26.016330685637588,26.928861811115617,27.841392936593646,28.753924062071675,29.666455187549701,30.57898631302773,31.49151743850576,32.404048563983785,33.316579689461818,34.229110814939844,35.14164194041787,36.054173065895903,36.966704191373928,37.879235316851961,38.791766442329987,39.704297567808013,40.616828693286045,41.529359818764071,42.441890944242097,43.35442206972013,44.266953195198155,45.179484320676181,46.092015446154214,47.00454657163224,47.917077697110273,48.829608822588298,49.742139948066324],"y":[1.3035462431143969,1.8806899044168541,2.4578335657193113,3.034977227021769,3.6121208883242262,4.1892645496266834,4.766408210929141,5.3435518722315978,5.9206955335340554,6.4978391948365131,7.0749828561389698,7.6521265174414275,8.2292701787438851,8.8064138400463428,9.3835575013487986,9.9607011626512563,10.537844823953714,11.114988485256172,11.692132146558629,12.269275807861085,12.846419469163543,13.423563130466,14.000706791768458,14.577850453070916,15.154994114373373,15.732137775675829,16.309281436978289,16.886425098280746,17.4635687595832,18.040712420885658,18.617856082188116,19.194999743490573,19.772143404793031,20.349287066095489,20.926430727397946,21.503574388700404,22.080718050002861,22.657861711305319,23.235005372607773,23.812149033910231,24.389292695212688,24.966436356515146,25.543580017817604,26.120723679120061,26.697867340422519,27.275011001724977,27.852154663027434,28.429298324329892,29.00644198563235,29.583585646934807],"opacity":0.80000000000000004,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>变量选择方法</strong>： 当有多个潜在自变量时，我们需要选择一个最佳的变量子集：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 向前逐步回归</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> advertising_data)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> ., <span class="at">data =</span> advertising_data)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null_model, <span class="at">upper =</span> full_model), </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=257.97
Sales ~ 1

            Df Sum of Sq    RSS    AIC
+ Radio      1    582.31  710.9 200.14
+ TV         1    259.77 1033.4 237.55
&lt;none&gt;                   1293.2 257.97
+ Newspaper  1      6.87 1286.3 259.44

Step:  AIC=200.14
Sales ~ Radio

            Df Sum of Sq    RSS    AIC
+ TV         1    334.64 376.26 138.51
+ Newspaper  1     26.73 684.17 198.30
&lt;none&gt;                   710.90 200.14

Step:  AIC=138.51
Sales ~ Radio + TV

            Df Sum of Sq    RSS    AIC
+ Newspaper  1    43.823 332.44 128.13
&lt;none&gt;                   376.26 138.51

Step:  AIC=128.13
Sales ~ Radio + TV + Newspaper</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 向后逐步回归</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=128.13
Sales ~ TV + Radio + Newspaper

            Df Sum of Sq     RSS    AIC
&lt;none&gt;                    332.44 128.13
- Newspaper  1     43.82  376.26 138.51
- TV         1    351.73  684.17 198.30
- Radio      1    687.08 1019.52 238.19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 双向逐步回归（同时考虑增加和删除变量）</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>stepwise_model <span class="ot">&lt;-</span> <span class="fu">step</span>(null_model, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> null_model, <span class="at">upper =</span> full_model), </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=257.97
Sales ~ 1

            Df Sum of Sq    RSS    AIC
+ Radio      1    582.31  710.9 200.14
+ TV         1    259.77 1033.4 237.55
&lt;none&gt;                   1293.2 257.97
+ Newspaper  1      6.87 1286.3 259.44

Step:  AIC=200.14
Sales ~ Radio

            Df Sum of Sq     RSS    AIC
+ TV         1    334.64  376.26 138.51
+ Newspaper  1     26.73  684.17 198.30
&lt;none&gt;                    710.90 200.14
- Radio      1    582.31 1293.21 257.97

Step:  AIC=138.51
Sales ~ Radio + TV

            Df Sum of Sq     RSS    AIC
+ Newspaper  1     43.82  332.44 128.13
&lt;none&gt;                    376.26 138.51
- TV         1    334.64  710.90 200.14
- Radio      1    657.18 1033.44 237.55

Step:  AIC=128.13
Sales ~ Radio + TV + Newspaper

            Df Sum of Sq     RSS    AIC
&lt;none&gt;                    332.44 128.13
- Newspaper  1     43.82  376.26 138.51
- TV         1    351.73  684.17 198.30
- Radio      1    687.08 1019.52 238.19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用Leaps包进行最优子集选择</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(leaps)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>subsets <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Sales <span class="sc">~</span> ., <span class="at">data =</span> advertising_data, <span class="at">nvmax =</span> <span class="fu">ncol</span>(advertising_data) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(subsets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(Sales ~ ., data = advertising_data, nvmax = ncol(advertising_data) - 
    1)
3 Variables  (and intercept)
          Forced in Forced out
TV            FALSE      FALSE
Radio         FALSE      FALSE
Newspaper     FALSE      FALSE
1 subsets of each size up to 3
Selection Algorithm: exhaustive
         TV  Radio Newspaper
1  ( 1 ) " " "*"   " "      
2  ( 1 ) "*" "*"   " "      
3  ( 1 ) "*" "*"   "*"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subsets, <span class="at">scale =</span> <span class="st">"r2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subsets, <span class="at">scale =</span> <span class="st">"adjr2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subsets, <span class="at">scale =</span> <span class="st">"Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subsets, <span class="at">scale =</span> <span class="st">"bic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<p><strong>正则化回归</strong>： 处理多重共线性和预防过拟合的现代方法：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 岭回归</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(advertising_data[, <span class="fu">c</span>(<span class="st">"TV"</span>, <span class="st">"Radio"</span>, <span class="st">"Newspaper"</span>)])</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> advertising_data<span class="sc">$</span>Sales</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ridge_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge_model, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>cv_ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>best_lambda <span class="ot">&lt;-</span> cv_ridge<span class="sc">$</span>lambda.min</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(ridge_model, <span class="at">s =</span> best_lambda)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Lasso回归</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>lasso_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lasso_model, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>best_lambda <span class="ot">&lt;-</span> cv_lasso<span class="sc">$</span>lambda.min</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(lasso_model, <span class="at">s =</span> best_lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="回归分析的实际应用案例" class="level3">
<h3 class="anchored" data-anchor-id="回归分析的实际应用案例">回归分析的实际应用案例</h3>
<p><strong>案例1：房价预测模型</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 导入波士顿房价数据集</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 变量说明</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># medv: 自住房屋的中位数价值（千美元）（因变量）</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># rm: 每套住宅的平均房间数</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># lstat: 人口中地位较低人群的百分比</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># crim: 城镇人均犯罪率</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># zn: 占地面积超过2.5万平方英尺的住宅用地比例</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># indus: 每个城镇非零售业务的比例</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># chas: 查尔斯河虚拟变量（1 = 边界在河边；0 = 否）</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co"># nox: 一氧化氮浓度（千万分之一）</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 探索性分析</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Boston[, <span class="fu">c</span>(<span class="st">"medv"</span>, <span class="st">"rm"</span>, <span class="st">"lstat"</span>, <span class="st">"crim"</span>, <span class="st">"nox"</span>)])</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Boston)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 建立模型</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>model_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_all)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 变量选择</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(model_all, <span class="at">direction =</span> <span class="st">"both"</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 最优模型解释与诊断</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(step_model)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 预测</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>new_house <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">rm =</span> <span class="fl">6.5</span>,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">lstat =</span> <span class="dv">10</span>,</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">crim =</span> <span class="fl">0.5</span>,</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">zn =</span> <span class="dv">50</span>,</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">indus =</span> <span class="dv">5</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">chas =</span> <span class="dv">0</span>,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">nox =</span> <span class="fl">0.5</span>,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">50</span>,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">dis =</span> <span class="dv">4</span>,</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">rad =</span> <span class="dv">6</span>,</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">tax =</span> <span class="dv">400</span>,</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">ptratio =</span> <span class="dv">15</span>,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">black =</span> <span class="dv">380</span>,</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">chas =</span> <span class="dv">0</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(step_model, <span class="at">newdata =</span> new_house, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>案例2：销售额预测与营销投资优化</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用前面的广告数据</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 假设我们有一个额外的数据集，包含不同产品线的广告效果</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>product_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">30</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">TV =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">5</span>, <span class="dv">50</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Radio =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">30</span>),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Newspaper =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成不同的效应模式</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>product_data<span class="sc">$</span>Sales <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"A"</span>, <span class="fl">0.2</span>, </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"B"</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>)) <span class="sc">*</span> product_data<span class="sc">$</span>TV <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"A"</span>, <span class="fl">0.15</span>, </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"B"</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)) <span class="sc">*</span> product_data<span class="sc">$</span>Radio <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"A"</span>, <span class="fl">0.05</span>, </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(product_data<span class="sc">$</span>product <span class="sc">==</span> <span class="st">"B"</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>)) <span class="sc">*</span> product_data<span class="sc">$</span>Newspaper <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析不同产品线的广告效果</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(product_data, <span class="fu">aes</span>(<span class="at">x =</span> TV, <span class="at">y =</span> Sales, <span class="at">color =</span> product)) <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>product) <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"不同产品线的电视广告效果"</span>) <span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 为每个产品线建立单独的模型</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>product_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(p <span class="cf">in</span> <span class="fu">unique</span>(product_data<span class="sc">$</span>product)) {</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="ot">&lt;-</span> product_data[product_data<span class="sc">$</span>product <span class="sc">==</span> p, ]</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  product_models[[p]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Newspaper, <span class="at">data =</span> subset_data)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Product"</span>, p, <span class="st">"model:"</span>))</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(product_models[[p]]))</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 互动效应模型（产品与广告渠道的交互）</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> product <span class="sc">*</span> (TV <span class="sc">+</span> Radio <span class="sc">+</span> Newspaper), </span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> product_data)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 营销预算优化：基于边际回报率</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据回归系数计算每个渠道的投资回报率，优化预算分配</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>案例3：市场细分分析</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 不同市场细分的回归分析</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>segment_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">customer_segment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"高收入"</span>, <span class="st">"中收入"</span>, <span class="st">"低收入"</span>), <span class="at">each =</span> <span class="dv">30</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">50</span>, <span class="dv">200</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">promotion =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">store_quality =</span> <span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 不同细分市场的消费者对价格和促销的敏感度不同</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>segment_data<span class="sc">$</span>purchase <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(segment_data<span class="sc">$</span>customer_segment <span class="sc">==</span> <span class="st">"高收入"</span>, <span class="sc">-</span><span class="fl">0.01</span>, </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(segment_data<span class="sc">$</span>customer_segment <span class="sc">==</span> <span class="st">"中收入"</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">*</span> segment_data<span class="sc">$</span>price <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(segment_data<span class="sc">$</span>customer_segment <span class="sc">==</span> <span class="st">"高收入"</span>, <span class="dv">1</span>, </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(segment_data<span class="sc">$</span>customer_segment <span class="sc">==</span> <span class="st">"中收入"</span>, <span class="dv">2</span>, <span class="dv">3</span>)) <span class="sc">*</span> segment_data<span class="sc">$</span>promotion <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> segment_data<span class="sc">$</span>store_quality <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析不同细分市场的价格敏感度</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>segment_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="fu">unique</span>(segment_data<span class="sc">$</span>customer_segment)) {</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="ot">&lt;-</span> segment_data[segment_data<span class="sc">$</span>customer_segment <span class="sc">==</span> s, ]</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  segment_models[[s]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(purchase <span class="sc">~</span> price <span class="sc">+</span> promotion <span class="sc">+</span> store_quality, </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> subset_data)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Segment"</span>, s, <span class="st">"model:"</span>))</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(segment_models[[s]]))</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 差异化定价策略建议</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>price_sensitivity <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">segment =</span> <span class="fu">names</span>(segment_models),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_effect =</span> <span class="fu">sapply</span>(segment_models, <span class="cf">function</span>(model) <span class="fu">coef</span>(model)[<span class="st">"price"</span>])</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(price_sensitivity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
AI辅助学习建议（第六周）
</div>
</div>
<div class="callout-body-container callout-body">
<section id="回归分析理解与解释" class="level3">
<h3 class="anchored" data-anchor-id="回归分析理解与解释">回归分析理解与解释</h3>
<ul>
<li><strong>请AI解释回归系数的含义</strong>：要求AI使用通俗易懂的语言解释回归系数的实际意义</li>
<li><strong>让AI比较相关分析与回归分析</strong>：理解两者的区别和各自适用场景</li>
<li><strong>要求AI解释拟合优度(R²)</strong>：深入理解R²的含义、局限性和在商业分析中的解读方式</li>
</ul>
</section>
<section id="r代码编写与模型构建" class="level3">
<h3 class="anchored" data-anchor-id="r代码编写与模型构建">R代码编写与模型构建</h3>
<ul>
<li><strong>请AI生成完整的回归分析流程代码</strong>：从数据探索、模型构建到诊断和解释的全流程代码</li>
<li><strong>让AI帮助进行变量选择</strong>：生成向前、向后或逐步回归代码，并解释选择逻辑</li>
<li><strong>要求AI编写回归结果可视化代码</strong>：创建更专业和直观的回归结果展示图</li>
</ul>
</section>
<section id="回归模型诊断与优化" class="level3">
<h3 class="anchored" data-anchor-id="回归模型诊断与优化">回归模型诊断与优化</h3>
<ul>
<li><strong>请AI检查回归模型假设</strong>：生成检验线性性、同方差性、独立性和正态性的代码和解释</li>
<li><strong>让AI解释多重共线性问题</strong>：诊断和处理多重共线性的方法</li>
<li><strong>要求AI优化模型预测性能</strong>：提供提高模型预测准确性的建议</li>
</ul>
</section>
<section id="回归分析应用场景" class="level3">
<h3 class="anchored" data-anchor-id="回归分析应用场景">回归分析应用场景</h3>
<ul>
<li><strong>请AI推荐适合项目主题的回归应用问题</strong>：根据选择的项目主题获取具体的研究问题建议</li>
<li><strong>让AI设计商业分析方案</strong>：设计从数据收集到分析解释的完整方案</li>
<li><strong>要求AI解释回归分析在不同行业的应用</strong>：了解回归分析在市场营销、金融、人力资源等领域的典型应用案例</li>
</ul>
</section>
</div>
</div>
</section>
<section id="参考文献与扩展阅读" class="level3">
<h3 class="anchored" data-anchor-id="参考文献与扩展阅读">参考文献与扩展阅读</h3>
<ol type="1">
<li>James, G., Witten, D., Hastie, T., &amp; Tibshirani, R. (2013). An Introduction to Statistical Learning. Springer.</li>
<li>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W. (2005). Applied Linear Statistical Models (5th ed.). McGraw-Hill.</li>
<li>Fox, J. (2016). Applied Regression Analysis and Generalized Linear Models (3rd ed.). SAGE Publications.</li>
<li>Faraway, J. J. (2014). Linear Models with R (2nd ed.). Chapman and Hall/CRC.</li>
<li>李惠莲. (2018). 回归分析在商业决策中的应用. 统计与决策, 34(15), 82-85.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week5.html" class="pagination-link" aria-label="第五周：方差分析">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">第五周：方差分析</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week7.html" class="pagination-link" aria-label="第七周：分类数据分析">
        <span class="nav-page-text"><span class="chapter-title">第七周：分类数据分析</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>