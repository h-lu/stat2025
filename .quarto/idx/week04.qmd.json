{"title":"第四周：推断性统计初步：参数估计与假设检验","markdown":{"headingText":"第四周：推断性统计初步：参数估计与假设检验","containsRefs":false,"markdown":"\n### 从样本推断总体：推断性统计入门\n\n前三周我们学习了描述性统计，掌握了如何概括和可视化数据。  从本周开始，我们将进入统计学的核心领域：**推断性统计**。  推断性统计的目标是**利用样本数据来推断总体特征**。  由于我们通常无法获取总体的全部数据，只能通过抽样获得样本数据，因此需要使用推断性统计方法，**基于样本信息，对总体参数进行估计和检验**。  本周我们将学习推断性统计的两个基本内容：**参数估计**和 **假设检验**，并初步接触常用的 **t 检验**。\n\n**继续使用 VS Code 或 Cursor + AI 插件：**  请继续使用 VS Code 或 Cursor 编辑器，并充分利用 AI 插件的代码辅助、智能提示、聊天问答等功能，提升学习效率。\n\n::: {.callout-note}\n## 本周学习目标\n\n*   **推断性统计核心思想:**  理解推断性统计的目的和基本逻辑。\n*   **参数估计:**  掌握点估计和区间估计的基本概念和方法。\n*   **假设检验:**  理解假设检验的基本原理和步骤。\n*   **假设检验的错误、功效与效应量:** 理解假设检验中 Type I 错误和 Type II 错误，掌握检验功效和效应量的概念和意义。\n*   **t 检验:**  掌握单样本 t 检验和双样本 t 检验 (独立样本、配对样本) 的适用条件和 R 语言实现，并能计算效应量 Cohen's d 和进行功效分析。\n*   **抽样分布:**  理解抽样分布的概念，为理解推断性统计奠定基础。\n*   **项目中期检查准备:**  开始准备项目一的中期检查汇报。\n*   **AI 辅助统计推断:**  探索使用 AI 工具辅助统计推断学习和应用。\n:::\n\n---\n\n### 1. 推断性统计核心思想：从样本到总体\n\n*   **总体 (Population) 与 样本 (Sample) 回顾:**  回顾第一周学习的总体和样本的概念。\n\n    *   **总体:**  研究对象的全体，是我们想要了解的**真实情况**。  例如，所有本科生、所有股票、所有商品。  总体通常很大，甚至无限，**难以直接获取总体全部数据**。\n    *   **样本:**  从总体中抽取的一部分个体，是**实际观测到的数据**。  例如，随机抽取的 100 名本科生、某只股票过去一年的交易数据、某批次商品中抽取的 10 件商品。  **样本数据是总体信息的载体，我们通过分析样本数据来推断总体特征。**\n\n*   **参数 (Parameter) 与 统计量 (Statistic):**\n\n    *   **参数:**  描述**总体特征**的数值，例如，总体均值 (μ)、总体标准差 (σ)、总体比例 (P)。  **总体参数是未知的，是我们想要估计的目标。**\n    *   **统计量:**  描述**样本特征**的数值，例如，样本均值 ($\\\\bar{x}$)、样本标准差 (s)、样本比例 ($\\\\hat{p}$)。  **统计量是已知的，可以根据样本数据计算出来，用于估计总体参数。**\n\n*   **抽样 (Sampling) 与 随机性 (Randomness):**\n\n    *   **抽样:**  从总体中抽取样本的过程。  **随机抽样**是推断性统计的基础，保证样本的**代表性**，避免抽样偏差。  常用的随机抽样方法包括简单随机抽样、分层抽样、整群抽样等。\n    *   **随机性:**  抽样过程中的随机性导致**样本统计量具有随机性**，不同的样本会得到不同的统计量。  **抽样分布**描述了样本统计量的随机性规律。\n\n### 2. 参数估计：用样本估计总体\n\n*   **点估计 (Point Estimation):**\n\n    *   **用样本统计量直接估计总体参数。**  例如，用样本均值 $\\\\bar{x}$ 估计总体均值 μ，用样本标准差 s 估计总体标准差 σ，用样本比例 $\\\\hat{p}$ 估计总体比例 P。\n    *   **点估计的优点是简单直观，易于计算。  缺点是只给出一个估计值，没有说明估计的精确程度，可能存在较大误差。**  例如，我们用一个样本均值 52 来估计总体均值，但总体均值可能是 50，也可能是 55，我们不知道 52 这个估计值有多可靠。\n\n*   **区间估计 (Interval Estimation):**\n\n    *   **给出一个总体参数的可能取值范围，并说明该范围包含总体参数真值的可信程度。**  例如，总体均值的 95% 置信区间为 [48, 56]，表示我们有 95% 的把握认为总体均值落在 48 到 56 之间。\n    *   **区间估计比点估计提供更丰富的信息，既给出了估计范围，又说明了估计的可靠性。**  常用的区间估计方法是**置信区间 (Confidence Interval)**。\n\n*   **置信区间 (Confidence Interval, CI):**\n\n    *   **置信区间是指由样本数据计算出的、包含总体参数真值的某个概率范围。**  例如，95% 置信区间表示，如果重复抽样 100 次，每次都计算一个置信区间，那么平均会有 95 个区间包含总体参数的真值。\n    *   **置信水平 (Confidence Level):**  **表示置信区间包含总体参数真值的概率，常用百分数表示，例如 90%, 95%, 99%。**  常用的置信水平是 95%，对应的 $\\\\alpha = 1 - 0.95 = 0.05$。  置信水平越高，置信区间越宽，包含总体参数真值的可能性越大，但估计的精确度降低。  置信水平越低，置信区间越窄，估计的精确度提高，但包含总体参数真值的可能性降低。\n    *   **置信区间的计算:**  置信区间的计算公式取决于总体参数类型、样本统计量分布、样本容量等因素。  例如，总体均值 μ 的置信区间 (样本容量较大时，总体标准差 σ 已知)：\n\n        $$\n        置信区间 = 样本均值 \\\\pm 临界值 \\\\times 标准误差 = \\\\bar{x} \\\\pm Z_{\\\\alpha/2} \\\\times \\\\frac{\\\\sigma}{\\\\sqrt{n}}\n        $$\n\n        其中，$\\\\bar{x}$ 是样本均值，$\\\\sigma$ 是总体标准差，n 是样本容量，$Z_{\\\\alpha/2}$ 是标准正态分布的临界值 (例如，95% 置信水平时，$\\\\alpha = 0.05$, $\\\\alpha/2 = 0.025$, $Z_{0.025} = 1.96$)，$\\frac{\\\\sigma}{\\\\sqrt{n}}$ 是样本均值 $\\\\bar{x}$ 的标准误差。\n\n    *   **R 函数 `t.test()`  计算 t 检验的置信区间:**  `t.test()` 函数可以进行 t 检验，并输出均值差的置信区间。  例如，独立样本 t 检验，比较两组均值差异，`t.test()`  输出的是两组均值差的置信区间。\n\n### 3. 假设检验：检验关于总体的假设\n\n*   **假设检验的基本思想:**\n\n    *   **先对总体参数提出一个假设 (原假设 H₀)，然后利用样本数据，判断是否有充分的证据拒绝原假设 H₀，接受备择假设 H₁。**  类似于法庭判案，先假设被告无罪 (原假设 H₀)，然后收集证据 (样本数据)，判断是否有充分证据证明被告有罪 (拒绝原假设 H₀，接受备择假设 H₁)。\n    *   **假设检验是一种反证法。**  我们通常无法直接证明备择假设 H₁ 为真，但可以通过**否定原假设 H₀，间接支持备择假设 H₁**。  如果样本数据与原假设 H₀ 矛盾，我们就有理由拒绝 H₀，转而接受 H₁。  如果样本数据与原假设 H₀ 并不矛盾，我们则**没有充分证据拒绝 H₀，但也不能说 H₀ 一定为真，只能说 “接受 H₀” 或 “不拒绝 H₀”**。\n\n*   **原假设 (H₀) 与 备择假设 (H₁):**\n\n    *   **原假设 (Null Hypothesis, H₀):**  **研究者想要检验的假设，通常是关于总体参数 “没有效应”、“没有差异”、“没有关系” 的假设。**  例如，总体均值等于某个特定值 (μ = μ₀)，两组总体均值相等 (μ₁ = μ₂)，变量之间没有相关关系 (ρ = 0)。  原假设 H₀ 是假设检验的出发点，也是我们要试图拒绝的假设。\n    *   **备择假设 (Alternative Hypothesis, H₁):**  **与原假设 H₀  对立的假设，是研究者希望支持的假设，通常是关于总体参数 “存在效应”、“存在差异”、“存在关系” 的假设。**  例如，总体均值不等于某个特定值 (μ ≠ μ₀)，两组总体均值不相等 (μ₁ ≠ μ₂)，变量之间存在相关关系 (ρ ≠ 0)。  备择假设 H₁  是当原假设 H₀  被拒绝时，我们接受的结论。\n    *   **假设类型:**\n        *   **双侧检验 (Two-tailed Test):**  备择假设 H₁  是总体参数 “不等于” 某个特定值，检验方向是双侧的。  例如，H₀: μ = μ₀, H₁: μ ≠ μ₀。\n        *   **单侧检验 (One-tailed Test):**  备择假设 H₁  是总体参数 “大于” 或 “小于” 某个特定值，检验方向是单侧的 (左侧或右侧)。  例如，右侧检验：H₀: μ ≤ μ₀, H₁: μ > μ₀；  左侧检验：H₀: μ ≥ μ₀, H₁: μ < μ₀。  **选择单侧检验需要有充分的理由，并且在研究开始前就应该确定检验方向。  通常情况下，更常用双侧检验，因为它更保守，适用范围更广。**\n\n*   **假设检验的逻辑：**\n\n    1.  **假设原假设 H₀ 为真。**  先假定原假设 H₀  是正确的，作为出发点。\n    2.  **在 H₀ 为真的前提下，推导样本统计量的抽样分布。**  根据原假设 H₀  和抽样分布理论，推导出检验统计量 (例如，t 统计量、F 统计量、$\\\\chi^2$ 统计量) 的抽样分布。\n    3.  **计算检验统计量的值和 p 值。**  根据样本数据，计算检验统计量的值。  **p 值 (p-value) 是指，在原假设 H₀ 为真的前提下，出现当前样本结果或更极端结果的概率。**  p 值越小，说明在 H₀ 为真的情况下，出现当前样本结果的可能性越小，样本数据越不支持 H₀。\n    4.  **根据 p 值和显著性水平 $\\\\alpha$，做出决策。**  **显著性水平 $\\\\alpha$  是事先设定的一个概率值，通常取 0.05, 0.01, 0.10，表示我们愿意容忍犯 Type I 错误的最大概率。**  将 p 值与 $\\\\alpha$  进行比较：\n        *   **如果 p 值 ≤ $\\\\alpha$，则拒绝原假设 H₀，接受备择假设 H₁。**  认为样本数据提供了充分的证据，否定了原假设 H₀，支持了备择假设 H₁。  结果具有**统计显著性 (Statistically Significant)**。\n        *   **如果 p 值 > $\\\\alpha$，则没有充分证据拒绝原假设 H₀，接受原假设 H₀ (或 “不拒绝” H₀)。**  认为样本数据没有提供充分的证据，否定原假设 H₀。  **不能说原假设 H₀ 一定为真，只能说目前没有足够的证据推翻它。**  结果**不具有统计显著性 (Not Statistically Significant)**。\n\n*   **假设检验可能犯的错误：Type I 错误 & Type II 错误**\n\n    *   **在假设检验中，我们的决策 (拒绝 H₀ 或 接受 H₀)  是基于样本数据做出的，有可能犯错误。  根据原假设 H₀ 的真实情况和我们的决策，可能出现两种类型的错误：**\n\n        | 决策         | H₀ 真实 (True) | H₀ 错误 (False) |\n        | ------------ | ------------- | ------------- |\n        | **拒绝 H₀**   | **Type I 错误** | **正确决策**   |\n        | **接受 H₀**   | **正确决策**   | **Type II 错误** |\n\n        *   **Type I 错误 (Type I Error,  $\\\\alpha$ 错误, 拒真错误):**  **当原假设 H₀ 实际上为真时，我们却拒绝了 H₀。**  就好比 “真阳性” 的反面，把真原假设当成假原假设拒绝了。  Type I 错误的概率用 $\\\\alpha$ 表示，$\\\\alpha$ 也被称为 **显著性水平 (Significance Level)**，通常取值 0.05, 0.01, 0.10。  **显著性水平 $\\\\alpha$  是我们事先设定的，我们愿意容忍犯 Type I 错误的最大概率。**  例如，如果 $\\\\alpha = 0.05$，意味着如果我们重复进行 100 次假设检验，当 H₀ 均为真时，平均会有 5 次犯 Type I 错误。  **我们希望尽可能控制 Type I 错误的概率，避免 “冤枉好人”。**\n\n        *   **Type II 错误 (Type II Error, $\\\\beta$ 错误, 纳伪错误):**  **当原假设 H₀ 实际上为假时，我们却没有拒绝 H₀，反而接受了 H₀。**  就好比 “假阴性”，把假原假设当成真原假设接受了。  Type II 错误的概率用 $\\\\beta$ 表示，$\\\\beta$ 的值通常是未知的，与总体参数的真实值、样本容量、显著性水平等因素有关。  **我们希望尽可能减小 Type II 错误的概率，避免 “放过坏人”。**\n\n    *   **$\\\\alpha$ 与 $\\\\beta$ 的权衡:**  **$\\\\alpha$ 和 $\\\\beta$  之间存在权衡关系。  当我们试图减小 $\\\\alpha$ (例如，降低显著性水平，使拒绝 H₀ 更困难) 时，$\\\\beta$  通常会增大 (更容易接受错误的 H₀)。  反之，当我们试图减小 $\\\\beta$ (例如，增大样本容量，提高检验功效) 时，$\\\\alpha$  可能会增大。  在实际应用中，我们需要根据具体情况，权衡 Type I 错误和 Type II 错误的重要性，选择合适的 $\\\\alpha$ 水平，并尽可能提高检验功效，减小 $\\\\beta$。  **通常情况下，我们更关注控制 Type I 错误的概率 $\\\\alpha$，因为拒绝原假设通常意味着发现了新的、重要的结论。**\n\n*   **检验功效 (Power of a Test, 1 - $\\\\beta$):**\n\n    *   **检验功效是指当原假设 H₀ 实际上为假时，我们正确地拒绝 H₀ 的概率。**  检验功效 = 1 - $\\\\beta$。  **检验功效越高，犯 Type II 错误的概率 $\\\\beta$ 就越低，检验就越有效。  我们希望检验具有较高的功效，能够有效地发现真实存在的效应或差异。**\n\n    *   **影响检验功效的因素:**\n\n        *   **效应量 (Effect Size):**  **效应量是指总体参数偏离原假设 H₀ 的程度。**  效应量越大，总体参数与原假设的差异越大，越容易被检验出来，检验功效越高。  例如，如果两个总体均值差异很大，就更容易通过 t 检验发现均值差异。\n        *   **样本容量 (Sample Size, n):**  **样本容量越大，样本信息越丰富，抽样误差越小，检验功效越高。**  增大样本容量是提高检验功效的常用方法。\n        *   **显著性水平 (Significance Level, $\\\\alpha$):**  **显著性水平 $\\\\alpha$ 越大，拒绝 H₀  越容易，检验功效越高。**  但增大 $\\\\alpha$  也会增大犯 Type I 错误的概率。  通常在保证 $\\\\alpha$  水平的前提下，尽可能提高检验功效。\n        *   **总体标准差 ($\\\\sigma$):**  **总体标准差越小，数据变异性越小，抽样误差越小，检验功效越高。**  减小总体标准差通常无法直接控制，但在实验设计中，可以尽量控制无关变量，减小实验误差，从而减小数据变异性。\n        *   **单侧检验 vs 双侧检验:**  **在其他条件相同的情况下，单侧检验的功效通常比双侧检验高 (当效应方向与备择假设方向一致时)。**  但选择单侧检验需要有充分的理由，并且在研究开始前就应该确定检验方向。\n\n    *   **功效分析 (Power Analysis):**  **功效分析是一种用于评估和提高检验功效的方法。**  功效分析可以在研究设计阶段，**预先计算所需的样本容量**，以达到预期的检验功效。  也可以在研究结束后，**评估已完成研究的检验功效**，判断未拒绝原假设是否是因为检验功效不足。  R 中 `pwr` 包可以进行功效分析。  常用的功效分析类型包括：\n\n        *   **事前功效分析 (A-priori Power Analysis):  在研究开始前，为了达到预期的检验功效，计算所需的最小样本容量。**  例如，研究者希望在显著性水平 $\\\\alpha = 0.05$  下，以 80% 的功效 (power = 0.8)  检测到中等效应量 (Cohen's d = 0.5) 的均值差异，需要计算每组至少需要多少样本量。\n\n            ```r\n            # 安装和加载 pwr 包 (如果尚未安装)\n            # install.packages(\"pwr\")\n            library(pwr)\n\n            # 设置参数\n            desired_power <- 0.8      # 期望的检验功效 (通常为 0.8)\n            sig_level <- 0.05         # 显著性水平 (通常为 0.05)\n            effect_size <- 0.5       # 预期效应量 Cohen's d (例如，小效应 0.2, 中等效应 0.5, 大效应 0.8)\n            alternative_hypothesis <- \"two.sided\" # 双侧检验\n            test_type <- \"two.sample\" # 独立样本 t 检验\n\n            # 进行事前功效分析，计算所需样本容量\n            power_analysis_result <- pwr.t.test(power = desired_power,\n                                                  sig.level = sig_level,\n                                                  d = effect_size,\n                                                  type = test_type,\n                                                  alternative = alternative_hypothesis)\n\n            print(power_analysis_result)\n\n            # 提取所需样本容量 (每组样本量)\n            required_sample_size <- ceiling(power_analysis_result$n) # 向上取整\n            cat(\"Required sample size per group:\", required_sample_size, \"\\n\")\n\n            # 解释结果\n            cat(\"为了在显著性水平为\", sig_level, \"，检测到 Cohen's d =\", effect_size, \"的效应量，\\n\")\n            cat(\"并达到\", desired_power * 100, \"% 的检验功效，每组至少需要\", required_sample_size, \"个样本。\\n\")\n            ```\n\n        *   **事后功效分析 (Post-hoc Power Analysis):**  在研究结束后，根据已获得的样本数据和效应量，计算检验的实际功效。  **事后功效分析存在争议，因为其结果高度依赖于样本效应量，可能无法提供关于检验功效的可靠信息。  更推荐在研究设计阶段进行事前功效分析。**\n\n            ```r\n            # 假设 group1_vector 和 group2_vector 是已收集的两组独立样本数据向量\n            group1_vector <- rnorm(30, mean = 50, sd = 10) # 模拟数据\n            group2_vector <- rnorm(30, mean = 55, sd = 10) # 模拟数据\n            sample_size <- length(group1_vector) # 样本容量 (每组样本量)\n\n            # 计算样本效应量 Cohen's d\n            cohen_d_result <- cohen.d(group1_vector, group2_vector, paired = FALSE, var.equal = TRUE)\n            sample_effect_size <- cohen_d_result$estimate\n\n            # 进行事后功效分析，计算实际功效\n            post_hoc_power_analysis_result <- pwr.t.test(n = sample_size,\n                                                          d = sample_effect_size,\n                                                          sig.level = 0.05,\n                                                          type = \"two.sample\",\n                                                          alternative = \"two.sided\")\n\n            print(post_hoc_power_analysis_result)\n\n            # 提取实际功效\n            actual_power <- post_hoc_power_analysis_result$power\n            cat(\"Actual power:\", actual_power, \"\\n\")\n\n            # 解释结果\n            cat(\"在样本容量为\", sample_size, \"，显著性水平为 0.05，样本效应量 Cohen's d =\", sample_effect_size, \"的情况下，\\n\")\n            cat(\"该独立样本 t 检验的实际功效为\", actual_power * 100, \"%。\\n\")\n            cat(\"这意味着，如果总体中真实存在 Cohen's d =\", sample_effect_size, \"的效应，\\n\")\n            cat(\"我们有\", actual_power * 100, \"% 的概率通过该检验发现这个效应。\\n\")\n            ```\n\n*   **效应量 (Effect Size):**\n\n    *   **效应量是用于衡量效应或差异大小的指标，它独立于样本容量，不受样本容量的影响。**  p 值只告诉我们效应是否 “显著”，但不告诉我们效应 “有多大”。  **效应量弥补了 p 值的不足，提供了效应大小的信息，有助于判断研究结果的实际意义和重要性。**  “统计显著性” (p 值) 不等于 “实际显著性” (效应量)。  一个很小的效应，如果样本容量足够大，也可能达到统计显著性，但这并不意味着这个效应在实际应用中很重要。  反之，一个较大的效应，如果样本容量太小，可能无法达到统计显著性，但这并不意味着这个效应不存在或不重要。  **在报告假设检验结果时，除了 p 值，还应该报告效应量和置信区间，以便更全面地评价研究结果。**\n\n    *   **常用的效应量指标:**\n\n        *   **Cohen's d:**  用于**独立样本 t 检验**，衡量两个总体均值差异的标准化指标。  Cohen's d = ($\\\\bar{x}_1$ - $\\\\bar{x}_2$) / s_pooled，其中 s_pooled 是合并样本标准差。  Cohen 提出的经验法则：d = 0.2 (小效应), d = 0.5 (中等效应), d = 0.8 (大效应)。  R 中 `effsize` 包的 `cohen.d()` 函数可以计算 Cohen's d。  代码示例 (独立样本 t 检验):\n\n            ```r\n            # 安装和加载 effsize 包 (如果尚未安装)\n            # install.packages(\"effsize\")\n            library(effsize)\n\n            # 假设 group1_vector 和 group2_vector 是两组独立样本数据向量\n            cohen_d_result <- cohen.d(group1_vector, group2_vector,\n                                       paired = FALSE,  # 独立样本\n                                       var.equal = TRUE) # 假设方差相等 (如果使用 Welch's t 检验，则设置为 FALSE)\n            print(cohen_d_result)\n\n            # 提取 Cohen's d 值\n            cohen_d_value <- cohen_d_result$estimate\n            cat(\"Cohen's d:\", cohen_d_value, \"\\n\")\n\n            # 解释效应量大小 (根据 Cohen's 经验法则)\n            if (abs(cohen_d_value) >= 0.8) {\n              cat(\"效应量很大 (Large effect size).\\n\")\n            } else if (abs(cohen_d_value) >= 0.5) {\n              cat(\"效应量为中等 (Medium effect size).\\n\")\n            } else if (abs(cohen_d_value) >= 0.2) {\n              cat(\"效应量为小 (Small effect size).\\n\")\n            } else {\n              cat(\"效应量很小或无效应 (Very small or negligible effect size).\\n\")\n            }\n            ```\n\n        *   **相关系数 (Correlation Coefficient, r):**  用于衡量两个变量之间**线性关系**的强度和方向。  r 的取值范围为 [-1, 1]。  r = 0.1 (小效应), r = 0.3 (中等效应), r = 0.5 (大效应)。  R 函数 `cor()` 可以计算相关系数。\n        *   **R² (R-squared, 决定系数):**  用于**回归分析**，衡量回归模型对因变量变异的解释程度。  R² 的取值范围为 [0, 1]。  R² = 0.01 (小效应), R² = 0.09 (中等效应), R² = 0.25 (大效应)。  R 函数 `summary()`  回归模型结果可以得到 R²。\n        *   **$\\\\eta^2$ (Eta-squared, 偏$\\\\eta^2$):**  用于**方差分析 (ANOVA)**，衡量自变量对因变量变异的解释程度。  $\\\\eta^2$  的取值范围为 [0, 1]。  $\\\\eta^2$ = 0.01 (小效应), $\\\\eta^2$ = 0.06 (中等效应), $\\\\eta^2$ = 0.14 (大效应)。  R 中 `effectsize` 包的 `eta_squared()` 函数可以计算 $\\\\eta^2$ 和 偏$\\\\eta^2$。\n\n    *   **效应量的报告:**  在报告假设检验结果时，除了 p 值，应该报告相应的效应量指标，并解释效应量的大小，例如：  “独立样本 t 检验结果显示，两组均值差异显著 (t(df) = t 值, p < .05, Cohen's d = d 值, 95% CI [下限, 上限])，效应量为中等水平，表明…”。\n\n*   **假设检验步骤总结:**\n\n    1.  **提出研究问题，确定研究假设。**  明确研究目的，根据研究问题，提出关于总体参数的原假设 H₀ 和备择假设 H₁。  确定检验方向 (双侧或单侧)。\n    2.  **选择合适的检验方法和检验统计量。**  根据数据类型、研究设计、假设类型，选择合适的假设检验方法 (例如，t 检验、方差分析、卡方检验等)。  确定检验统计量 (例如，t 统计量、F 统计量、$\\\\chi^2$ 统计量)。\n    3.  **设定显著性水平 $\\\\alpha$。**  通常取 $\\\\alpha = 0.05$。  根据研究的重要性、后果、以及对 Type I 错误和 Type II 错误的权衡，选择合适的 $\\\\alpha$ 水平。\n    4.  **收集样本数据，计算检验统计量的值。**  使用 R 或其他统计软件，计算样本统计量和检验统计量的值。\n    5.  **计算 p 值，并与显著性水平 $\\\\alpha$  进行比较，做出决策。**  根据检验统计量的值，计算 p 值。  如果 p 值 ≤ $\\\\alpha$，则拒绝原假设 H₀，接受备择假设 H₁，认为结果具有统计显著性。  如果 p 值 > $\\\\alpha$，则没有充分证据拒绝原假设 H₀，接受原假设 H₀ (或 “不拒绝” H₀)。\n    6.  **解释结果，报告结论。**  根据假设检验的结果，结合研究背景和实际意义，解释统计结果，并得出研究结论。  **在报告结果时，除了 p 值，还应该报告效应量、置信区间、样本描述性统计量等信息，并讨论可能存在的 Type I 错误和 Type II 错误的风险，以及检验功效的局限性。**\n\n*   **单样本 t 检验、双样本 t 检验 (独立样本、配对样本):**\n\n    *   **单样本 t 检验 (One-Sample t-test):**  检验单个样本的均值是否与已知的总体均值 (或某个特定值) 存在显著差异。  适用条件：\n        *   因变量为连续变量。\n        *   样本来自正态分布总体 (或近似正态分布，样本容量较大时可放宽)。\n        *   总体标准差 σ 未知，用样本标准差 s 估计。\n\n        *   **假设:**\n            *   H₀: μ = μ₀  (总体均值等于 μ₀)\n            *   H₁: μ ≠ μ₀  (总体均值不等于 μ₀，双侧检验) 或 H₁: μ > μ₀ (右侧检验) 或 H₁: μ < μ₀ (左侧检验)\n\n        *   **检验统计量:**  t 统计量\n\n            $$\n            t = \\\\frac{\\\\bar{x} - \\\\mu_0}{s / \\\\sqrt{n}}\n            $$\n\n            其中，$\\\\bar{x}$ 是样本均值，μ₀ 是原假设的总体均值，s 是样本标准差，n 是样本容量。  t 统计量服从自由度为 n-1 的 t 分布。\n\n    *   **R 函数 `t.test()`  进行单样本 t 检验:**\n\n        ```r\n        # 假设 sample_vector 是样本数据向量，mu_0 是原假设的总体均值\n        t.test(sample_vector, mu = mu_0,\n               alternative = \"two.sided\",  # 双侧检验 (默认)\n               # alternative = \"greater\",  # 右侧检验\n               # alternative = \"less\",     # 左侧检验\n               conf.level = 0.95)         # 置信水平 (默认 95%)\n        ```\n\n    *   **双样本 t 检验 (Two-Sample t-test):**  比较两个样本所代表的总体均值是否存在显著差异。  分为独立样本 t 检验和配对样本 t 检验。\n\n        *   **独立样本 t 检验 (Independent Samples t-test):**  比较两个**独立**样本组的均值是否存在显著差异。  适用条件：\n            *   因变量为连续变量。\n            *   两个样本分别来自正态分布总体 (或近似正态分布，样本容量较大时可放宽)。\n            *   两个总体相互独立。\n            *   **方差齐性 (Homogeneity of Variance):**  两个总体的方差相等 (或近似相等)。  如果方差不齐，可以使用 Welch's t 检验 (R 中 `t.test()`  默认 Welch's t 检验)。\n\n            *   **假设:**\n                *   H₀: μ₁ = μ₂  (两个总体均值相等)\n                *   H₁: μ₁ ≠ μ₂  (两个总体均值不相等，双侧检验) 或 H₁: μ₁ > μ₂ (右侧检验) 或 H₁: μ₁ < μ₂ (左侧检验)\n\n            *   **检验统计量:**  t 统计量 (假设方差齐性) 或 Welch's t 统计量 (方差不齐)\n\n                $$\n                t = \\\\frac{\\\\bar{x}_1 - \\\\bar{x}_2}{s_{pooled} \\\\sqrt{\\\\frac{1}{n_1} + \\\\frac{1}{n_2}}}  (方差齐性)\n                $$\n\n                $$\n                t = \\\\frac{\\\\bar{x}_1 - \\\\bar{x}_2}{\\\\sqrt{\\\\frac{s_1^2}{n_1} + \\\\frac{s_2^2}{n_2}}}  (Welch's t 检验，方差不齐)\n                $$\n\n                其中，$\\\\bar{x}_1, \\\\bar{x}_2$ 是两个样本均值，$s_{pooled}$ 是合并样本标准差，$s_1, s_2$ 是两个样本标准差，$n_1, n_2$ 是两个样本容量。  t 统计量服从 t 分布，自由度根据方差齐性与否有所不同。\n\n        *   **R 函数 `t.test()`  进行独立样本 t 检验:**\n\n            ```r\n            # 假设 group1_vector 和 group2_vector 是两组独立样本数据向量\n            t.test(group1_vector, group2_vector,\n                   paired = FALSE,         # 独立样本 (默认)\n                   var.equal = TRUE,      # 假设方差相等 (默认 FALSE，使用 Welch's t 检验)\n                   alternative = \"two.sided\",  # 双侧检验 (默认)\n                   # alternative = \"greater\",  # 右侧检验 (group1 > group2)\n                   # alternative = \"less\",     # 左侧检验 (group1 < group2)\n                   conf.level = 0.95)         # 置信水平 (默认 95%)\n            ```\n\n        *   **配对样本 t 检验 (Paired Samples t-test):**  比较**配对**样本 (例如，同一对象处理前后的数据) 的均值是否存在显著差异。  适用条件：\n            *   因变量为连续变量。\n            *   配对样本差值来自正态分布总体 (或近似正态分布，样本容量较大时可放宽)。\n            *   配对样本数据之间存在配对关系。\n\n            *   **假设:**  配对样本 t 检验实际上是**对配对样本差值进行单样本 t 检验**。  设 $D_i = X_{1i} - X_{2i}$  为第 i 对样本的差值，总体均值差为 μ_D。\n                *   H₀: μ_D = 0  (总体均值差为 0，即两个总体均值相等)\n                *   H₁: μ_D ≠ 0  (总体均值差不为 0，双侧检验) 或 H₁: μ_D > 0 (右侧检验) 或 H₁: μ_D < 0 (左侧检验)\n\n            *   **检验统计量:**  t 统计量 (基于配对样本差值)\n\n                $$\n                t = \\\\frac{\\\\bar{D} - 0}{s_D / \\\\sqrt{n}}\n                $$\n\n                其中，$\\\\bar{D}$ 是配对样本差值的样本均值，$s_D$ 是配对样本差值的样本标准差，n 是配对样本对数。  t 统计量服从自由度为 n-1 的 t 分布。\n\n        *   **R 函数 `t.test()`  进行配对样本 t 检验:**\n\n            ```r\n            # 假设 before_vector 和 after_vector 是配对样本数据向量\n            t.test(before_vector, after_vector,\n                   paired = TRUE,          # 配对样本\n                   alternative = \"two.sided\",  # 双侧检验 (默认)\n                   # alternative = \"greater\",  # 右侧检验 (before < after)\n                   # alternative = \"less\",     # 左侧检验 (before > after)\n                   conf.level = 0.95)         # 置信水平 (默认 95%)\n            ```\n\n    *   **t 检验的 R 语言实战练习:**\n\n        *   **单样本 t 检验:**  检验 `mtcars`  数据集 `mpg`  列的平均值是否等于 20。  计算效应量 (Cohen's d 的变体，或报告均值差异)。  进行事后功效分析 (可选)。\n\n            ```r\n            # 单样本 t 检验：检验 mtcars 数据集 mpg 列的平均值是否等于 20\n            t.test(mtcars$mpg, mu = 20)\n\n            # 计算均值差异 (效应量的一种简单形式)\n            mean_mpg <- mean(mtcars$mpg)\n            mean_difference <- mean_mpg - 20\n            cat(\"Mean difference:\", mean_difference, \"\\n\")\n\n            # (可选) 事后功效分析 (单样本 t 检验的功效分析相对复杂，这里省略)\n            ```\n\n        *   **独立样本 t 检验:**  比较 `mtcars`  数据集不同 `am` (变速器类型) 组别 `mpg`  的平均值是否存在显著差异。  计算效应量 (Cohen's d)。  进行事前功效分析 (例如，计算达到 80% 功效所需的样本容量，假设预期效应量为中等)。  进行事后功效分析 (计算实际功效)。\n\n            ```r\n            # 独立样本 t 检验：比较 mtcars 数据集不同 am 组别 mpg 的平均值\n            independent_t_test_result <- t.test(mpg ~ am, data = mtcars, var.equal = TRUE) # 假设方差相等\n            print(independent_t_test_result)\n\n            # 计算 Cohen's d 效应量\n            library(effsize)\n            cohen_d_result <- cohen.d(mpg ~ am, data = mtcars, paired = FALSE, var.equal = TRUE)\n            print(cohen_d_result)\n\n            # 事前功效分析：计算达到 80% 功效所需的样本容量 (假设效应量为 Cohen's d = 0.5)\n            library(pwr)\n            power_analysis_result <- pwr.t.test(d = 0.5, power = 0.8, sig.level = 0.05,\n                                                  type = \"two.sample\", alternative = \"two.sided\")\n            print(power_analysis_result)\n            required_n <- ceiling(power_analysis_result$n)\n            cat(\"Required sample size per group (for power = 80%, Cohen's d = 0.5):\", required_n, \"\\n\")\n\n            # 事后功效分析：计算实际功效\n            actual_power_analysis_result <- pwr.t.test(n = length(mtcars$mpg[mtcars$am == 0]), # 或 length(mtcars$mpg[mtcars$am == 1])\n                                                         d = cohen_d_result$estimate,\n                                                         sig.level = 0.05,\n                                                         type = \"two.sample\", alternative = \"two.sided\")\n            print(actual_power_analysis_result)\n            actual_power <- actual_power_analysis_result$power\n            cat(\"Actual power:\", actual_power, \"\\n\")\n            ```\n\n        *   **配对样本 t 检验:**  分析 `sleep`  数据集 `extra`  列在 `group`  为 1 和 2 时的差异 (实际上 `sleep`  数据集不是真正的配对数据，这里仅作为演示配对 t 检验的例子)。  计算效应量 (Cohen's d 的变体，或报告均值差异)。  进行事后功效分析 (可选)。  或者，寻找真正的配对数据集进行配对 t 检验练习。\n\n            ```r\n            # 配对样本 t 检验：分析 sleep 数据集 extra 列在 group 为 1 和 2 时的差异 (演示配对 t 检验)\n            paired_t_test_result <- t.test(extra ~ group, data = sleep, paired = TRUE) # 注意：sleep 数据集不是真正的配对数据\n            print(paired_t_test_result)\n\n            # 计算均值差异 (效应量的一种简单形式)\n            mean_difference_paired <- mean(sleep$extra[sleep$group == 1] - sleep$extra[sleep$group == 2])\n            cat(\"Mean difference (paired):\", mean_difference_paired, \"\\n\")\n\n            # (可选) 事后功效分析 (配对样本 t 检验的功效分析相对复杂，这里省略)\n            ```\n\n### 5. 项目一汇报准备\n\n*   **汇报内容框架:**  为帮助学生更好地准备项目汇报，提供以下内容框架建议：\n\n    *   **项目背景与目标:**  清晰阐述项目背景、研究意义和具体研究目标\n    *   **数据概况:**  详细说明数据来源、样本量、变量特征，以及数据质量评估\n    *   **分析方法:**  介绍已采用的数据清洗、预处理和统计分析方法\n    *   **初步发现:**  展示描述性统计和可视化分析结果，突出数据特征和潜在模式\n    *   **挑战与展望:**  总结当前遇到的困难，并提出后续研究计划和改进方向\n\n*   **汇报质量要求:**  为确保汇报效果，提出以下具体要求：\n\n    *   **时间控制:**  每组汇报时间控制在4-5分钟\n    *   **演示文稿:**  使用PPT进行展示，要求结构清晰、重点突出\n    *   **数据可视化:**  图表设计规范，信息传达准确\n    *   **团队协作:**  小组成员需共同参与准备，明确分工\n    *   **预演准备:**  建议提前进行小组演练，确保汇报流畅\n\n*   **评估标准:**  汇报将根据以下维度进行评估：\n\n    *   **内容完整性:**  是否涵盖所有关键要素\n    *   **逻辑清晰度:**  汇报结构是否合理，论证是否严谨\n    *   **分析深度:**  是否充分挖掘数据价值，提出有价值见解\n    *   **展示效果:**  演示文稿设计是否专业，表达是否清晰\n    *   **团队协作:**  小组成员配合是否默契，分工是否合理\n\n### 6. 本周内容总结与下周预告\n\n*   **本周回顾:**  回顾本周学习内容，巩固重点知识。  本周我们**初步学习**了推断性统计的基本思想，参数估计 (点估计和区间估计)，**假设检验的基本原理和步骤，以及假设检验中可能犯的 Type I 错误和 Type II 错误，检验功效和效应量的概念和计算方法**，以及常用的 t 检验 (单样本 t 检验、独立样本 t 检验、配对样本 t 检验)。  **推断性统计是统计学的核心内容，参数估计和假设检验是推断性统计的基础，t 检验是均值检验的常用方法，理解假设检验的错误类型、功效和效应量，掌握效应量 Cohen's d 的计算和功效分析的基本方法，能够更全面、更深入、更严谨地理解和应用假设检验。  务必理解和掌握本周所学内容。**\n\n*   **下周预告:**  下周我们将继续学习假设检验，深入学习**方差分析 (ANOVA)**，用于检验**多个总体均值**是否相等。  方差分析是 t 检验的扩展，可以处理三个或更多组别均值比较的问题。  我们还将学习**非参数检验**，用于处理不满足参数检验条件的数据。  下周内容将更加深入，敬请期待！\n\n### 7. 课后任务\n\n*   **小组任务:**\n    *   **项目一汇报准备:**  \n        - 根据项目一汇报框架，准备完整的汇报材料（PPT）\n        - 明确小组成员分工，确定主要汇报人\n        - 进行至少2次小组预演，确保汇报流畅\n        - 重点准备以下内容：\n            * 项目背景与目标（1分钟）\n            * 数据概况与质量评估（1分钟）\n            * 分析方法与初步发现（2分钟）\n            * 挑战与后续计划（1分钟）\n    *   **项目一数据分析深化:**\n        - 在已完成的数据清洗和描述性统计基础上\n        - 提出2-3个具体的假设检验问题\n        - 使用t检验方法进行验证\n        - 计算效应量（Cohen's d）\n        - 进行简单的事后功效分析\n        - 将分析结果整合到项目汇报中\n\n*   **个人任务:**\n    *   **复习本周内容:**  回顾本周讲义和课堂笔记，巩固推断性统计基本概念、参数估计方法、假设检验步骤、t 检验的适用条件和 R 语言实现，**重点理解 Type I 错误、Type II 错误、检验功效和效应量的概念和意义，掌握 Cohen's d 的计算和功效分析的基本 R 代码和结果解释**。\n    *   **R 代码练习:**  完成本讲义中布置的 R 代码练习，熟练掌握 `t.test()`  函数的用法，能够使用 R 进行单样本 t 检验、独立样本 t 检验和配对样本 t 检验。  **练习使用 `effsize` 包计算 Cohen's d 效应量 (独立样本 t 检验)，练习使用 `pwr` 包进行事前功效分析和事后功效分析 (独立样本 t 检验)。**  尝试使用 AI 插件辅助 R 代码练习。\n    *   **概念理解和辨析:**  重点理解和辨析以下概念：总体与样本，参数与统计量，点估计与区间估计，置信水平与显著性水平，原假设与备择假设，双侧检验与单侧检验，第一类错误与第二类错误，p 值，单样本 t 检验、独立样本 t 检验、配对样本 t 检验的适用场景和区别，Type I 错误与 Type II 错误，检验功效，效应量 (Cohen's d, 相关系数 r, R², $\\\\eta^2$)，统计显著性与实际显著性，**事前功效分析与事后功效分析**。\n\n::: {.callout-tip}\n## AI 辅助学习小贴士\n\n*   **R 代码练习:**  继续在 VS Code 或 Cursor 中练习 R 语言代码，充分利用 AI 插件的代码自动补全、代码生成、代码解释、AI 聊天等功能。  遇到 R 代码问题，及时向 AI 提问。\n*   **统计概念理解:**  如果对推断性统计的概念 (例如，置信区间、假设检验、p 值、t 检验、**第一类错误、第二类错误、检验功效、效应量、事前功效分析、事后功效分析** 等) 理解不透彻，可以使用 AI 聊天提问，让 AI 提供更详细的解释和例子。  例如，提问： \"解释假设检验中的第一类错误和第二类错误\",  \"什么是统计检验的功效，为什么它很重要？\",  \"什么是效应量，如何解释 Cohen's d？\",  \"事前功效分析和事后功效分析有什么区别？\"。\n*   **R 函数用法查询:**  使用 AI 聊天提问： \"R 中 `t.test()` 函数的用法\",  \"如何使用 `effsize` 包在 R 中计算 Cohen's d\",  \"如何使用 `pwr` 包在 R 中进行 t 检验的功效分析\",  \"R 中用于功效分析的包\"。  AI 可能会提供函数文档或使用示例，**以及 `effsize` 包和 `pwr` 包的更详细使用方法和参数解释**。\n*   **假设检验步骤指导:**  如果不清楚假设检验的步骤，可以使用 AI 聊天咨询，例如，提问： \"假设检验的步骤\",  \"如何设置原假设和备择假设\",  \"如何解释假设检验中的 p 值\"。  AI 可能会提供步骤指导和示例。\n*   **结果解释辅助:**  如果对 R  `t.test()`  函数输出结果的含义不清楚，可以使用 AI 代码解释功能，选中 `t.test()`  函数的输出结果，让 AI 解释结果的含义，例如，p 值、置信区间、t 统计量、自由度等。  也可以使用 AI 聊天提问，例如，提问： \"解释 R 中 `t.test()` 函数的输出结果\",  \"如何在 t 检验结果中报告效应量和置信区间？\",  \"如何解释功效分析结果？\"。  **特别是关于功效分析结果中 `n`（样本量）、`d`（效应量）、`power`（检验功效）等参数的含义和解释。**\n\n::: {.callout-note}\n## 学习寄语\n\n**工欲善其事，必先利其器！  本周我们不仅学习了假设检验的基本方法，还掌握了评估检验质量和效应大小的工具：功效分析和效应量。  更完善的统计工具箱，助您在数据分析的道路上行稳致远！**  继续保持学习的热情，充分利用 VS Code/Cursor 和 AI 插件的强大功能，相信大家会在统计学和 R 语言的学习中取得更大的进步！  下周中期检查见！\n:::","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","number-sections":false,"toc":true,"toc-depth":3,"output-file":"week04.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}