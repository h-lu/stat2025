---
title: "项目三：预测建模与高级统计分析课件 (第9-12周)"
---

## 项目三：预测建模与高级统计分析 (第9-12周，共16课时)

### 项目目标

*   **预测建模能力**：掌握预测建模的基本流程和常用方法，能够构建有效的预测模型。
*   **高级统计方法应用**：熟练应用多元回归、Logistic 回归、时间序列分析等高级统计方法。
*   **模型评估与优化**：理解模型评估指标，掌握模型诊断与改进方法。
*   **商业预测应用**：能够将预测模型应用于实际商业问题，为决策提供支持。
*   **数据分析实践**：进一步提升 R 语言数据分析和建模能力。
*   **研究能力提升**：培养独立思考、探索创新和解决复杂问题的能力。

::: {.callout-tip}
## 项目主题 (学生可选择以下主题之一，或自拟主题经教师批准)

*   **主题一：销售预测分析**
    *   项目目标：通过**企业销售数据**，运用多元回归和时间序列分析方法，构建销售预测模型，为企业决策提供支持。

*   **主题二：信用风险评估**
    *   项目目标：通过**金融机构信贷数据**，运用Logistic回归等方法，构建信用风险评估模型，预测违约概率。

*   **主题三：客户流失预警**
    *   项目目标：通过**客户行为数据**，运用多元统计方法，构建客户流失预警模型，识别高风险客户。

*   **主题四：市场趋势预测**
    *   项目目标：通过**市场历史数据**，运用时间序列分析方法，预测市场趋势，为投资决策提供参考。

学生可以从以上四个主题中选择一个，或者结合自己的兴趣和专业背景，**自拟项目主题**，并提交给教师审批。
:::

## 第九周 (4课时)

*   **多元回归分析**
    *   多元线性回归模型
        *   回顾简单线性回归模型
        *   引入多元线性回归模型：模型公式、模型假设、回归系数解释
        *   多元线性回归的应用场景
    *   模型诊断与改进
        *   **多重共线性**：概念、检验方法 (VIF)、解决方法 (岭回归、逐步回归、PCA)
        *   **异方差性**：概念、检验方法 (BP 检验、White 检验)、解决方法 (加权最小二乘法、稳健标准误)
        *   **非线性**：概念、检验方法 (残差图)、解决方法 (多项式回归、对数变换)
        *   **异常值**：概念、识别方法 (Cook 距离、杠杆值)、处理方法 (删除、Winsorize)
    *   变量选择
        *   **变量选择的重要性**：避免模型过拟合、提高模型解释性
        *   **变量选择方法**：
            *   **逐步回归** (向前选择、向后剔除、双向逐步回归)
            *   **最优子集选择** (AIC, BIC 准则)
            *   **LASSO 回归** (L1 正则化)
            *   **岭回归** (L2 正则化)
        *   **交叉验证**：评估模型泛化能力，选择最优模型
    *   R 语言实现和案例分析
        *   **`lm()` 函数**：R 语言实现多元线性回归
        *   **`summary()` 函数**：查看模型结果 (回归系数、R-squared、p 值等)
        *   **`plot()` 函数**：模型诊断图 (残差图、QQ 图等)
        *   **`car` 包**：多重共线性检验 (VIF)
        *   **`lmtest` 包**：异方差性检验 (BP 检验、White 检验)
        *   **`MASS` 包**：逐步回归 (`stepAIC()`)
        *   **`leaps` 包**：最优子集选择 (`regsubsets()`)
        *   **`glmnet` 包**：LASSO 回归、岭回归 (`glmnet()`)
        *   **案例分析**：使用 R 语言分析实际数据集，应用多元回归模型，进行模型诊断与改进，变量选择。

### 第十周 (4课时)

*   **Logistic 回归**
    *   Logistic 回归模型原理
        *   **分类问题**：回顾分类问题，与回归问题的区别
        *   **Logistic 函数** (Sigmoid 函数)：介绍 Logistic 函数的形状和特点
        *   **Logistic 回归模型公式**：\(p = \frac{1}{1 + e^{-(\beta_0 + \beta_1x_1 + \dots + \beta_px_p)}}\)
            *   \(p\): 事件发生的概率
            *   \(x_1, x_2, \dots, x_p\): 自变量
            *   \(\beta_0, \beta_1, \beta_2, \dots, \beta_p\): 回归系数
        *   **Logit 变换**：将概率 \(p\) 转换为 Logit 值，实现线性化：\(\text{logit}(p) = \ln(\frac{p}{1-p}) = \beta_0 + \beta_1x_1 + \dots + \beta_px_p\)
        *   **模型假设**：
            *   因变量为二分类变量 (0/1)
            *   样本之间相互独立
            *   自变量与 Logit 值之间存在线性关系
        *   **模型参数估计**：最大似然估计 (MLE)
    *   模型评估与解释
        *   **混淆矩阵**：TP, TN, FP, FN
        *   **准确率 (Accuracy)**：\(\frac{TP + TN}{TP + TN + FP + FN}\)
        *   **精确率 (Precision)**：\(\frac{TP}{TP + FP}\)
        *   **召回率 (Recall)**：\(\frac{TP}{TP + FN}\)
        *   **F1 值**：\(2 \times \frac{\text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}\)
        *   **ROC 曲线与 AUC 值**：理解 ROC 曲线的含义，AUC 值的解释 (模型区分能力)
        *   **回归系数的解释**：
            *   **Odds Ratio (OR)**：解释自变量变化对 Odds 的影响
            *   **概率变化**：解释自变量变化对概率的影响 (非线性关系)
    *   R 语言实现和案例分析
        *   **`glm()` 函数**：R 语言实现 Logistic 回归 (`family = binomial`)
        *   **`summary()` 函数**：查看模型结果 (回归系数、标准误差、z 值、p 值)
        *   **`predict()` 函数**：预测概率
        *   **`confusionMatrix()` 函数** (`caret` 包)：计算混淆矩阵、准确率、精确率、召回率、F1 值等
        *   **`roc()` 函数** (`pROC` 包)：绘制 ROC 曲线，计算 AUC 值
        *   **案例分析**：使用 R 语言分析实际数据集，应用 Logistic 回归模型，进行模型评估和解释。

### 第十一周 (4课时)

*   **时间序列分析初步 (或根据学生兴趣选择其他专题)**
    *   时间序列基本概念
        *   **时间序列的定义**：按时间顺序排列的数据序列
        *   **时间序列的组成成分**：趋势 (Trend)、季节性 (Seasonality)、循环 (Cycle)、不规则波动 (Irregularity)
        *   **时间序列的类型**：平稳时间序列、非平稳时间序列
    *   平稳性检验
        *   **平稳性的定义**：时间序列的统计特征 (均值、方差、自相关系数) 不随时间变化
        *   **平稳性检验方法**：
            *   **时序图检验**：观察时序图，判断序列是否具有趋势或季节性
            *   **自相关函数 (ACF) 和偏自相关函数 (PACF) 图检验**：观察 ACF 和 PACF 图，判断序列是否快速衰减
            *   **单位根检验**：ADF 检验、KPSS 检验 (检验序列是否具有单位根，从而判断是否非平稳)
    *   ARIMA 模型初步
        *   **AR 模型 (自回归模型)**：利用自身滞后值进行预测
        *   **MA 模型 (移动平均模型)**：利用白噪声序列的移动平均进行预测
        *   **ARMA 模型 (自回归移动平均模型)**：AR 模型和 MA 模型的结合
        *   **ARIMA 模型 (差分整合移动平均模型)**：对非平稳时间序列进行差分处理，转换为平稳时间序列，再进行 ARMA 建模
        *   **ARIMA 模型的阶数确定** (p, d, q)：
            *   **ACF 和 PACF 图**：根据 ACF 和 PACF 图的截尾性和拖尾性，初步判断 p 和 q 的阶数
            *   **AIC 和 BIC 准则**：选择 AIC 或 BIC 值最小的模型阶数
            *   **单位根检验 (ADF 检验)**：确定差分阶数 d
        *   **ARIMA 模型建模步骤**：
            *   **平稳性检验**：检验时间序列是否平稳，如非平稳，进行差分处理
            *   **模型阶数确定** (p, d, q)：根据 ACF, PACF 图和 AIC, BIC 准则确定模型阶数
            *   **模型参数估计**：估计 ARIMA 模型参数
            *   **模型检验**：检验模型残差是否为白噪声，模型是否显著
            *   **模型预测**：使用模型进行未来预测
    *   R 语言实现和案例分析
        *   **`ts()` 函数**：将数据转换为时间序列对象
        *   **`plot.ts()` 函数**：绘制时序图
        *   **`acf()` 和 `pacf()` 函数**：绘制 ACF 和 PACF 图
        *   **`adf.test()` 函数** (`tseries` 包) 和 `kpss.test()` 函数 (`tseries` 包)：单位根检验
        *   **`arima()` 函数**：拟合 ARIMA 模型
        *   **`forecast()` 函数** (`forecast` 包)：进行时间序列预测
        *   **`checkresiduals()` 函数** (`forecast` 包)：检验模型残差
        *   **案例分析**：使用 R 语言分析实际时间序列数据 (例如，销售数据、股票价格数据)，应用 ARIMA 模型进行预测。

### 第十二周 (4课时)

*   **项目三总结与汇报**
    *   项目成果展示与答辩
        *   各小组进行项目成果展示，汇报项目研究过程、数据分析结果、结论与建议。
        *   **展示内容**：
            *   **项目选题和研究问题**：清晰阐述项目主题和研究问题。
            *   **数据来源和数据描述**：介绍数据来源和数据特点，展示数据质量评估结果。
            *   **研究方法和模型构建**：详细介绍所使用的统计分析方法和模型构建过程 (多元回归、Logistic 回归、时间序列分析等)。
            *   **模型诊断与改进**：展示模型诊断过程和改进方法 (如多重共线性处理、异方差性处理、变量选择等)。
            *   **结果展示与分析**：清晰展示数据分析结果，例如回归系数、模型评估指标、预测结果等，并进行深入分析和解释。
            *   **结论与建议**：基于数据分析结果，提出明确的结论和有价值的商业建议。
            *   **R 代码展示**：展示项目中使用 R 语言进行数据分析和建模的关键代码 (使用 `tidyverse` 风格)。
        *   **展示形式**：PPT 汇报。
        *   **答辩环节**：教师和学生对汇报内容进行提问和点评，小组进行答辩，回答问题。
        *   **评分标准**：项目报告质量、项目展示效果、答辩表现、团队合作、创新性、高级统计方法应用、R 代码质量等。
    *   高级统计方法在项目中的应用
        *   **回顾项目三中应用的高级统计方法**：多元回归、Logistic 回归、时间序列分析 (ARIMA 模型)。
        *   **强调高级统计方法在预测建模和商业决策中的作用**。
        *   **鼓励学生在项目中灵活应用所学的高级统计方法，解决实际问题**。
    *   优秀案例分享与经验总结
        *   **展示 1-2 个优秀的项目案例**，分享优秀项目的研究思路、数据分析方法、模型构建技巧和项目成果。
        *   **邀请优秀项目小组分享项目经验和心得体会**，例如，如何进行选题、如何获取数据、如何进行模型选择和优化、如何撰写项目报告、如何进行团队合作等。
        *   **鼓励学生互相学习，共同进步**。
    *   项目三评价与反馈
        *   **教师对各小组的项目进行评价和反馈**，指出项目的优点和不足，提供改进建议。
        *   **学生互评**：组织学生进行小组互评，互相学习，取长补短。
        *   **收集学生对项目三的反馈意见**，为课程持续改进提供参考。
